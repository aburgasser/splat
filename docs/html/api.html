<!DOCTYPE html>
<html class="writer-html5" lang="English" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API &mdash; SpeX Prism Library Analysis Toolkit 2023.11.25 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/logo.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/documentation_options.js?v=6ff9b23f"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Population Simulation Routines" href="splat_simulate.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SpeX Prism Library Analysis Toolkit
              <img src="_static/logo.jpg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                2023.11.25
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation and Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="splat.html">Main SPLAT module</a></li>
<li class="toctree-l1"><a class="reference internal" href="splat_empirical.html">Empirical Relations</a></li>
<li class="toctree-l1"><a class="reference internal" href="splat_plot.html">SPLAT Plotting Routines</a></li>
<li class="toctree-l1"><a class="reference internal" href="splat_photometry.html">Photometry package</a></li>
<li class="toctree-l1"><a class="reference internal" href="splat_model.html">SPLAT Spectral Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="splat_evolve.html">Brown Dwarf Evolutionary Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="splat_simulate.html">Population Simulation Routines</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#splat-classes">SPLAT Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spectrum">Spectrum</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.Spectrum"><code class="docutils literal notranslate"><span class="pre">Spectrum</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#splat-routines">SPLAT Routines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#data-and-database-access">Data and Database Access</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.getSpectrum"><code class="docutils literal notranslate"><span class="pre">getSpectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.getStandard"><code class="docutils literal notranslate"><span class="pre">getStandard()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.searchLibrary"><code class="docutils literal notranslate"><span class="pre">searchLibrary()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.keySource"><code class="docutils literal notranslate"><span class="pre">keySource()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.keySpectrum"><code class="docutils literal notranslate"><span class="pre">keySpectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.initiateStandards"><code class="docutils literal notranslate"><span class="pre">initiateStandards()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.addUserData"><code class="docutils literal notranslate"><span class="pre">addUserData()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">export()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">save()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.readSpectrum"><code class="docutils literal notranslate"><span class="pre">readSpectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.checkInstrument"><code class="docutils literal notranslate"><span class="pre">checkInstrument()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.checkLocation"><code class="docutils literal notranslate"><span class="pre">checkLocation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.checkTelescope"><code class="docutils literal notranslate"><span class="pre">checkTelescope()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.checkKeys"><code class="docutils literal notranslate"><span class="pre">checkKeys()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#spectral-manipulation">Spectral Manipulation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">toFluxUnit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">toWaveUnit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6"><code class="docutils literal notranslate"><span class="pre">toFnu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">toFlam()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8"><code class="docutils literal notranslate"><span class="pre">toSED()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">toSurface()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">toBrightnessTemperature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.Spectrum.toTemperature"><code class="docutils literal notranslate"><span class="pre">toTemperature()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11"><code class="docutils literal notranslate"><span class="pre">toWavelengths()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12"><code class="docutils literal notranslate"><span class="pre">toInstrument()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13"><code class="docutils literal notranslate"><span class="pre">redden()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14"><code class="docutils literal notranslate"><span class="pre">normalize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15"><code class="docutils literal notranslate"><span class="pre">scale()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16"><code class="docutils literal notranslate"><span class="pre">fluxCalibrate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id17"><code class="docutils literal notranslate"><span class="pre">smooth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.Spectrum._smoothToResolution"><code class="docutils literal notranslate"><span class="pre">_smoothToResolution()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.Spectrum._smoothToSlitWidth"><code class="docutils literal notranslate"><span class="pre">_smoothToSlitWidth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.Spectrum._smoothToSlitPixelWidth"><code class="docutils literal notranslate"><span class="pre">_smoothToSlitPixelWidth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id26"><code class="docutils literal notranslate"><span class="pre">maskFlux()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id27"><code class="docutils literal notranslate"><span class="pre">remove()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id28"><code class="docutils literal notranslate"><span class="pre">trim()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.stitch"><code class="docutils literal notranslate"><span class="pre">stitch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id29"><code class="docutils literal notranslate"><span class="pre">addNoise()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#spectral-classification-and-characterization">Spectral Classification and Characterization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.compareSpectra"><code class="docutils literal notranslate"><span class="pre">compareSpectra()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.measureIndex"><code class="docutils literal notranslate"><span class="pre">measureIndex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.measureIndexSet"><code class="docutils literal notranslate"><span class="pre">measureIndexSet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.plot.visualizeIndices"><code class="docutils literal notranslate"><span class="pre">visualizeIndices()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.measureEW"><code class="docutils literal notranslate"><span class="pre">measureEW()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.measureEWElement"><code class="docutils literal notranslate"><span class="pre">measureEWElement()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.measureEWSet"><code class="docutils literal notranslate"><span class="pre">measureEWSet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.classifyByIndex"><code class="docutils literal notranslate"><span class="pre">classifyByIndex()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.classifyByStandard"><code class="docutils literal notranslate"><span class="pre">classifyByStandard()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.classifyByTemplate"><code class="docutils literal notranslate"><span class="pre">classifyByTemplate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.classifyGravity"><code class="docutils literal notranslate"><span class="pre">classifyGravity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.empirical.redden"><code class="docutils literal notranslate"><span class="pre">redden()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.core.generateMask"><code class="docutils literal notranslate"><span class="pre">generateMask()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#spectrophotometry">Spectrophotometry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#splat.photometry.checkFilter"><code class="docutils literal notranslate"><span class="pre">checkFilter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.photometry.filterInfo"><code class="docutils literal notranslate"><span class="pre">filterInfo()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.photometry.filterMag"><code class="docutils literal notranslate"><span class="pre">filterMag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id37"><code class="docutils literal notranslate"><span class="pre">filterMag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.photometry.filterProfile"><code class="docutils literal notranslate"><span class="pre">filterProfile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.photometry.magToFlux"><code class="docutils literal notranslate"><span class="pre">magToFlux()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.photometry.visualizeFilter"><code class="docutils literal notranslate"><span class="pre">visualizeFilter()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#high-resolution-spectroscopic-functions">High-resolution Spectroscopic Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.baryVel"><code class="docutils literal notranslate"><span class="pre">baryVel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.lsfRotation"><code class="docutils literal notranslate"><span class="pre">lsfRotation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id39"><code class="docutils literal notranslate"><span class="pre">rvShift()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id40"><code class="docutils literal notranslate"><span class="pre">broaden()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id41"><code class="docutils literal notranslate"><span class="pre">rotate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#empirical-relationships">Empirical Relationships</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#splat.empirical.estimateDistance"><code class="docutils literal notranslate"><span class="pre">estimateDistance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id43"><code class="docutils literal notranslate"><span class="pre">redden()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.empirical.typeToColor"><code class="docutils literal notranslate"><span class="pre">typeToColor()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.empirical.typeToMag"><code class="docutils literal notranslate"><span class="pre">typeToMag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.empirical.typeToTeff"><code class="docutils literal notranslate"><span class="pre">typeToTeff()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.empirical.typeToLuminosity"><code class="docutils literal notranslate"><span class="pre">typeToLuminosity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.empirical.typeToBC"><code class="docutils literal notranslate"><span class="pre">typeToBC()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.checkAbsMag"><code class="docutils literal notranslate"><span class="pre">checkAbsMag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.checkBC"><code class="docutils literal notranslate"><span class="pre">checkBC()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.checkLbol"><code class="docutils literal notranslate"><span class="pre">checkLbol()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#conversion-routines">Conversion Routines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.coordinateToDesignation"><code class="docutils literal notranslate"><span class="pre">coordinateToDesignation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.designationToCoordinate"><code class="docutils literal notranslate"><span class="pre">designationToCoordinate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.designationToCoordinateString"><code class="docutils literal notranslate"><span class="pre">designationToCoordinateString()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.designationToShortName"><code class="docutils literal notranslate"><span class="pre">designationToShortName()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.typeToNum"><code class="docutils literal notranslate"><span class="pre">typeToNum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.properCoordinates"><code class="docutils literal notranslate"><span class="pre">properCoordinates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.properDate"><code class="docutils literal notranslate"><span class="pre">properDate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.UVW"><code class="docutils literal notranslate"><span class="pre">UVW()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#plotting-routines">Plotting Routines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#splat.plot.plotMap"><code class="docutils literal notranslate"><span class="pre">plotMap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.plot.plotSpectrum"><code class="docutils literal notranslate"><span class="pre">plotSpectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.plot.plotBatch"><code class="docutils literal notranslate"><span class="pre">plotBatch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.plot.plotSequence"><code class="docutils literal notranslate"><span class="pre">plotSequence()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#utility-routines">Utility Routines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.distributionStats"><code class="docutils literal notranslate"><span class="pre">distributionStats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.integralResample"><code class="docutils literal notranslate"><span class="pre">integralResample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.reMap"><code class="docutils literal notranslate"><span class="pre">reMap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id59"><code class="docutils literal notranslate"><span class="pre">readSpectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.weightedMeanVar"><code class="docutils literal notranslate"><span class="pre">weightedMeanVar()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.isNumber"><code class="docutils literal notranslate"><span class="pre">isNumber()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.isUnit"><code class="docutils literal notranslate"><span class="pre">isUnit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.numberList"><code class="docutils literal notranslate"><span class="pre">numberList()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.randomSphereAngles"><code class="docutils literal notranslate"><span class="pre">randomSphereAngles()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#i-o-routines">I/O Routines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.checkOnline"><code class="docutils literal notranslate"><span class="pre">checkOnline()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.checkOnlineFile"><code class="docutils literal notranslate"><span class="pre">checkOnlineFile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.checkFile"><code class="docutils literal notranslate"><span class="pre">checkFile()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.checkLocal"><code class="docutils literal notranslate"><span class="pre">checkLocal()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#modeling-and-simulation-routines">Modeling and Simulation Routines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#spectral-modeling-routines">Spectral Modeling Routines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#splat.model.getModel"><code class="docutils literal notranslate"><span class="pre">getModel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.model.loadModel"><code class="docutils literal notranslate"><span class="pre">loadModel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.model.loadOriginalModel"><code class="docutils literal notranslate"><span class="pre">loadOriginalModel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.model.loadTelluric"><code class="docutils literal notranslate"><span class="pre">loadTelluric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.model.blackbody"><code class="docutils literal notranslate"><span class="pre">blackbody()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.model.modelFitGrid"><code class="docutils literal notranslate"><span class="pre">modelFitGrid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.model.modelFitMCMC"><code class="docutils literal notranslate"><span class="pre">modelFitMCMC()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.model.modelFitEMCEE"><code class="docutils literal notranslate"><span class="pre">modelFitEMCEE()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.model.makeForwardModel"><code class="docutils literal notranslate"><span class="pre">makeForwardModel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.model.mcmcForwardModelFit"><code class="docutils literal notranslate"><span class="pre">mcmcForwardModelFit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.model.mcmcForwardModelReport"><code class="docutils literal notranslate"><span class="pre">mcmcForwardModelReport()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.model.addUserModels"><code class="docutils literal notranslate"><span class="pre">addUserModels()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.model.processModelsToInstrument"><code class="docutils literal notranslate"><span class="pre">processModelsToInstrument()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.checkSpectralModelName"><code class="docutils literal notranslate"><span class="pre">checkSpectralModelName()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.model.info"><code class="docutils literal notranslate"><span class="pre">info()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#evolutionary-model-routines">Evolutionary Model Routines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#splat.utilities.checkEvolutionaryModelName"><code class="docutils literal notranslate"><span class="pre">checkEvolutionaryModelName()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.evolve.loadEvolModel"><code class="docutils literal notranslate"><span class="pre">loadEvolModel()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.evolve.modelParameters"><code class="docutils literal notranslate"><span class="pre">modelParameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.evolve.plotModelParameters"><code class="docutils literal notranslate"><span class="pre">plotModelParameters()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#population-simulation-routines">Population Simulation Routines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#splat.simulate.UVWpopulation"><code class="docutils literal notranslate"><span class="pre">UVWpopulation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.simulate.volumeCorrection"><code class="docutils literal notranslate"><span class="pre">volumeCorrection()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.simulate.galacticPotential"><code class="docutils literal notranslate"><span class="pre">galacticPotential()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#specialty-packages">Specialty Packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#euclid-analysis-routines">EUCLID Analysis Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bibtex-routines">BibTeX Routines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#splat.citations.veryShortRef"><code class="docutils literal notranslate"><span class="pre">veryShortRef()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.citations.shortRef"><code class="docutils literal notranslate"><span class="pre">shortRef()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.citations.longRef"><code class="docutils literal notranslate"><span class="pre">longRef()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.citations.veryLongRef"><code class="docutils literal notranslate"><span class="pre">veryLongRef()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.citations.processBiblibrary"><code class="docutils literal notranslate"><span class="pre">processBiblibrary()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.citations.bibTexParser"><code class="docutils literal notranslate"><span class="pre">bibTexParser()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.citations.citeURL"><code class="docutils literal notranslate"><span class="pre">citeURL()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#astroquery-based-data-access">Astroquery-based Data Access</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#splat.database.getPhotometry"><code class="docutils literal notranslate"><span class="pre">getPhotometry()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.database.querySimbad"><code class="docutils literal notranslate"><span class="pre">querySimbad()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.database.queryVizier"><code class="docutils literal notranslate"><span class="pre">queryVizier()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.database.queryNist"><code class="docutils literal notranslate"><span class="pre">queryNist()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#splat.database.queryXMatch"><code class="docutils literal notranslate"><span class="pre">queryXMatch()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SpeX Prism Library Analysis Toolkit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api">
<h1>API<a class="headerlink" href="#api" title="Link to this heading">¶</a></h1>
<section id="splat-classes">
<h2>SPLAT Classes<a class="headerlink" href="#splat-classes" title="Link to this heading">¶</a></h2>
<section id="spectrum">
<h3>Spectrum<a class="headerlink" href="#spectrum" title="Link to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="splat.core.Spectrum">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">Spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Description<span class="colon">:</span></dt>
<dd class="field-odd"><p>Class for containing spectral and source data from SpeX Prism Library.
This is a temporary structure until astropy.specutils is completed</p>
</dd>
</dl>
<p>Optional Inputs:</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ismodel</strong> -- Set to True to specify spectrum as a model (default = False)</p></li>
<li><p><strong>wave_label</strong> -- label of wavelength (default = 'Wavelength')</p></li>
<li><p><strong>wave_unit</strong> -- unit in which wavelength is measured (default = u.micron)</p></li>
<li><p><strong>wave_unit_label</strong> -- label of the unit of wavelength (default = 'micron')</p></li>
<li><p><strong>flux_label</strong> -- label of flux density (default = 'F_lambda')</p></li>
<li><p><strong>flux_unit</strong> -- unit in which flux density is measured (default = u.erg/(u.cm**2 * u.s * u.micron)</p></li>
<li><p><strong>flux_unit_label</strong> -- label of the unit of flux density (default = 'erg cm^-2 s^-1 micron^-1')</p></li>
<li><p><strong>resolution</strong> -- Resolution of spectrum (default = median lam/lam step/2.)</p></li>
<li><p><strong>slitpixelwidth</strong> -- Width of the slit measured in subpixel values (default = 3.33)</p></li>
<li><p><strong>slitwidth</strong> -- Actual width of the slit, measured in arcseconds. Default value is the <code class="docutils literal notranslate"><span class="pre">slitpixelwidth</span></code> multiplied an assumed (for SpeX) spectrograph pixel scale of 0.15 arcseconds</p></li>
<li><p><strong>header</strong> -- header info of the spectrum (default = Table())</p></li>
<li><p><strong>filename</strong> -- a string containing the spectrum's filename (default = '')</p></li>
<li><p><strong>file</strong> -- same as filename (default = '')</p></li>
<li><p><strong>idkey</strong> -- spectrum key of the desired spectrum (default = False)</p></li>
</ul>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;myspectrum.fits&#39;</span><span class="p">)</span>      <span class="c1"># read in a file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="s1">&#39;myspectrum.fits&#39;</span><span class="p">)</span>               <span class="c1"># same</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="mi">10002</span><span class="p">)</span>                           <span class="c1"># read in spectrum with data_key = 10002</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">wave</span><span class="o">=</span><span class="n">wavearray</span><span class="p">,</span><span class="n">flux</span><span class="o">=</span><span class="n">fluxarray</span><span class="p">)</span>   <span class="c1"># create objects with wavelength &amp; flux arrays</span>
</pre></div>
</div>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#id29" title="splat.core.Spectrum.addNoise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">addNoise</span></code></a>([snr])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id40" title="splat.core.Spectrum.broaden"><code class="xref py py-obj docutils literal notranslate"><span class="pre">broaden</span></code></a>(vbroad[, kern, epsilon, method, verbose])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#splat.core.Spectrum.clean" title="splat.core.Spectrum.clean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">clean</span></code></a>([action, replace_value])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#splat.core.Spectrum.computeSN" title="splat.core.Spectrum.computeSN"><code class="xref py py-obj docutils literal notranslate"><span class="pre">computeSN</span></code></a>([rng, statistic, offset])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Compute a representative S/N value as the median value of S/N among the top 50% of flux values</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#splat.core.Spectrum.copy" title="splat.core.Spectrum.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Make a copy of a Spectrum object</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id0" title="splat.core.Spectrum.export"><code class="xref py py-obj docutils literal notranslate"><span class="pre">export</span></code></a>([filename, clobber, csv, tab, ...])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id37" title="splat.core.Spectrum.filterMag"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filterMag</span></code></a>(filt, **kwargs)</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id16" title="splat.core.Spectrum.fluxCalibrate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fluxCalibrate</span></code></a>(filt, mag, **kwargs)</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Flux calibrates a spectrum given a filter and a magnitude. The filter must be one of those listed in <cite>splat.FILTERS.keys()</cite>. It is possible to specifically set the magnitude to be absolute (by default it is apparent).  This function changes the Spectrum object's flux, noise and variance arrays.</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#splat.core.Spectrum.fluxMax" title="splat.core.Spectrum.fluxMax"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fluxMax</span></code></a>([wrange, maskTelluric])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Reports the maximum flux of a Spectrum object ignoring nan's.</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#splat.core.Spectrum.info" title="splat.core.Spectrum.info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">info</span></code></a>()</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#splat.core.Spectrum.mapTo" title="splat.core.Spectrum.mapTo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mapTo</span></code></a>(other[, overhang])</p></td>
<td><p>Purpose: maps spectrum onto the wavelength scale of another spectrum</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id26" title="splat.core.Spectrum.maskFlux"><code class="xref py py-obj docutils literal notranslate"><span class="pre">maskFlux</span></code></a>([mask, replace_noise, ...])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#splat.core.Spectrum.maskWave" title="splat.core.Spectrum.maskWave"><code class="xref py py-obj docutils literal notranslate"><span class="pre">maskWave</span></code></a>(rng[, apply])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id14" title="splat.core.Spectrum.normalize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">normalize</span></code></a>(*args, **kwargs)</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#splat.core.Spectrum.plot" title="splat.core.Spectrum.plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot</span></code></a>(**kwargs)</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id13" title="splat.core.Spectrum.redden"><code class="xref py py-obj docutils literal notranslate"><span class="pre">redden</span></code></a>([av, rv, normalize, a, n])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#splat.core.Spectrum.redshift" title="splat.core.Spectrum.redshift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">redshift</span></code></a>(z)</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Shifts the wavelength scale by a given (positive) redshift. A negative redshift is interpreted as shifting back to the restframe.</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id27" title="splat.core.Spectrum.remove"><code class="xref py py-obj docutils literal notranslate"><span class="pre">remove</span></code></a>(mask[, others])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#splat.core.Spectrum.replace" title="splat.core.Spectrum.replace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">replace</span></code></a>(mask, replace_value[, ...])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#splat.core.Spectrum.res" title="splat.core.Spectrum.res"><code class="xref py py-obj docutils literal notranslate"><span class="pre">res</span></code></a>([npixel, method])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#splat.core.Spectrum.reset" title="splat.core.Spectrum.reset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reset</span></code></a>()</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id41" title="splat.core.Spectrum.rotate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rotate</span></code></a>(vsini[, epsilon, verbose])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id39" title="splat.core.Spectrum.rvShift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rvShift</span></code></a>(rv)</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Shifts the wavelength scale by a given radial velocity. This routine changes the underlying Spectrum object.</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#splat.core.Spectrum.sample" title="splat.core.Spectrum.sample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sample</span></code></a>(rng[, method, verbose])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id2" title="splat.core.Spectrum.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>(*args, **kwargs)</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Exports a Spectrum object to either a fits or ascii file, depending on file extension given.  If no filename is explicitly given, the Spectrum.filename attribute is used. If the filename does not include the full path, the file is saved in the current directory.</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id15" title="splat.core.Spectrum.scale"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scale</span></code></a>(factor[, noiseonly])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#splat.core.Spectrum.setNoise" title="splat.core.Spectrum.setNoise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">setNoise</span></code></a>([rng, floor])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#splat.core.Spectrum.showHistory" title="splat.core.Spectrum.showHistory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">showHistory</span></code></a>()</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id17" title="splat.core.Spectrum.smooth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">smooth</span></code></a>(smv[, resolution, slitwidth])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#splat.core.Spectrum.toAngstrom" title="splat.core.Spectrum.toAngstrom"><code class="xref py py-obj docutils literal notranslate"><span class="pre">toAngstrom</span></code></a>()</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id10" title="splat.core.Spectrum.toBrightnessTemperature"><code class="xref py py-obj docutils literal notranslate"><span class="pre">toBrightnessTemperature</span></code></a>([limbdarkening, ...])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Convert to surface fluxes given a radius, assuming at absolute fluxes</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id7" title="splat.core.Spectrum.toFlam"><code class="xref py py-obj docutils literal notranslate"><span class="pre">toFlam</span></code></a>()</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id4" title="splat.core.Spectrum.toFluxUnit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">toFluxUnit</span></code></a>(flux_unit)</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id6" title="splat.core.Spectrum.toFnu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">toFnu</span></code></a>()</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id12" title="splat.core.Spectrum.toInstrument"><code class="xref py py-obj docutils literal notranslate"><span class="pre">toInstrument</span></code></a>(instrument[, pixel_resolution])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#splat.core.Spectrum.toMicron" title="splat.core.Spectrum.toMicron"><code class="xref py py-obj docutils literal notranslate"><span class="pre">toMicron</span></code></a>()</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id8" title="splat.core.Spectrum.toSED"><code class="xref py py-obj docutils literal notranslate"><span class="pre">toSED</span></code></a>()</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id9" title="splat.core.Spectrum.toSurface"><code class="xref py py-obj docutils literal notranslate"><span class="pre">toSurface</span></code></a>(radius)</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Convert to surface fluxes given a radius, assuming at absolute fluxes</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id5" title="splat.core.Spectrum.toWaveUnit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">toWaveUnit</span></code></a>(wave_unit)</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#id11" title="splat.core.Spectrum.toWavelengths"><code class="xref py py-obj docutils literal notranslate"><span class="pre">toWavelengths</span></code></a>(wave[, force, verbose])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#id28" title="splat.core.Spectrum.trim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trim</span></code></a>(rng, **kwargs)</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#splat.core.Spectrum.updateSourceInfo" title="splat.core.Spectrum.updateSourceInfo"><code class="xref py py-obj docutils literal notranslate"><span class="pre">updateSourceInfo</span></code></a>([verbose, radius])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#splat.core.Spectrum.waveRange" title="splat.core.Spectrum.waveRange"><code class="xref py py-obj docutils literal notranslate"><span class="pre">waveRange</span></code></a>()</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the wavelength range of the current Spectrum object.</p>
</dd>
</dl>
</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>cleanNoise</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>flamToFnu</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>fnuToFlam</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>toTemperature</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.addNoise">
<span class="sig-name descname"><span class="pre">addNoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">snr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.addNoise" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Adds noise to a spectrum based on either the current uncertainties scaled by optional input S/N</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>snr</em>: Signal-to-noise ratio to use to scale uncertainty spectrum (default = 0. =&gt; use existing S/N)</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>None (spectrum object changed in place)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="mi">10001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">addNoise</span><span class="p">(</span><span class="n">snr</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">     9.5702358777108234</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.broaden">
<span class="sig-name descname"><span class="pre">broaden</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vbroad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kern</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rotation'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.broaden" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Broadens a spectrum in velocity space using a line spread function (LSF) either based on rotation or gaussian.
This routine changes the underlying Spectrum object.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param vbroad<span class="colon">:</span></dt>
<dd class="field-odd"><p>broadening width, nominally in km/s</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param method<span class="colon">:</span></dt>
<dd class="field-odd"><p>method of broadening, should be one of:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gaussian</span></code>: (default) Gaussian broadening, with vbroad equal to Gaussian sigma</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rotation</span></code>: rotational broadening using splat.lsfRotation()</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delta</span></code>: Delta function (no broadening)</p></li>
</ul>
</dd>
<dt class="field-even">param kern<span class="colon">:</span></dt>
<dd class="field-even"><p>input kernel, must be at least three elements wide (default = None)</p>
</dd>
<dt class="field-odd">param epsilon<span class="colon">:</span></dt>
<dd class="field-odd"><p>epsilon parameter for limb darkening in rotational broadening (default = 0.6)</p>
</dd>
<dt class="field-even">param verbose<span class="colon">:</span></dt>
<dd class="field-even"><p>provide extra feedback (default = False)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectral flux is smoothed using the desired line spread function. No change is made to noise or other axes</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="mi">10001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">broaden</span><span class="p">(</span><span class="mf">30.</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;rotation&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go"> History:</span>
<span class="go">     SPEX_PRISM spectrum successfully loaded</span>
<span class="go">     Rotationally broadened spectrum by 30.0 km/s</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.clean">
<span class="sig-name descname"><span class="pre">clean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'remove'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.clean" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Cleans a spectrum by either removing or replacing nan values</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param action = 'remove'<span class="colon">:</span></dt>
<dd class="field-odd"><p>specify as either 'remove' or 'replace'</p>
</dd>
<dt class="field-even">param replace_value = 0.<span class="colon">:</span></dt>
<dd class="field-even"><p>for replace, what value to replace with</p>
</dd>
</dl>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>Spectrum object is modified to have nan pixels &quot;cleaned&quot;</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span><span class="o">,</span><span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">clean</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">showHistory</span><span class="p">()</span>
<span class="go">     SPEX_PRISM spectrum successfully loaded</span>
<span class="go">     Mask applied to remove 1 pixels</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.computeSN">
<span class="sig-name descname"><span class="pre">computeSN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statistic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'median'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.computeSN" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Compute a representative S/N value as the median value of S/N among the top 50% of flux values</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>the S/N value</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">115.96374031163553</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.copy" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Make a copy of a Spectrum object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.export">
<span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clobber</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.export" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Exports a Spectrum object to either a fits or ascii file, depending on file extension given.
If no filename is explicitly given, the Spectrum.filename attribute is used.
If the filename does not include the full path, the file is saved in the current directory.
Spectrum.export and <a class="reference external" href="api.html#splat.core.Spectrum.save">Spectrum.save()</a> function in the same manner.</p>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd">Required Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param filename<span class="colon">:</span></dt>
<dd class="field-odd"><p>String specifying the filename to save; filename can also be included as an argument; if not provided, Spectrum.filename is used; alternate keywords: <cite>file</cite></p>
</dd>
<dt class="field-even">param clobber<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to True to overwrite file, or False to raise flag if file exists (default = True)</p>
</dd>
<dt class="field-odd">param csv<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to True to write a CSV (comma-delimited) file (default = False)</p>
</dd>
<dt class="field-even">param tab<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to True to write a tab-delimited file (default = True)</p>
</dd>
<dt class="field-odd">param delimiter<span class="colon">:</span></dt>
<dd class="field-odd"><p>character or string to specify as delimiter between columns (default = '  '); alternate keywords: <cite>sep</cite></p>
</dd>
<dt class="field-even">param save_header<span class="colon">:</span></dt>
<dd class="field-even"><p>set to True to add header to ascii files (default = True)</p>
</dd>
<dt class="field-odd">param save_noise<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to save the noise column (default = True)</p>
</dd>
<dt class="field-even">param comment<span class="colon">:</span></dt>
<dd class="field-even"><p>use to specify comment character (default = '#')</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>An ascii or fits file with the data and header</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s1">&#39;/Users/adam/myspectrum.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">ascii</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;/Users/adam/myspectrum.txt&#39;</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;tab&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>
<span class="go"> &lt;Table length=564&gt;</span>
<span class="go">   wavelength          flux          uncertainty</span>
<span class="go">    float64          float64           float64</span>
<span class="go"> -------------- ----------------- -----------------</span>
<span class="go"> 0.645418405533               0.0               nan</span>
<span class="go"> 0.647664904594 6.71920214475e-16 3.71175052033e-16</span>
<span class="go"> 0.649897933006 1.26009925777e-15 3.85722895842e-16</span>
<span class="go"> 0.652118623257 7.23781818374e-16 3.68178778862e-16</span>
<span class="go"> 0.654327988625 1.94569566622e-15 3.21007116982e-16</span>
<span class="go"> ...</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.filterMag">
<span class="sig-name descname"><span class="pre">filterMag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.filterMag" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Wrapper for <a class="reference external" href="api.html#splat.photometry.filterMag">filterMag()</a> function in splat.photometry</p>
</dd>
</dl>
<p>Required Inputs:</p>
<blockquote>
<div><p><strong>filter</strong>: string specifiying the name of the filter</p>
</div></blockquote>
<p>Optional Inputs:</p>
<blockquote>
<div><p>See <a class="reference external" href="api.html#splat.photometry.filterMag">filterMag()</a></p>
</div></blockquote>
<p>Outputs:</p>
<blockquote>
<div><p>Returns tuple containing filter-based spectrophotometic magnitude and its uncertainty</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxCalibrate</span><span class="p">(</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">,</span><span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">filterMag</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">)</span>
<span class="go"> (15.002545668628173, 0.017635234089677564)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.fluxCalibrate">
<span class="sig-name descname"><span class="pre">fluxCalibrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.fluxCalibrate" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Flux calibrates a spectrum given a filter and a magnitude. The filter must be one of those listed in <cite>splat.FILTERS.keys()</cite>. It is possible to specifically set the magnitude to be absolute (by default it is apparent).  This function changes the Spectrum object's flux, noise and variance arrays.</p>
</dd>
</dl>
<p>Required Inputs:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filt</strong> -- string specifiying the name of the filter</p></li>
<li><p><strong>mag</strong> -- number specifying the magnitude to scale to</p></li>
</ul>
</dd>
</dl>
<p>Optional Inputs:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>absolute</strong> -- set to True to specify that the given magnitude is an absolute magnitude, which sets the <code class="docutils literal notranslate"><span class="pre">flux_label</span></code> keyword in the Spectrum object to 'Absolute Flux' (default = False)</p></li>
<li><p><strong>apparent</strong> -- set to True to specify that the given magnitude is an apparent magnitude, which sets the <code class="docutils literal notranslate"><span class="pre">flux_label</span></code> flag in the Spectrum object to 'Apparent Flux' (default = False)</p></li>
</ul>
</dd>
</dl>
<p>Outputs:</p>
<p>None, Spectrum object is changed to a flux calibrated spectrum</p>
<dl class="field-list">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxCalibrate</span><span class="p">(</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">,</span><span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">filterMag</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">)</span>
<span class="go"> (15.002545668628173, 0.017635234089677564)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.fluxMax">
<span class="sig-name descname"><span class="pre">fluxMax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskTelluric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.fluxMax" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Reports the maximum flux of a Spectrum object ignoring nan's.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>maskTelluric</strong> (<em>optional</em><em>, </em><em>default = True</em>) -- masks telluric regions</p>
</dd>
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>maximum flux (with units)</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0 erg / (cm2 micron s)&gt;</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.info">
<span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.info" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>None</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.mapTo">
<span class="sig-name descname"><span class="pre">mapTo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overhang</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.mapTo" title="Link to this definition">¶</a></dt>
<dd><p>Purpose: maps spectrum onto the wavelength scale of another spectrum</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.maskFlux">
<span class="sig-name descname"><span class="pre">maskFlux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.maskFlux" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mask = []</strong><span class="classifier">list or numpy.ndarray [optional]</span></dt><dd><p>array with same length as Spectrum object wavelength array that specifies pixels to be masked
array values can be floating point, int, or bool, with 1 = True (mask) and 0 = False (don't mask)</p>
</dd>
<dt><strong>replace_noise = True</strong><span class="classifier">bool [optional]</span></dt><dd><p>If True, apply the mask to the uncertainty array</p>
</dd>
<dt><strong>replace_value = numpy.nan</strong><span class="classifier">float [optional]</span></dt><dd><p>Value with which to replace masked elements of flux</p>
</dd>
<dt><strong>others = []]</strong><span class="classifier">list [optional]</span></dt><dd><p>Other elements of the Spectrum object to apply mask (e.g., wave, flags, mask, etc.)
These elements should be present and must be the same length as mask</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.maskWave">
<span class="sig-name descname"><span class="pre">maskWave</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.maskWave" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>rng</strong><span class="classifier">list of numpy.ndarray</span></dt><dd><p>2-element array that specifies the minimum and maximum wavelength range to mask
elements can be unitted values or pure numbers (interpretted to be same units as spectrum)</p>
</dd>
<dt><strong>apply = True</strong><span class="classifier">bool [optional]</span></dt><dd><p>If True, apply the mask using maskFlux()</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.normalize" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Normalize a spectrum to a maximum value of 1 (in its current units) either at a
particular wavelength or over a wavelength range</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param wave_range<span class="colon">:</span></dt>
<dd class="field-odd"><p>choose the wavelength range to normalize; can be a list specifying minimum and maximum or a single wavelength (default = None); alternate keywords: <cite>wave_range</cite>, <cite>range</cite></p>
</dd>
</dl>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>None; spectrum is normalized</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">waverange</span><span class="o">=</span><span class="p">[</span><span class="mf">2.25</span><span class="p">,</span><span class="mf">2.3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.591310977935791 erg / (cm2 micron s)&gt;</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.plot" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>calls the <a href="#id138"><span class="problematic" id="id139">`plotSpectrum()`_</span></a> function, by default showing the noise spectrum and zeropoints.
See the <a href="#id140"><span class="problematic" id="id141">`plotSpectrum()`_</span></a> API listing for details.</p>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>A plot of the Spectrum object</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.redden">
<span class="sig-name descname"><span class="pre">redden</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">av</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.33</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.redden" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Redden a spectrum based on an either Mie theory or a standard interstellar profile
using Cardelli, Clayton, and Mathis (1989 ApJ. 345, 245)</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param av<span class="colon">:</span></dt>
<dd class="field-odd"><p>Magnitude of reddening A_V (default = 0.)</p>
</dd>
<dt class="field-even">param rv<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized extinction parameter, R_V = A(V)/E(B-V) (default = 3.1</p>
</dd>
<dt class="field-odd">param normalized<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to True to normalize reddening function (default = False)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; spectral flux is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="mi">10001</span><span class="p">)</span>                   <span class="c1"># read in a source</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spr</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">redden</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">av</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span><span class="n">rv</span><span class="o">=</span><span class="mf">3.2</span><span class="p">)</span>          <span class="c1"># redden to equivalent of AV=5</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="simple">
<dt><strong>Note</strong></dt><dd><p>This routine is still in beta form; only the CCM89 currently works</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.redshift">
<span class="sig-name descname"><span class="pre">redshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.redshift" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Shifts the wavelength scale by a given (positive) redshift. A negative redshift is interpreted as shifting back to the restframe.</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">redshift</span><span class="p">(</span><span class="mf">0.56</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.remove">
<span class="sig-name descname"><span class="pre">remove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.remove" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Removes elements of wave, flux, noise specified by the True/False array</p>
</dd>
<dt class="field-even">Required Input<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param mask<span class="colon">:</span></dt>
<dd class="field-odd"><p>Either a mask array (an array of booleans, ints, or floats, where True or 1 removes the element)
or a 2-element array that defines the wavelegnth range to mask</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Input<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param others<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of other attributes that mask should be applied to(e.g., 'pixel') (default = [])</p>
</dd>
</dl>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>Spectrum object has the flagged pixels removed from  wave, flux, noise arrays, and optional vectors</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span><span class="o">,</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">numberList</span><span class="p">(</span><span class="s1">&#39;1-10,18,30-50&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="p">[</span><span class="ow">not</span><span class="p">(</span><span class="n">p</span> <span class="ow">in</span> <span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="p">))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">showHistory</span><span class="p">()</span>
<span class="go">     SPEX_PRISM spectrum successfully loaded</span>
<span class="go">     Mask applied to remove 32 pixels</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.replace">
<span class="sig-name descname"><span class="pre">replace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_flux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.replace" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Replaces flux and noise values using a mask and specified value</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param mask<span class="colon">:</span></dt>
<dd class="field-odd"><p>Either a mask array (an array of booleans, ints, or floats, where True or 1 removes the element)
or a 2-element array that defines the wavelength range to replace</p>
</dd>
<dt class="field-even">param replace_value<span class="colon">:</span></dt>
<dd class="field-even"><p>value with which the masked elements should be replaced</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param replace_flux = True<span class="colon">:</span></dt>
<dd class="field-odd"><p>replace elements in the noise array</p>
</dd>
<dt class="field-even">param replace_noise = True<span class="colon">:</span></dt>
<dd class="field-even"><p>replace elements in the flux array</p>
</dd>
</dl>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>Spectrum object has the flagged pixels replaced in flux, noise arrays, and optional vectors</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span><span class="o">,</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">numberList</span><span class="p">(</span><span class="s1">&#39;1-10,18,30-50&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="p">[</span><span class="ow">not</span><span class="p">(</span><span class="n">p</span> <span class="ow">in</span> <span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="p">))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">showHistory</span><span class="p">()</span>
<span class="go">     SPEX_PRISM spectrum successfully loaded</span>
<span class="go">     Mask applied to replace 32 pixels with value nan</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.res">
<span class="sig-name descname"><span class="pre">res</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npixel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'median'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.res" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Estimate the resolution of the data from the wavelength array</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>npixel = 1: number of pixels per resolution element</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>method = 'median': what statistic to report back; can be mean, average, median, min, or max</p>
</dd>
</dl>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>The resolution of the spectrum (single number)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">resolution</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.reset" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Restores a Spectrum to its original read-in state, removing scaling and smoothing.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>Spectrum object is restored to original parameters</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 4.561630292384622e-15 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 0.9999999403953552 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 4.561630292384622e-15 erg / (cm2 micron s)&gt;</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.rotate">
<span class="sig-name descname"><span class="pre">rotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vsini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.rotate" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Rotationally broaden the lines of a spectrum; a shortcut call to <a class="reference external" href="api.html#splat.core.Spectrum.broaden">Spectrum.broaden()</a></p>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd">Required Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param vsini<span class="colon">:</span></dt>
<dd class="field-odd"><p>Rotational velocity in km/s</p>
</dd>
</dl>
</dd>
<dt class="field-even">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param epsilon<span class="colon">:</span></dt>
<dd class="field-odd"><p>epsilon parameter for limb darkening in rotational broadening (default = 0.6)</p>
</dd>
<dt class="field-even">param verbose<span class="colon">:</span></dt>
<dd class="field-even"><p>provide extra feedback (default = False)</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Outputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None; Spectral flux is smoothed by rotational broadening</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="mi">10001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">vsini</span><span class="p">(</span><span class="mf">30.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go"> History:</span>
<span class="go">     SPEX_PRISM spectrum successfully loaded</span>
<span class="go">     Rotationally broadened spectrum by 30.0 km/s</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.rvShift">
<span class="sig-name descname"><span class="pre">rvShift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.rvShift" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Shifts the wavelength scale by a given radial velocity. This routine changes the underlying Spectrum object.</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">rvShift</span><span class="p">(</span><span class="mi">15</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'median'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.sample" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Obtains a sample of spectrum over specified wavelength range</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param range<span class="colon">:</span></dt>
<dd class="field-odd"><p>the range(s) over which the spectrum is sampled</p>
</dd>
</dl>
<p>a single 2-element array or array of 2-element arrays</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p>TBD</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.save" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Exports a Spectrum object to either a fits or ascii file, depending on file extension given.  If no filename is explicitly given, the Spectrum.filename attribute is used. If the filename does not include the full path, the file is saved in the current directory.</p>
</dd>
</dl>
<p><a class="reference external" href="api.html#splat.core.Spectrum.export">Spectrum.export()</a> and <cite>Spectrum.save</cite> function in the same manner.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.scale">
<span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noiseonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.scale" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scales a Spectrum object's flux and noise values by a constant factor.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param factor<span class="colon">:</span></dt>
<dd class="field-odd"><p>A floating point number used to scale the Spectrum object</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param noiseonly = False<span class="colon">:</span></dt>
<dd class="field-odd"><p>scale only the noise and variance, useful when uncertainty is under/over estimated</p>
</dd>
</dl>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>None; spectrum is scaled</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336634332284e-14 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.5198</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">1.e15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336549758911 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.51981</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.setNoise">
<span class="sig-name descname"><span class="pre">setNoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">floor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.setNoise" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Sets the noise and variance array of the spectrum based on rough counting statistics;
this routine is useful if the input spectrum has no input noise array</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>One of the following must be provided:</p>
<ul class="simple">
<li><p><em>rng</em>: 2-element list specifying the range</p></li>
<li><p><em>floor</em> = 0.: floor of uncertainty in spectrum flux units</p></li>
</ul>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>Updates the noise and variance elements of Spectrum class</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span><span class="o">,</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>  <span class="c1"># reports 25.9118</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">noise</span> <span class="o">=</span> <span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">nan</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">sp</span><span class="o">.</span><span class="n">noise</span><span class="p">]</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>  <span class="c1"># reports nan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">setNoise</span><span class="p">([</span><span class="n">floor</span><span class="o">=</span><span class="mf">1.e-3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>  <span class="c1"># reports 25.5425</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.showHistory">
<span class="sig-name descname"><span class="pre">showHistory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.showHistory" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Report history of actions taken on a Spectrum object.
This can also be retrieved by printing the attribute Spectrum.history</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>List of actions taken on spectrum</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxCalibrate</span><span class="p">(</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">,</span><span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">showHistory</span><span class="p">()</span>
<span class="go"> Spectrum successfully loaded</span>
<span class="go"> Spectrum normalized</span>
<span class="go"> Flux calibrated with 2MASS J filter to an apparent magnitude of 15.0</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.smooth">
<span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slitwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.smooth" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Smoothes a spectrum either by selecting a constant slit width
(smooth in spectral dispersion space), pixel width (smooth in pixel space)
or resolution (smooth in velocity space). One of these options must be selected
for any smoothing to happen. Changes spectrum directly.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param method<span class="colon">:</span></dt>
<dd class="field-odd"><p>the type of smoothing window to use; see <a class="reference external" href="http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.signal.get_window.html">http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.signal.get_window.html</a> for more details (default = 'hamming')</p>
</dd>
<dt class="field-even">param resolution<span class="colon">:</span></dt>
<dd class="field-even"><p>Constant resolution to smooth to; see <a class="reference external" href="api.html#splat.core.Spectrum._smoothToResolution">_smoothToResolution()</a> (default = None)</p>
</dd>
<dt class="field-odd">param slitPixelWidth<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of pixels to smooth in pixel space; see <a class="reference external" href="api.html#splat.core.Spectrum._smoothToSlitPixelWidth">_smoothToSlitPixelWidth()</a> (default = None)</p>
</dd>
<dt class="field-even">param slitWidth<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of pixels to smooth in angular space; see <a class="reference external" href="api.html#splat.core.Spectrum._smoothToPixelWidth">_smoothToPixelWidth()</a> (default = None)</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>None: spectrum is smoothed</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.toAngstrom">
<span class="sig-name descname"><span class="pre">toAngstrom</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.toAngstrom" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts wavelength to Angstrom</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectrum object is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;micron&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toAngstrom</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;Angstrom&quot;)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.toBrightnessTemperature">
<span class="sig-name descname"><span class="pre">toBrightnessTemperature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">limbdarkening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limbdarkeningcoeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.toBrightnessTemperature" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Convert to surface fluxes given a radius, assuming at absolute fluxes</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.toFlam">
<span class="sig-name descname"><span class="pre">toFlam</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.toFlam" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts flux density to F_lambda in units of erg/s/cm^2/Hz.
There is no change if the spectrum is already in F_lambda units.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectrum object is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toFnu</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;Jy&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toFlam</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;erg / (cm2 micron s)&quot;)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.toFluxUnit">
<span class="sig-name descname"><span class="pre">toFluxUnit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux_unit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.toFluxUnit" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts flux and noise arrays to given flux units.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectrum object is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;somespectrum&#39;</span><span class="p">,</span><span class="n">wave_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Angstrom</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> erg / (cm2 micron s)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toFluxUnit</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Watt</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> W / m2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toFluxUnit</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">erg</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Warning! failed to convert flux unit from W / m2 to erg / s; no change made</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.toFnu">
<span class="sig-name descname"><span class="pre">toFnu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.toFnu" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts flux density F_nu in units of Jy.
There is no change if the spectrum is already in F_nu units.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectrum object is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toFnu</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;Jy&quot;)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.toInstrument">
<span class="sig-name descname"><span class="pre">toInstrument</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instrument</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.toInstrument" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts a spectrum to the parameters for a defined instrument</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param instrument<span class="colon">:</span></dt>
<dd class="field-odd"><p>the name of an instrument, must be defined in splat.INSTRUMENTS</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectrum object is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p>TBD</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.toMicron">
<span class="sig-name descname"><span class="pre">toMicron</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.toMicron" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts wavelength to microns.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectrum object is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;somespectrum&#39;</span><span class="p">,</span><span class="n">wave_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Angstrom</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;Angstrom&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toMicron</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;micron&quot;)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.toSED">
<span class="sig-name descname"><span class="pre">toSED</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.toSED" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts flux density in F_lambda to lambda x F_lambda with units of erg/s/cm^2.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectrum object is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toSED</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;erg / (cm2 s)&quot;)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.toSurface">
<span class="sig-name descname"><span class="pre">toSurface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radius</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.toSurface" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Convert to surface fluxes given a radius, assuming at absolute fluxes</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>UNTESTED, NEED TO ADD IN UNCERTAINTIES</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.toWaveUnit">
<span class="sig-name descname"><span class="pre">toWaveUnit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave_unit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.toWaveUnit" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts wavelength to specified units.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectrum object is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;somespectrum&#39;</span><span class="p">,</span><span class="n">wave_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Angstrom</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
<span class="go">  Angstrom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toWaveUnit</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">micron</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
<span class="go">  micron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toWaveUnit</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
<span class="go">  Warning! failed to convert wavelength unit from micron to s; no change made</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.toWavelengths">
<span class="sig-name descname"><span class="pre">toWavelengths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.toWavelengths" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Maps a spectrum onto a new wavelength grid via interpolation or integral resampling</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param wave<span class="colon">:</span></dt>
<dd class="field-odd"><p>wavelengths to map to</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param force = True<span class="colon">:</span></dt>
<dd class="field-odd"><p>proceed with conversion even if wavelength ranges are not perfectly in range</p>
</dd>
<dt class="field-even">param verbose = False<span class="colon">:</span></dt>
<dd class="field-even"><p>provide verbose feedback</p>
</dd>
</dl>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectrum object is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p>TBD</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.trim">
<span class="sig-name descname"><span class="pre">trim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.trim" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Trims a spectrum to be within a certain wavelength range or set of ranges.
Data outside of these ranges are excised from the wave, flux and noise arrays.
The full spectrum can be restored with the reset() procedure.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param range<span class="colon">:</span></dt>
<dd class="field-odd"><p>the range(s) over which the spectrum is retained - a series of nested 2-element arrays</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">smoothfluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336634332284e-14 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.5198</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">1.e15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336549758911 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.51981</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.updateSourceInfo">
<span class="sig-name descname"><span class="pre">updateSourceInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius=&lt;Quantity</span> <span class="pre">10.</span> <span class="pre">arcsec&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.updateSourceInfo" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Updates the source information for a spectrum object based on the SPLAT Source Database
Uses either the spectrum object's or user supplied NAME, DESIGNATION, COORDINATE or RA &amp; DEC
If none of these are supplied, no search is done</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>name</em>: Name of source
<em>designation</em>: designation of source in format Jhhmmss[.]ss±ddmmss[.]ss
<em>shortname</em>: shortname desigation of source in format Jhhmm±ddmm
<em>coordinate</em>: coordinate of object, in astropy SkyCoord format or transferable via properCoordinates()
<em>ra</em>, <em>dec</em>: RA and Declination of source in degrees
<em>radius</em>: search radius (default = 10 arcseconds)
<em>verbose</em>: set to True to provide feedback</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>Spectrum object will have the Source Library keywords added or updated</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">smoothfluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336634332284e-14 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.5198</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">1.e15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336549758911 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.51981</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="splat.core.Spectrum.waveRange">
<span class="sig-name descname"><span class="pre">waveRange</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.waveRange" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return the wavelength range of the current Spectrum object.</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>2-element array giving minimum and maximum of wavelength range</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">slitwidth</span>
<span class="go">[&lt;Quantity 0.6447611451148987 micron&gt;, &lt;Quantity 2.5517737865448 micron&gt;]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="splat-routines">
<h2>SPLAT Routines<a class="headerlink" href="#splat-routines" title="Link to this heading">¶</a></h2>
<section id="data-and-database-access">
<h3>Data and Database Access<a class="headerlink" href="#data-and-database-access" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="splat.core.getSpectrum">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">getSpectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spectra'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'DATA_KEY'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.getSpectrum" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>output = 'spectra'</strong><span class="classifier">str [optional]</span></dt><dd><dl class="simple">
<dt>Determines what is returned to user; options are:</dt><dd><ul class="simple">
<li><p>'spectra': return array of Spectrum objects [default]</p></li>
<li><p>'files': return a list of filenames</p></li>
<li><p>'table': return pandas table of spectral information (output of <a href="#id142"><span class="problematic" id="id143">`searchLibrary()`_</span></a>)</p></li>
</ul>
</dd>
</dl>
</dd>
<dt><strong>limit = 0</strong><span class="classifier">int [optional]</span></dt><dd><p>Sets limit for the number of returns. Set to &lt; 0 to return unlimited number</p>
</dd>
<dt><strong>key = 'DATA_KEY'</strong><span class="classifier">str [optional]</span></dt><dd><p>Keyword for the data key in the database file</p>
</dd>
<dt><strong>verbose = True</strong><span class="classifier">bool [optional]</span></dt><dd><p>Set to True to provide feedback</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">additional keywords</span></dt><dd><p>Include additional keywords for <a href="#id144"><span class="problematic" id="id145">`searchLibrary()`_</span></a></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.getStandard">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">getStandard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spt</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.getStandard" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Gets one of the pre-defined spectral standards from the SPLAT library.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>spt</strong> (<em>required</em>) -- Spectral type of standard desired, either string ('M7') or numberic (17)</p></li>
<li><p><strong>sd</strong> (<em>optional</em><em>, </em><em>default = False</em>) -- Set to True to get a subdwarf standard</p></li>
<li><p><strong>esd</strong> (<em>optional</em><em>, </em><em>default = False</em>) -- Set to True to get an extreme subdwarf standard</p></li>
</ul>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getStandard</span><span class="p">(</span><span class="s1">&#39;M7&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">    Spectrum of VB 8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sparr</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getStandard</span><span class="p">(</span><span class="s1">&#39;T5&#39;</span><span class="p">,</span><span class="n">esd</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    Type esdT5.0 is not in esd standards: try one of the following:</span>
<span class="go">    [&#39;esdM5.0&#39;, &#39;esdM7.0&#39;, &#39;esdM8.5&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.searchLibrary">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">searchLibrary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">radius=10.0,</span> <span class="pre">instrument='SPEX-PRISM',</span> <span class="pre">source_database=</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">SOURCE_KEY</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">NAME</span>&#160; <span class="pre">...</span> <span class="pre">VSINI_REF</span>&#160; <span class="pre">NOTE</span> <span class="pre">0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">10001</span>&#160;&#160;&#160; <span class="pre">SDSS</span> <span class="pre">J000013.54+255418.6</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">NaN</span>&#160;&#160; <span class="pre">NaN</span> <span class="pre">1</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">10002</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">2MASS</span> <span class="pre">J0000286-124515</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">NaN</span>&#160;&#160; <span class="pre">NaN</span> <span class="pre">2</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">10003</span>&#160;&#160;&#160; <span class="pre">SDSS</span> <span class="pre">J000112.18+153535.5</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">NaN</span>&#160;&#160; <span class="pre">NaN</span> <span class="pre">3</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">10004</span>&#160;&#160;&#160;&#160; <span class="pre">2MASS</span> <span class="pre">J00013044+1010146</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">NaN</span>&#160;&#160; <span class="pre">NaN</span> <span class="pre">4</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">10005</span>&#160;&#160;&#160; <span class="pre">WISE</span> <span class="pre">J000131.93-084126.9</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">NaN</span>&#160;&#160; <span class="pre">NaN</span> <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">...</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">...</span>&#160;&#160; <span class="pre">...</span> <span class="pre">2710</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">12830</span>&#160; <span class="pre">SDSS</span> <span class="pre">J034707.61+041754.0AB</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">NaN</span>&#160;&#160; <span class="pre">NaN</span> <span class="pre">2711</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">12831</span>&#160;&#160; <span class="pre">SDSS</span> <span class="pre">J034707.61+041754.0B</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">NaN</span>&#160;&#160; <span class="pre">NaN</span> <span class="pre">2712</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">12832</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">LHS</span>&#160; <span class="pre">5097</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">NaN</span>&#160;&#160; <span class="pre">NaN</span> <span class="pre">2713</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">12833</span>&#160;&#160;&#160;&#160; <span class="pre">2MASS</span> <span class="pre">J04333153-0211010</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">NaN</span>&#160;&#160; <span class="pre">NaN</span> <span class="pre">2714</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">12834</span>&#160;&#160;&#160;&#160; <span class="pre">2MASS</span> <span class="pre">J05102012+2714032</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">NaN</span>&#160;&#160; <span class="pre">NaN</span>&#160; <span class="pre">[2715</span> <span class="pre">rows</span> <span class="pre">x</span> <span class="pre">62</span> <span class="pre">columns],</span> <span class="pre">spectra_database=</span>&#160;&#160;&#160;&#160;&#160; <span class="pre">DATA_KEY</span>&#160; <span class="pre">SOURCE_KEY</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">DATA_REFERENCE</span> <span class="pre">NOTE</span> <span class="pre">0</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">10001</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">10443</span>&#160; <span class="pre">...</span>&#160; <span class="pre">2004PASP..116..362C</span>&#160; <span class="pre">NaN</span> <span class="pre">1</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">10002</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">10782</span>&#160; <span class="pre">...</span>&#160; <span class="pre">2004AJ....127.2856B</span>&#160; <span class="pre">NaN</span> <span class="pre">2</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">10003</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">10830</span>&#160; <span class="pre">...</span>&#160; <span class="pre">2004AJ....127.2856B</span>&#160; <span class="pre">NaN</span> <span class="pre">3</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">10004</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">10916</span>&#160; <span class="pre">...</span>&#160; <span class="pre">2004AJ....127.2856B</span>&#160; <span class="pre">NaN</span> <span class="pre">4</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">10005</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">11020</span>&#160; <span class="pre">...</span>&#160; <span class="pre">2004AJ....127.2856B</span>&#160; <span class="pre">NaN</span> <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">...</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">...</span>&#160; <span class="pre">...</span> <span class="pre">3084</span>&#160;&#160;&#160;&#160; <span class="pre">13100</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">12830</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">BURGASSER-NP</span>&#160; <span class="pre">NaN</span> <span class="pre">3085</span>&#160;&#160;&#160;&#160; <span class="pre">13101</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">12831</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">BURGASSER-NP</span>&#160; <span class="pre">NaN</span> <span class="pre">3086</span>&#160;&#160;&#160;&#160; <span class="pre">13102</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">12832</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">BURGASSER-NP</span>&#160; <span class="pre">NaN</span> <span class="pre">3087</span>&#160;&#160;&#160;&#160; <span class="pre">13103</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">12833</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">BURGASSER-NP</span>&#160; <span class="pre">NaN</span> <span class="pre">3088</span>&#160;&#160;&#160;&#160; <span class="pre">13104</span>&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">12834</span>&#160; <span class="pre">...</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">BURGASSER-NP</span>&#160; <span class="pre">NaN</span>&#160; <span class="pre">[3089</span> <span class="pre">rows</span> <span class="pre">x</span> <span class="pre">22</span> <span class="pre">columns],</span> <span class="pre">*args,</span> <span class="pre">**kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.searchLibrary" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Searches the SpeX database based on a series of keywords;
returns an astropy Table with the source and spectral information corresponding to the selected sources</p>
</dd>
<dt class="field-even">Required Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><dl class="field-list simple">
<dt class="field-odd">param name<span class="colon">:</span></dt>
<dd class="field-odd"><p>search by source name (e.g., <code class="docutils literal notranslate"><span class="pre">name</span> <span class="pre">=</span> <span class="pre">'Gliese</span> <span class="pre">570D'</span></code>); default = None</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param shortname<span class="colon">:</span></dt>
<dd class="field-odd"><p>search be short name or list of short names (e.g. <code class="docutils literal notranslate"><span class="pre">shortname</span> <span class="pre">=</span> <span class="pre">'J1457-2124'</span></code>); default = None</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param exclude_shortname<span class="colon">:</span></dt>
<dd class="field-odd"><p>exclude a list of short names (e.g. <code class="docutils literal notranslate"><span class="pre">excludeshortname</span> <span class="pre">=</span> <span class="pre">'J1457-2124'</span></code>); default = None</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param designation<span class="colon">:</span></dt>
<dd class="field-odd"><p>search by full designation (e.g., <code class="docutils literal notranslate"><span class="pre">designation</span> <span class="pre">=</span> <span class="pre">'J11040127+1959217'</span></code>); default = None</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param coordinate<span class="colon">:</span></dt>
<dd class="field-odd"><p>search around a coordinate by a radius specified by radius keyword (e.g., <code class="docutils literal notranslate"><span class="pre">coordinate</span> <span class="pre">=</span> <span class="pre">[180.,+30.],</span> <span class="pre">radius</span> <span class="pre">=</span> <span class="pre">10.</span></code>); coordinate can be an astropy SkyCoord, list of [RA, DEC], or designation; default = None</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param source, source_key, id, id_key<span class="colon">:</span></dt>
<dd class="field-odd"><p>search for a specific spectra based on single or list of id number or list of numbers (e.g., <code class="docutils literal notranslate"><span class="pre">source_key</span> <span class="pre">=</span> <span class="pre">[10002,10005]</span></code>)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param data_key<span class="colon">:</span></dt>
<dd class="field-odd"><p>search for a specific spectra based on single or list of data key numbers (e.g., <code class="docutils literal notranslate"><span class="pre">data_key</span> <span class="pre">=</span> <span class="pre">[10002,10005]</span></code>)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param exclude_data_key<span class="colon">:</span></dt>
<dd class="field-odd"><p>exclude specific spectra based on single or list of data key numbers (e.g., <code class="docutils literal notranslate"><span class="pre">exclude_data_key</span> <span class="pre">=</span> <span class="pre">[10002,10005]</span></code>)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param file<span class="colon">:</span></dt>
<dd class="field-odd"><p>search by specific filename or list of filenames (e.g., <code class="docutils literal notranslate"><span class="pre">file</span> <span class="pre">=</span> <span class="pre">'myspectrum.fits</span></code>)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param exclude_file<span class="colon">:</span></dt>
<dd class="field-odd"><p>exclude by specific filename or list of filenames (e.g., <code class="docutils literal notranslate"><span class="pre">exclude_file</span> <span class="pre">=</span> <span class="pre">'myspectrum.fits</span></code>)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param radius<span class="colon">:</span></dt>
<dd class="field-odd"><p>search radius in arcseconds for coordinate search; default = 10.</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param spt<span class="colon">:</span></dt>
<dd class="field-odd"><p>search by spectral type, which by default is the SpeX-based type; single value is exact, two-element array gives range (e.g., <code class="docutils literal notranslate"><span class="pre">spt</span> <span class="pre">=</span> <span class="pre">'M7'</span></code> or <code class="docutils literal notranslate"><span class="pre">spt</span> <span class="pre">=</span> <span class="pre">[24,39]</span></code>); can also specify:
* :param spex_spt: same as <code class="docutils literal notranslate"><span class="pre">spt</span></code>
* :param opt_spt: same as <code class="docutils literal notranslate"><span class="pre">spt</span></code> for literature optical spectral types
* :param nir_spt: same as <code class="docutils literal notranslate"><span class="pre">spt</span></code> for literature NIR spectral types
* :param lit_spt: same as <code class="docutils literal notranslate"><span class="pre">spt</span></code> for literature spectral types from SIMBAD</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param jmag, hmag, kmag<span class="colon">:</span></dt>
<dd class="field-odd"><p>select based on faint limit or range of J, H or Ks magnitudes (e.g., <code class="docutils literal notranslate"><span class="pre">jmag</span> <span class="pre">=</span> <span class="pre">11</span></code> or <code class="docutils literal notranslate"><span class="pre">jmag</span> <span class="pre">=</span> <span class="pre">[12,15]</span></code>); default = None</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param snr<span class="colon">:</span></dt>
<dd class="field-odd"><p>search on minimum or range of S/N ratios (e.g., <code class="docutils literal notranslate"><span class="pre">snr</span> <span class="pre">=</span> <span class="pre">30.</span></code> or <code class="docutils literal notranslate"><span class="pre">snr</span> <span class="pre">=</span> <span class="pre">[50.,100.]</span></code>)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param subdwarf, young, lowg, binary, sbinary, red, blue, giant, wd, standard, companion, peculiar<span class="colon">:</span></dt>
<dd class="field-odd"><p>classes to search on or exclude (e.g., <code class="docutils literal notranslate"><span class="pre">young</span> <span class="pre">=</span> <span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">giant</span> <span class="pre">=</span> <span class="pre">False</span></code>)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param cluster<span class="colon">:</span></dt>
<dd class="field-odd"><p>select sources in specfic clusters (e.g., <code class="docutils literal notranslate"><span class="pre">cluster</span> <span class="pre">=</span> <span class="pre">'TWA'</span></code>)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param giant_class or luminosity_class<span class="colon">:</span></dt>
<dd class="field-odd"><p>select sources based on luminosity class; this does not work for dwarfs (e.g., <code class="docutils literal notranslate"><span class="pre">luminosity_class</span> <span class="pre">=</span> <span class="pre">'I'</span></code>)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param subdwarf_class or metallicity_class<span class="colon">:</span></dt>
<dd class="field-odd"><p>select sources based on metallicty class; (e.g., <code class="docutils literal notranslate"><span class="pre">metallicity_class</span> <span class="pre">=</span> <span class="pre">'sd'</span></code>)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param date<span class="colon">:</span></dt>
<dd class="field-odd"><p>search by observation date (e.g., <code class="docutils literal notranslate"><span class="pre">date</span> <span class="pre">=</span> <span class="pre">'20040322'</span></code>) or range of dates (e.g., <code class="docutils literal notranslate"><span class="pre">date=[20040301,20040330]</span></code>)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param instrument<span class="colon">:</span></dt>
<dd class="field-odd"><p>search by instrument; must be designated instrument in splat.INSTRUMENTS variable (e.g., <code class="docutils literal notranslate"><span class="pre">instrument</span> <span class="pre">=</span> <span class="pre">'SPEX_PRISM'</span></code>)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param reference<span class="colon">:</span></dt>
<dd class="field-odd"><p>search by list of references (bibcodes) (e.g., <code class="docutils literal notranslate"><span class="pre">reference</span> <span class="pre">=</span> <span class="pre">'2011ApJS..197...19K'</span></code>)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param logic, combine<span class="colon">:</span></dt>
<dd class="field-odd"><p>search logic, can be <code class="docutils literal notranslate"><span class="pre">and</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">or</span></code></p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param sort<span class="colon">:</span></dt>
<dd class="field-odd"><p>by default returned table is sorted by designation; set this parameter to a column name to sort on a different parameter</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param reverse<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to do a reverse sort (default = False)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param list<span class="colon">:</span></dt>
<dd class="field-odd"><p>if True, return just a list of the data files (default = False)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param lucky<span class="colon">:</span></dt>
<dd class="field-odd"><p>if True, return one randomly selected spectrum from the selected sample (default = False)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param output<span class="colon">:</span></dt>
<dd class="field-odd"><p>returns desired column of selected results (default = 'all')</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">SearchLibrary</span><span class="p">(</span><span class="n">shortname</span> <span class="o">=</span> <span class="s1">&#39;2213-2136&#39;</span><span class="p">)</span>
<span class="go">    DATA_KEY SOURCE_KEY    DATA_FILE     ... SHORTNAME  SELECT_2</span>
<span class="go">    -------- ---------- ---------------- ... ---------- --------</span>
<span class="go">       11590      11586 11590_11586.fits ... J2213-2136      1.0</span>
<span class="go">       11127      11586 11127_11586.fits ... J2213-2136      1.0</span>
<span class="go">       10697      11586 10697_11586.fits ... J2213-2136      1.0</span>
<span class="go">       10489      11586 10489_11586.fits ... J2213-2136      1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">SearchLibrary</span><span class="p">(</span><span class="n">shortname</span> <span class="o">=</span> <span class="s1">&#39;2213-2136&#39;</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;OBSERVATION_DATE&#39;</span><span class="p">)</span>
<span class="go">    OBSERVATION_DATE</span>
<span class="go">    ----------------</span>
<span class="go">            20110908</span>
<span class="go">            20080829</span>
<span class="go">            20060902</span>
<span class="go">            20051017</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that this is currently only and AND search - need to figure out how to a full SQL style search</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.keySource">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">keySource</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.keySource" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>keys</strong><span class="classifier">int or list</span></dt><dd><p>integer or list of integers corresponding to source keys</p>
</dd>
<dt><strong>verbose = True</strong><span class="classifier">boolean [optional]</span></dt><dd><p>set to True to have program return verbose output</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.keySpectrum">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">keySpectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.keySpectrum" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>keys</strong><span class="classifier">int or list</span></dt><dd><p>integer or list of integers corresponding to source keys</p>
</dd>
<dt><strong>verbose = True</strong><span class="classifier">boolean [optional]</span></dt><dd><p>set to True to have program return verbose output</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.initiateStandards">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">initiateStandards</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dwarf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdwarf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">young</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allstds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dsd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vlg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.initiateStandards" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spt = []</strong><span class="classifier">None, int, float, str, or list [optional]</span></dt><dd><p>spectral type range to limit standards; if empty list or None, reads in all relevant standards</p>
</dd>
<dt><strong>dwarf = True</strong><span class="classifier">boolean [optional]</span></dt><dd><p>by default, read in dwarf standards</p>
</dd>
<dt><strong>subdwarf = False</strong><span class="classifier">boolean [optional]</span></dt><dd><p>read in d/sd, sd and esd standards</p>
</dd>
<dt><strong>young = False</strong><span class="classifier">boolean [optional]</span></dt><dd><p>read in intg and vlg standards</p>
</dd>
<dt><strong>allstds = False</strong><span class="classifier">boolean [optional]</span></dt><dd><p>read in dwarf, subdwarf, and young standards</p>
</dd>
<dt><strong>dsd = False</strong><span class="classifier">boolean [optional]</span></dt><dd><p>read in mild subdwarf standards</p>
</dd>
<dt><strong>sd = False</strong><span class="classifier">boolean [optional]</span></dt><dd><p>read in subdwarf standards</p>
</dd>
<dt><strong>esd = False</strong><span class="classifier">boolean [optional]</span></dt><dd><p>read in extreme subdwarf standards</p>
</dd>
<dt><strong>int = False</strong><span class="classifier">boolean [optional]</span></dt><dd><p>read in intermediate low gravity standards</p>
</dd>
<dt><strong>vlg = False</strong><span class="classifier">boolean [optional]</span></dt><dd><p>read in very low gravity standards</p>
</dd>
<dt><strong>reset = False</strong><span class="classifier">boolean [optional]</span></dt><dd><p>set to True to re-read in spectral standards (replaces those in place)</p>
</dd>
<dt><strong>output = False</strong><span class="classifier">boolean [optional]</span></dt><dd><p>set to True to return the standards dictionary as output</p>
</dd>
<dt><strong>verbose = False</strong><span class="classifier">boolean [optional]</span></dt><dd><p>set to True to have program return verbose output</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.addUserData">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">addUserData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.addUserData" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Reads in list of folders with properly processed model sets, checks them, and adds them to the SPECTRAL_MODELS global variable</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><dl class="field-list simple">
<dt class="field-odd">param folders = []<span class="colon">:</span></dt>
<dd class="field-odd"><p>By default model folders are set in the .splat_spectral_models file;</p>
</dd>
</dl>
</li>
</ul>
<p>alternately (or in addition) folders of models can be included as an input list.
* :param default_info = {}: default parameter set to use for models; superceded by 'info.txt' file if present in model folder
* :param verbose = False: provide verbose feedback</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None, simply adds new model sets to SPECTRAL_MODELS global variable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id0">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">export</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clobber</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">csv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'\t'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Exports a Spectrum object to either a fits or ascii file, depending on file extension given.
If no filename is explicitly given, the Spectrum.filename attribute is used.
If the filename does not include the full path, the file is saved in the current directory.
Spectrum.export and <a class="reference external" href="api.html#splat.core.Spectrum.save">Spectrum.save()</a> function in the same manner.</p>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd">Required Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param filename<span class="colon">:</span></dt>
<dd class="field-odd"><p>String specifying the filename to save; filename can also be included as an argument; if not provided, Spectrum.filename is used; alternate keywords: <cite>file</cite></p>
</dd>
<dt class="field-even">param clobber<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to True to overwrite file, or False to raise flag if file exists (default = True)</p>
</dd>
<dt class="field-odd">param csv<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to True to write a CSV (comma-delimited) file (default = False)</p>
</dd>
<dt class="field-even">param tab<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to True to write a tab-delimited file (default = True)</p>
</dd>
<dt class="field-odd">param delimiter<span class="colon">:</span></dt>
<dd class="field-odd"><p>character or string to specify as delimiter between columns (default = '  '); alternate keywords: <cite>sep</cite></p>
</dd>
<dt class="field-even">param save_header<span class="colon">:</span></dt>
<dd class="field-even"><p>set to True to add header to ascii files (default = True)</p>
</dd>
<dt class="field-odd">param save_noise<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to save the noise column (default = True)</p>
</dd>
<dt class="field-even">param comment<span class="colon">:</span></dt>
<dd class="field-even"><p>use to specify comment character (default = '#')</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>An ascii or fits file with the data and header</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="s1">&#39;/Users/adam/myspectrum.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">ascii</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">ascii</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;/Users/adam/myspectrum.txt&#39;</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;tab&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>
<span class="go"> &lt;Table length=564&gt;</span>
<span class="go">   wavelength          flux          uncertainty</span>
<span class="go">    float64          float64           float64</span>
<span class="go"> -------------- ----------------- -----------------</span>
<span class="go"> 0.645418405533               0.0               nan</span>
<span class="go"> 0.647664904594 6.71920214475e-16 3.71175052033e-16</span>
<span class="go"> 0.649897933006 1.26009925777e-15 3.85722895842e-16</span>
<span class="go"> 0.652118623257 7.23781818374e-16 3.68178778862e-16</span>
<span class="go"> 0.654327988625 1.94569566622e-15 3.21007116982e-16</span>
<span class="go"> ...</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id2">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id2" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Exports a Spectrum object to either a fits or ascii file, depending on file extension given.  If no filename is explicitly given, the Spectrum.filename attribute is used. If the filename does not include the full path, the file is saved in the current directory.</p>
</dd>
</dl>
<p><a class="reference external" href="api.html#splat.core.Spectrum.export">Spectrum.export()</a> and <cite>Spectrum.save</cite> function in the same manner.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.readSpectrum">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">readSpectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Unit('micron')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Unit('erg</span> <span class="pre">/</span> <span class="pre">(micron</span> <span class="pre">s</span> <span class="pre">cm2)')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensionless</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crval1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CRVAL1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cdelt1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CDELT1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_sn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_zero_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_instrument_reader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SPEX-PRISM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.readSpectrum" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file</strong><span class="classifier">string</span></dt><dd><p>filename of data to be read in; if full path not provided, routine will search in local directory
or in folder indicated by folder keyword; can also pass a URL to a remote file</p>
</dd>
<dt><strong>folder = ''</strong><span class="classifier">string [optional]</span></dt><dd><p>full path to folder containing file</p>
</dd>
<dt><strong>file_type = ''</strong><span class="classifier">string [optional]</span></dt><dd><dl class="simple">
<dt>a string indicating some flags that specify what kind of file this is; some examples include:</dt><dd><ul class="simple">
<li><p>csv = comma separated file (sets delimiter = ',')</p></li>
<li><p>tab or tsv = tab delimited file (sets delimiter = '       ')</p></li>
<li><p>pipe = pipe delimited file (sets delimiter = '|')</p></li>
<li><p>latex = latex-style table data (sets delimiter = ' &amp; ')</p></li>
<li><p>waveheader = wavelength solution is contained within the fits header</p></li>
<li><p>wavelog = wavelength solution is logarithmic (common for echelle data)</p></li>
<li><p>sdss = sets both waveheader and wavelog</p></li>
</ul>
</dd>
</dl>
</dd>
<dt><strong>wave_unit = DEFAULT_WAVE_UNIT</strong><span class="classifier">astropy.unit [optional]</span></dt><dd><p>units of wavelength axis, by default specified by the DEFAULT_WAVE_UNIT global parameter</p>
</dd>
<dt><strong>flux_unit = DEFAULT_FLUX_UNIT</strong><span class="classifier">astropy.unit [optional]</span></dt><dd><p>units of flux and uncertainty axes, by default specified by the DEFAULT_FLUX_UNIT global parameter
note that you can specify a unitless number</p>
</dd>
<dt><strong>dimensionless = False</strong><span class="classifier">boolean [optional]</span></dt><dd><p>set to True to set the flux units to a dimensionless quantity (for transmission, reflectance)</p>
</dd>
<dt><strong>comment = '#'</strong><span class="classifier">string [optional]</span></dt><dd><p>for ascii files, character that indicates the file line is a comment (to be ignored)</p>
</dd>
<dt><strong>delimiter = ''</strong><span class="classifier">string [optional]</span></dt><dd><p>for ascii files, character that separates columns of values</p>
</dd>
<dt><strong>crval1,cdelt1 = 'CRVAL1','CDELT1'</strong><span class="classifier">string [optional]</span></dt><dd><p>for fits files for which the wavelength solution is embedded in header,
these are the keywords containing the zeroth wavelength and linear change coefficient</p>
</dd>
<dt><strong>catch_sn = True</strong><span class="classifier">boolean [optional]</span></dt><dd><p>set to True to check if uncertainty axis is actually signal-to-noise,
by checking if median(flux/uncertainty) &lt; 1 [NOTE: NO LONGER IMPLEMENTED]</p>
</dd>
<dt><strong>remove_nans = True</strong><span class="classifier">boolean [optional]</span></dt><dd><p>set to True to remove all wave/flux/noise values for which wave or flux are nan</p>
</dd>
<dt><strong>no_zero_noise = True</strong><span class="classifier">boolean [optional]</span></dt><dd><p>set to True to set all elements of noise array that are zero to numpy.nan;
this helps in later computations of S/N or fit statistics</p>
</dd>
<dt><strong>use_instrument_reader = True</strong><span class="classifier">bool [optional]</span></dt><dd><p>set to True to use the default instrument read in the DEFAULT-INSTRUMENT global parameter
checked against INSTRUMENTS dictionary</p>
</dd>
<dt><strong>instrument = DEFAULT_INSTRUMENT</strong><span class="classifier">string [optional]</span></dt><dd><p>instrument by which data was acquired, by default the DEFAULT-INSTRUMENT global parameter
checked against INSTRUMENTS dictionary</p>
</dd>
<dt><strong>instrument_param = {}</strong><span class="classifier">dict [optional]</span></dt><dd><p>instrument-specific parameters to pass to instrument reader</p>
</dd>
<dt><strong>verbose = False</strong><span class="classifier">boolean [optional]</span></dt><dd><p>set to True to have program return verbose output</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.checkInstrument">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">checkInstrument</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instrument</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.checkInstrument" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Purpose:</dt><dd><p>Checks that an instrument name is one of the available instruments, including a check of alternate names</p>
</dd>
<dt>Required Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>instrument: A string containing the instrument name to be checked. This should be one of the instruments in the global parameter splat.initialize.INSTRUMENTS</p>
</dd>
</dl>
</dd>
<dt>Optional Inputs:</dt><dd><p>None</p>
</dd>
<dt>Output:</dt><dd><p>A string containing SPLAT's default name for a given instrument, or False if that instrument is not present</p>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">checkInstrument</span><span class="p">(</span><span class="s1">&#39;SPEX PRISM&#39;</span><span class="p">)</span>
<span class="go">    SPEX-PRISM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">checkInstrument</span><span class="p">(</span><span class="s1">&#39;LRIS&#39;</span><span class="p">)</span>
<span class="go">    LRIS-RED</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">checkInstrument</span><span class="p">(</span><span class="s1">&#39;somethingelse&#39;</span><span class="p">)</span>
<span class="go">    False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.checkLocation">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">checkLocation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">location</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.checkLocation" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Purpose:</dt><dd><p>Duplicate of checkTelescope()</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.checkTelescope">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">checkTelescope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">location</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.checkTelescope" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Purpose:</dt><dd><p>Checks that a location name is one of the telecopes listed in splat.initialize.TELESCOPES, including a check of alternate names</p>
</dd>
<dt>Required Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>location: A string containing the telescope/site name to be checked. This should be one of the locations in the global parameter splat.initialize.TELESCOPES</p>
</dd>
</dl>
</dd>
<dt>Optional Inputs:</dt><dd><p>None</p>
</dd>
<dt>Output:</dt><dd><p>A string containing SPLAT's default name for a given telescope, or False if that telecope is not present</p>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">splat</span><span class="o">.</span><span class="n">checkTelescope</span><span class="p">(</span><span class="s1">&#39;keck&#39;</span><span class="p">))</span>
<span class="go">    KECK</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">splat</span><span class="o">.</span><span class="n">checkTelescope</span><span class="p">(</span><span class="s1">&#39;mauna kea&#39;</span><span class="p">))</span>
<span class="go">    KECK</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">splat</span><span class="o">.</span><span class="n">checkTelescope</span><span class="p">(</span><span class="s1">&#39;somethingelse&#39;</span><span class="p">))</span>
<span class="go">    False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.checkKeys">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">checkKeys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.checkKeys" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Checks the input kwargs keys against the expected parameters of a function to make sure the right parameters are passed.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>input</strong> -- input dictionary to a function (i.e., kwargs).</p></li>
<li><p><strong>parameters</strong> -- allowed parameters for the function</p></li>
<li><p><strong>forcekey</strong> -- (optional, default = False) if True, raises a Value Error if an incorrect parameter is passed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="spectral-manipulation">
<h3>Spectral Manipulation<a class="headerlink" href="#spectral-manipulation" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="id4">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">toFluxUnit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_unit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id4" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts flux and noise arrays to given flux units.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectrum object is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;somespectrum&#39;</span><span class="p">,</span><span class="n">wave_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Angstrom</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> erg / (cm2 micron s)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toFluxUnit</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Watt</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> W / m2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toFluxUnit</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">erg</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Warning! failed to convert flux unit from W / m2 to erg / s; no change made</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id5">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">toWaveUnit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_unit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id5" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts wavelength to specified units.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectrum object is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;somespectrum&#39;</span><span class="p">,</span><span class="n">wave_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Angstrom</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
<span class="go">  Angstrom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toWaveUnit</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">micron</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
<span class="go">  micron</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toWaveUnit</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
<span class="go">  Warning! failed to convert wavelength unit from micron to s; no change made</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id6">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">toFnu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id6" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts flux density F_nu in units of Jy.
There is no change if the spectrum is already in F_nu units.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectrum object is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toFnu</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;Jy&quot;)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id7">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">toFlam</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id7" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts flux density to F_lambda in units of erg/s/cm^2/Hz.
There is no change if the spectrum is already in F_lambda units.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectrum object is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toFnu</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;Jy&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toFlam</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;erg / (cm2 micron s)&quot;)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id8">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">toSED</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id8" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts flux density in F_lambda to lambda x F_lambda with units of erg/s/cm^2.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectrum object is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">toSED</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="go"> Unit(&quot;erg / (cm2 s)&quot;)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id9">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">toSurface</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id9" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Convert to surface fluxes given a radius, assuming at absolute fluxes</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>UNTESTED, NEED TO ADD IN UNCERTAINTIES</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id10">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">toBrightnessTemperature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limbdarkening</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limbdarkeningcoeff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id10" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Convert to surface fluxes given a radius, assuming at absolute fluxes</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.Spectrum.toTemperature">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">toTemperature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum.toTemperature" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id11">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">toWavelengths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id11" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Maps a spectrum onto a new wavelength grid via interpolation or integral resampling</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param wave<span class="colon">:</span></dt>
<dd class="field-odd"><p>wavelengths to map to</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param force = True<span class="colon">:</span></dt>
<dd class="field-odd"><p>proceed with conversion even if wavelength ranges are not perfectly in range</p>
</dd>
<dt class="field-even">param verbose = False<span class="colon">:</span></dt>
<dd class="field-even"><p>provide verbose feedback</p>
</dd>
</dl>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectrum object is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p>TBD</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id12">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">toInstrument</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id12" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts a spectrum to the parameters for a defined instrument</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param instrument<span class="colon">:</span></dt>
<dd class="field-odd"><p>the name of an instrument, must be defined in splat.INSTRUMENTS</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectrum object is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p>TBD</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id13">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">redden</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">av</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.33</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id13" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Redden a spectrum based on an either Mie theory or a standard interstellar profile
using Cardelli, Clayton, and Mathis (1989 ApJ. 345, 245)</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param av<span class="colon">:</span></dt>
<dd class="field-odd"><p>Magnitude of reddening A_V (default = 0.)</p>
</dd>
<dt class="field-even">param rv<span class="colon">:</span></dt>
<dd class="field-even"><p>Normalized extinction parameter, R_V = A(V)/E(B-V) (default = 3.1</p>
</dd>
<dt class="field-odd">param normalized<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to True to normalize reddening function (default = False)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; spectral flux is changed</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="mi">10001</span><span class="p">)</span>                   <span class="c1"># read in a source</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spr</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">redden</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">av</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span><span class="n">rv</span><span class="o">=</span><span class="mf">3.2</span><span class="p">)</span>          <span class="c1"># redden to equivalent of AV=5</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="simple">
<dt><strong>Note</strong></dt><dd><p>This routine is still in beta form; only the CCM89 currently works</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id14">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id14" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Normalize a spectrum to a maximum value of 1 (in its current units) either at a
particular wavelength or over a wavelength range</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param wave_range<span class="colon">:</span></dt>
<dd class="field-odd"><p>choose the wavelength range to normalize; can be a list specifying minimum and maximum or a single wavelength (default = None); alternate keywords: <cite>wave_range</cite>, <cite>range</cite></p>
</dd>
</dl>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>None; spectrum is normalized</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">waverange</span><span class="o">=</span><span class="p">[</span><span class="mf">2.25</span><span class="p">,</span><span class="mf">2.3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.591310977935791 erg / (cm2 micron s)&gt;</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id15">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">scale</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noiseonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id15" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scales a Spectrum object's flux and noise values by a constant factor.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param factor<span class="colon">:</span></dt>
<dd class="field-odd"><p>A floating point number used to scale the Spectrum object</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param noiseonly = False<span class="colon">:</span></dt>
<dd class="field-odd"><p>scale only the noise and variance, useful when uncertainty is under/over estimated</p>
</dd>
</dl>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>None; spectrum is scaled</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336634332284e-14 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.5198</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">1.e15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336549758911 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.51981</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id16">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">fluxCalibrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id16" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Flux calibrates a spectrum given a filter and a magnitude. The filter must be one of those listed in <cite>splat.FILTERS.keys()</cite>. It is possible to specifically set the magnitude to be absolute (by default it is apparent).  This function changes the Spectrum object's flux, noise and variance arrays.</p>
</dd>
</dl>
<p>Required Inputs:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filt</strong> -- string specifiying the name of the filter</p></li>
<li><p><strong>mag</strong> -- number specifying the magnitude to scale to</p></li>
</ul>
</dd>
</dl>
<p>Optional Inputs:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>absolute</strong> -- set to True to specify that the given magnitude is an absolute magnitude, which sets the <code class="docutils literal notranslate"><span class="pre">flux_label</span></code> keyword in the Spectrum object to 'Absolute Flux' (default = False)</p></li>
<li><p><strong>apparent</strong> -- set to True to specify that the given magnitude is an apparent magnitude, which sets the <code class="docutils literal notranslate"><span class="pre">flux_label</span></code> flag in the Spectrum object to 'Apparent Flux' (default = False)</p></li>
</ul>
</dd>
</dl>
<p>Outputs:</p>
<p>None, Spectrum object is changed to a flux calibrated spectrum</p>
<dl class="field-list">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxCalibrate</span><span class="p">(</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">,</span><span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">filterMag</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">)</span>
<span class="go"> (15.002545668628173, 0.017635234089677564)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id17">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slitwidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id17" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Smoothes a spectrum either by selecting a constant slit width
(smooth in spectral dispersion space), pixel width (smooth in pixel space)
or resolution (smooth in velocity space). One of these options must be selected
for any smoothing to happen. Changes spectrum directly.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param method<span class="colon">:</span></dt>
<dd class="field-odd"><p>the type of smoothing window to use; see <a class="reference external" href="http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.signal.get_window.html">http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.signal.get_window.html</a> for more details (default = 'hamming')</p>
</dd>
<dt class="field-even">param resolution<span class="colon">:</span></dt>
<dd class="field-even"><p>Constant resolution to smooth to; see <a class="reference external" href="api.html#splat.core.Spectrum._smoothToResolution">_smoothToResolution()</a> (default = None)</p>
</dd>
<dt class="field-odd">param slitPixelWidth<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of pixels to smooth in pixel space; see <a class="reference external" href="api.html#splat.core.Spectrum._smoothToSlitPixelWidth">_smoothToSlitPixelWidth()</a> (default = None)</p>
</dd>
<dt class="field-even">param slitWidth<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of pixels to smooth in angular space; see <a class="reference external" href="api.html#splat.core.Spectrum._smoothToPixelWidth">_smoothToPixelWidth()</a> (default = None)</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>None: spectrum is smoothed</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">smooth</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.Spectrum._smoothToResolution">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">_smoothToResolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oversample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hamming'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum._smoothToResolution" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Smoothes a spectrum to a constant or resolution (smooth in velocity space).
Note that no smoothing is done if requested resolution is greater than the current resolution</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param res<span class="colon">:</span></dt>
<dd class="field-odd"><p>desired resolution (lambda/delta_lambde)</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param overscale<span class="colon">:</span></dt>
<dd class="field-odd"><p>number of samples in the smoothing window (default = 10)</p>
</dd>
</dl>
<p>see other optional keywords in <span class="target" id="spectrum-smooth">Spectrum.smooth()</span></p>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd">Outputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None; spectrum is smoothed</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">resolution</span><span class="p">()</span>
<span class="go">120</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">21.550974</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">smoothToResolution</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">resolution</span><span class="p">()</span>
<span class="go">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">49.459522314460855</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.Spectrum._smoothToSlitWidth">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">_smoothToSlitWidth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum._smoothToSlitWidth" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Smoothes a spectrum to a constant slit angular width (smooth in dispersion space).
Note that no smoothing is done if requested width is greater than the current slit width.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param width<span class="colon">:</span></dt>
<dd class="field-odd"><p>smoothing scale in arcseconds</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>see other optional keywords in <span class="target" id="id22">Spectrum.smooth()</span></p>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd">Outputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None; spectrum is smoothed</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">slitwidth</span>
<span class="go">0.4995</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">resolution</span>
<span class="go">120</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">105.41789</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">smoothToSlitWidth</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">slitwidth</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">resolution</span>
<span class="go">29.97</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">258.87135134070593</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.Spectrum._smoothToSlitPixelWidth">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">_smoothToSlitPixelWidth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.Spectrum._smoothToSlitPixelWidth" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Smoothes a spectrum to a constant slit pixel width (smooth in pixel space). C
Note that no smoothing is done if requested width is greater than the current slit width.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param width<span class="colon">:</span></dt>
<dd class="field-odd"><p>smoothing scale in pixels</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>see other optional keywords in <span class="target" id="id24">Spectrum.smooth()</span></p>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd">Outputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None; spectrum is smoothed</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">slitpixelwidth</span>
<span class="go">3.33</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">resolution</span>
<span class="go">120</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">105.41789</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">smoothToSlitPixelWidth</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">slitpixelwidth</span>
<span class="go">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">resolution</span>
<span class="go">39.96</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">235.77536310249229</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id26">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">maskFlux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id26" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mask = []</strong><span class="classifier">list or numpy.ndarray [optional]</span></dt><dd><p>array with same length as Spectrum object wavelength array that specifies pixels to be masked
array values can be floating point, int, or bool, with 1 = True (mask) and 0 = False (don't mask)</p>
</dd>
<dt><strong>replace_noise = True</strong><span class="classifier">bool [optional]</span></dt><dd><p>If True, apply the mask to the uncertainty array</p>
</dd>
<dt><strong>replace_value = numpy.nan</strong><span class="classifier">float [optional]</span></dt><dd><p>Value with which to replace masked elements of flux</p>
</dd>
<dt><strong>others = []]</strong><span class="classifier">list [optional]</span></dt><dd><p>Other elements of the Spectrum object to apply mask (e.g., wave, flags, mask, etc.)
These elements should be present and must be the same length as mask</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id27">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">remove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id27" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Removes elements of wave, flux, noise specified by the True/False array</p>
</dd>
<dt class="field-even">Required Input<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param mask<span class="colon">:</span></dt>
<dd class="field-odd"><p>Either a mask array (an array of booleans, ints, or floats, where True or 1 removes the element)
or a 2-element array that defines the wavelegnth range to mask</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Input<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param others<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of other attributes that mask should be applied to(e.g., 'pixel') (default = [])</p>
</dd>
</dl>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>Spectrum object has the flagged pixels removed from  wave, flux, noise arrays, and optional vectors</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span><span class="o">,</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">numberList</span><span class="p">(</span><span class="s1">&#39;1-10,18,30-50&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="p">[</span><span class="ow">not</span><span class="p">(</span><span class="n">p</span> <span class="ow">in</span> <span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="p">))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">showHistory</span><span class="p">()</span>
<span class="go">     SPEX_PRISM spectrum successfully loaded</span>
<span class="go">     Mask applied to remove 32 pixels</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id28">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">trim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id28" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Trims a spectrum to be within a certain wavelength range or set of ranges.
Data outside of these ranges are excised from the wave, flux and noise arrays.
The full spectrum can be restored with the reset() procedure.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param range<span class="colon">:</span></dt>
<dd class="field-odd"><p>the range(s) over which the spectrum is retained - a series of nested 2-element arrays</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">smoothfluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336634332284e-14 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.5198</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">1.e15</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxMax</span><span class="p">()</span>
<span class="go">&lt;Quantity 1.0577336549758911 erg / (cm2 micron s)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">124.51981</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.stitch">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">stitch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.stitch" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Stitches together two spectra covering different wavelength scales.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param s1<span class="colon">:</span></dt>
<dd class="field-odd"><p>first spectrum object</p>
</dd>
<dt class="field-even">param s2<span class="colon">:</span></dt>
<dd class="field-even"><p>second spectrum object (not necessarily in order)</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param rng<span class="colon">:</span></dt>
<dd class="field-odd"><p>range over which spectra are relatively scaled and combined (if desired); if neither spectrum cover this range, then no relative scaling is done and spectra are combined whereever they overlap (default: [])</p>
</dd>
<dt class="field-even">param scale<span class="colon">:</span></dt>
<dd class="field-even"><p>set to True to relatively scale spectra over rng; if rng is not provided, or spectra to not overlap, this is automatially False (default: True)</p>
</dd>
<dt class="field-odd">param wave_unit<span class="colon">:</span></dt>
<dd class="field-odd"><p>wavelength unit of final spectrum (default: wavelength unit of s1)</p>
</dd>
<dt class="field-even">param flux_unit<span class="colon">:</span></dt>
<dd class="field-even"><p>flux unit of final spectrum (default: flux unit of s1)</p>
</dd>
<dt class="field-odd">param verbose<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to provide feedback (default: False)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>New spectrum object of stitched spectrum</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spopt</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;myopticalspectrum.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spnir</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;myopticalspectrum.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">stitch</span><span class="p">(</span><span class="n">spopt</span><span class="p">,</span><span class="n">spnir</span><span class="p">,</span><span class="n">rng</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.9</span><span class="p">],</span><span class="n">trim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.35</span><span class="p">,</span><span class="mf">2.4</span><span class="p">])</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id29">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">addNoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id29" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Adds noise to a spectrum based on either the current uncertainties scaled by optional input S/N</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>snr</em>: Signal-to-noise ratio to use to scale uncertainty spectrum (default = 0. =&gt; use existing S/N)</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>None (spectrum object changed in place)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="mi">10001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">addNoise</span><span class="p">(</span><span class="n">snr</span><span class="o">=</span><span class="mf">10.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">computeSN</span><span class="p">()</span>
<span class="go">     9.5702358777108234</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</section>
<section id="spectral-classification-and-characterization">
<h3>Spectral Classification and Characterization<a class="headerlink" href="#spectral-classification-and-characterization" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="splat.core.compareSpectra">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">compareSpectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statistic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'chisqr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">novar2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.compareSpectra" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Compare two spectra against each other using a pre-selected statistic.
Returns the value of the desired statistic as well as the optimal scale factor.</p>
</dd>
<dt class="field-even">Required Parameters<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param sp1<span class="colon">:</span></dt>
<dd class="field-odd"><p>First spectrum class object, which sets the wavelength scale</p>
</dd>
<dt class="field-even">param sp2<span class="colon">:</span></dt>
<dd class="field-even"><p>Second spectrum class object, interpolated onto the wavelength scale of sp1</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>statistic = 'chisqr': string defining which statistic to use in comparison; available options are (also stat):</p>
<ul class="simple">
<li><p><em>'chisqr'</em> or <em>'chi'</em>: compare by computing chi squared value (requires spectra with noise values)</p></li>
<li><p><em>'stddev'</em>: compare by computing standard deviation</p></li>
<li><p><em>'stddev_norm'</em>: compare by computing normalized standard deviation</p></li>
<li><p><em>'absdev'</em>: compare by computing absolute deviation</p></li>
</ul>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>scale = True: If True, finds the best scale factor to minimize the statistic</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>fit_ranges = [range of first spectrum]: 2-element array or nested array of 2-element arrays specifying the wavelength ranges to be used for the fit, assumed to be measured in microns; this is effectively the opposite of mask_ranges (also fit_range, fitrange, fitrng, comprange, comprng)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>mask = numpy.zeros(): Array specifiying which wavelengths to mask; must be an array with length equal to the wavelength scale of <code class="docutils literal notranslate"><span class="pre">sp1</span></code> with only 0 (OK) or 1 (mask).</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>mask_ranges = None: Multi-vector array setting wavelength boundaries for masking data, assumed to be in microns</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>mask_telluric = False: Set to True to mask pre-defined telluric absorption regions</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>mask_standard = False: Like <code class="docutils literal notranslate"><span class="pre">mask_telluric</span></code>, with a slightly tighter cut of 0.80-2.35 micron</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>weights = numpy.ones(): Array specifying the weights for individual wavelengths; must be an array with length equal to the wavelength scale of <code class="docutils literal notranslate"><span class="pre">sp1</span></code>; need not be normalized</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>novar2 = True: Set to True to compute statistic without considering variance of <code class="docutils literal notranslate"><span class="pre">sp2</span></code></p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>plot = False: Set to True to plot <code class="docutils literal notranslate"><span class="pre">sp1</span></code> with scaled <code class="docutils literal notranslate"><span class="pre">sp2</span></code> and difference spectrum overlaid</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>verbose = False: Set to True to report things as you're going along</p>
</dd>
</dl>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>statistic and optimal scale factor for the comparison</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp1</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span> <span class="o">=</span> <span class="s1">&#39;2346-3153&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">    Retrieving 1 file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp2</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span> <span class="o">=</span> <span class="s1">&#39;1421+1827&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">    Retrieving 1 file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp1</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp2</span><span class="o">.</span><span class="n">normalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">compareSpectra</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;chisqr&#39;</span><span class="p">)</span>
<span class="go">    (&lt;Quantity 19927.74527822856&gt;, 0.94360732593223595)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">compareSpectra</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;stddev&#39;</span><span class="p">)</span>
<span class="go">    (&lt;Quantity 3.0237604611215705 erg2 / (cm4 micron2 s2)&gt;, 0.98180983971456637)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">compareSpectra</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;absdev&#39;</span><span class="p">)</span>
<span class="go">    (&lt;Quantity 32.99816249949072 erg / (cm2 micron s)&gt;, 0.98155779612333172)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">compareSpectra</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;chisqr&#39;</span><span class="p">,</span> <span class="n">novar2</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">    (&lt;Quantity 17071.690727945213&gt;, 0.94029474635786015)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.measureIndex">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">measureIndex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ratio'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'integrate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noiseFlag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">pkwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.measureIndex" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Measure an index on a spectrum based on defined methodology
measure method can be mean, median, integrate
index method can be ratio = 1/2, valley = 1-2/3, OTHERS
output is index value and uncertainty</p>
</dd>
</dl>
</div></blockquote>
<p># NOTE: NOISE FLAG ERROR IS BACKWARDS HERE</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.measureIndexSet">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">measureIndexSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'burgasser'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_keyword</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'indices'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range_keyword</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ranges'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_keyword</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'method'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_keyword</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sample'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.measureIndexSet" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Measures indices of <code class="docutils literal notranslate"><span class="pre">sp</span></code> from specified sets. Returns dictionary of indices.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><dl class="field-list simple">
<dt class="field-odd">param sp<span class="colon">:</span></dt>
<dd class="field-odd"><p>Spectrum class object, which should contain wave, flux and noise array elements</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><ul>
<li><dl class="field-list simple">
<dt class="field-odd">param ref='burgasser'<span class="colon">:</span></dt>
<dd class="field-odd"><p>string identifying the index set you want to measure, as contained in the variable splat.INDEX_SETS</p>
</dd>
</dl>
</li>
<li><dl class="field-list">
<dt class="field-odd">param index_info={}<span class="colon">:</span></dt>
<dd class="field-odd"><p>a dictionary defining the index set to measure; this dictionary should contain within it:</p>
<ul class="simple">
<li><p>'indices': points to a dictionary containing the index definitions, each of which are also a dictionary containing the</p></li>
</ul>
<p>keywords 'range' (the wavelength range),'sample' (spectrum sampling), and 'method'(index calculation method)
* alternately, a set of individual dictionaries containing 'range','sample', and 'method' keywords
* 'bibcode': optional bibcode citation, if 'indices' keyword is present</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param info=False<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to give the list of avaialble index sets in SPLAT</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param indices_keyword='indices'<span class="colon">:</span></dt>
<dd class="field-odd"><p>alternate keyword name convection for indices</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param range_keyword='ranges'<span class="colon">:</span></dt>
<dd class="field-odd"><p>alternate keyword name convection for index wavelength ranges</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param method_keyword='method'<span class="colon">:</span></dt>
<dd class="field-odd"><p>alternate keyword name convection for spectral sampling</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param sample_keyword='sample'<span class="colon">:</span></dt>
<dd class="field-odd"><p>alternate keyword name convection for index measurement method</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param verbose=False<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to give extra feedback</p>
</dd>
</dl>
</li>
</ul>
<p>Additional keyword options for measureIndex()_ can also be supplied</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the names of each index pointed to tuple of (measurement,uncertainty)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1555+0954&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">measureIndexSet</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">ref</span> <span class="o">=</span> <span class="s1">&#39;reid&#39;</span><span class="p">)</span>
<span class="go">     {&#39;H2O-A&#39;: (0.896763035762751, 0.0009482437569842745),</span>
<span class="go">     &#39;H2O-B&#39;: (1.0534404728276665, 0.001329359465953495)}</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.plot.visualizeIndices">
<span class="sig-prename descclassname"><span class="pre">splat.plot.</span></span><span class="sig-name descname"><span class="pre">visualizeIndices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.plot.visualizeIndices" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">Plot</span> <span class="pre">index-index</span> <span class="pre">plots.</span></code></p>
</dd>
</dl>
<p>indices should be a dictionary of {'index_name': {'ranges': [[],[]], 'value': #, 'unc': #}, ...}
Not currently implemented</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.measureEW">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">measureEW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.0,</span> <span class="pre">0.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuum_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Unit('Angstrom')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recenter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">absorption</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuum_fit_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.measureEW" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.measureEWElement">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">measureEWElement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.0,</span> <span class="pre">0.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">getNist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.measureEWElement" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.measureEWSet">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">measureEWSet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rojas'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.measureEWSet" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Measures equivalent widths (EWs) of lines from specified sets. Returns dictionary of indices.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sp</strong> -- Spectrum class object, which should contain wave, flux and noise array elements</p></li>
<li><p><strong>set</strong> (<em>optional</em><em>, </em><em>default = 'rojas'</em>) -- <p>string defining which EW measurement set you want to use; options include:</p>
<ul>
<li><p><em>rojas</em>: EW measures from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...748...93R">Rojas-Ayala et al. (2012)</a>;
uses Na I 2.206/2.209 Ca I 2.26 micron lines.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1555+0954&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">measureEWSet</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="nb">set</span> <span class="o">=</span> <span class="s1">&#39;rojas&#39;</span><span class="p">)</span>
<span class="go">    {&#39;Na I 2.206/2.209&#39;: (1.7484002652013144, 0.23332441577025356), &#39;Ca I 2.26&#39;: (1.3742491939667159, 0.24867705962337672), &#39;names&#39;: [&#39;Na I 2.206/2.209&#39;, &#39;Ca I 2.26&#39;], &#39;reference&#39;: &#39;EW measures from Rojas-Ayala et al. (2012)&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.classifyByIndex">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">classifyByIndex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'burgasser'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">string_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">round_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remeasure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nloop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allmeasures</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.classifyByIndex" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Determine the spectral type and uncertainty for a spectrum based on indices. Makes use of published index-SpT relations from <a class="reference external" href="http://adsabs.harvard.edu/abs/2001AJ....121.1710R">Reid et al. (2001)</a>; <a class="reference external" href="http://adsabs.harvard.edu/abs/2001ApJ...552L.147T">Testi et al. (2001)</a>; <a class="reference external" href="http://adsabs.harvard.edu/abs/2007ApJ...657..511A">Allers et al. (2007)</a>; and <a class="reference external" href="http://adsabs.harvard.edu/abs/2007ApJ...659..655B">Burgasser (2007)</a>. Returns 2-element tuple containing spectral type (numeric or string) and uncertainty.</p>
<p>Required Inputs:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sp</strong> -- Spectrum class object, which should contain wave, flux and noise array elements.</p>
</dd>
</dl>
<p>Optional Inputs:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>set</strong> -- <p>named set of indices to measure and compute spectral type</p>
<ul>
<li><p><em>'burgasser'</em>: H2O-J, CH4-J, H2O-H, CH4-H, CH4-K from <a class="reference external" href="http://adsabs.harvard.edu/abs/2007ApJ...659..655B">Burgasser (2007)</a>, applicable for types  (default)</p></li>
<li><p><em>'allers'</em>: H2O from <a class="reference external" href="http://adsabs.harvard.edu/abs/2007ApJ...657..511A">Allers et al. (2007)</a></p></li>
<li><p><em>'reid'</em>:H2O-A and H2O-B from <a class="reference external" href="http://adsabs.harvard.edu/abs/2001AJ....121.1710R">Reid et al. (2001)</a></p></li>
<li><p><em>'testi'</em>: sHJ, sKJ, sH2O_J, sH2O_H1, sH2O_H2, sH2O_K from <a class="reference external" href="http://adsabs.harvard.edu/abs/2001ApJ...552L.147T">Testi et al. (2001)</a></p></li>
</ul>
</p></li>
<li><p><strong>string</strong> -- return spectral type as a string using typeToNum (default = False)</p></li>
<li><p><strong>round</strong> -- rounds off to nearest 0.5 subtypes (default = False)</p></li>
<li><p><strong>allmeasures</strong> -- Set to True to return all of the index values and individual subtypes  (default = False)</p></li>
<li><p><strong>remeasure</strong> -- force remeasurement of indices (default = True)</p></li>
<li><p><strong>nsamples</strong> -- number of Monte Carlo samples for error computation (default = 100)</p></li>
<li><p><strong>nloop</strong> -- number of testing loops to see if spectral type is within a certain range (default = 5)</p></li>
</ul>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spc</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;0559-1404&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">classifyByIndex</span><span class="p">(</span><span class="n">spc</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">set</span><span class="o">=</span><span class="s1">&#39;burgasser&#39;</span><span class="p">,</span> <span class="nb">round</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    (&#39;T4.5&#39;, 0.2562934083414341)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.classifyByStandard">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">classifyByStandard</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dwarf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.classifyByStandard" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Determine the spectral type and uncertainty for a
spectrum by direct comparison to defined spectral standards.
Dwarf standards span M0-T9 and include the standards listed in
<a class="reference external" href="http://adsabs.harvard.edu/abs/2006ApJ...637.1067B">Burgasser et al. (2006)</a>, <a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJS..190..100K">Kirkpatrick et al. (2010)</a> and <a class="reference external" href="http://adsabs.harvard.edu/abs/2011ApJ...743...50C">Cushing et al. (2011)</a>.
Comparison to subdwarf and extreme subdwarf standards may also be done.
Returns the best match or an F-test weighted mean and uncertainty. There is an option
to follow the procedure of <a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJS..190..100K">Kirkpatrick et al. (2010)</a>, fitting only in
the 0.9-1.4 micron region.</p>
</dd>
<dt class="field-even">Required Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><dl class="field-list simple">
<dt class="field-odd">param sp<span class="colon">:</span></dt>
<dd class="field-odd"><p>Spectrum class object, which should contain wave, flux and noise array elements (required)</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt class="field-odd">Optional Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><dl class="field-list simple">
<dt class="field-odd">param sptrange<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to the spectral type range over which comparisons should be made, can be a two-element array of strings or numbers (optional, default = ['M0','T9'])</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param statistic<span class="colon">:</span></dt>
<dd class="field-odd"><p>string defining which statistic to use in comparison; available options are:</p>
<ul>
<li><p><em>'chisqr'</em>: (DEFAULT) compare by computing chi squared value (requires spectra with noise values)</p></li>
<li><p><em>'stddev'</em>: compare by computing standard deviation</p></li>
<li><p><em>'stddev_norm'</em>: compare by computing normalized standard deviation</p></li>
<li><p><em>'absdev'</em>: compare by computing absolute deviation</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param std_class<span class="colon">:</span></dt>
<dd class="field-odd"><p>the type of standard to compare to; allowed options are 'dwarf' (default), 'subdwarf', 'sd', 'dsd', 'esd', 'lowg', 'vlg', and 'intg'. These can also be set using the following keywords</p>
<ul>
<li><dl class="field-list simple">
<dt class="field-odd">param dwarf<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to compare to dwarf standards</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param sd<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to compare to subdwarf standards (<cite>subdwarf</cite> does the same)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param dsd<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to compare to dwarf/subdwarf standards</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param esd<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to compare to extreme subdwarf standards</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param vlg<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to compare to very low gravity standards (<cite>lowg</cite> does the same)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param intg<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to compare to intermediate gravity standards</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param all<span class="colon">:</span></dt>
<dd class="field-odd"><p>compare to standards across all metallicity and gravity types</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param method<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to <code class="docutils literal notranslate"><span class="pre">'kirkpatrick'</span></code> to follow the <a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJS..190..100K">Kirkpatrick et al. (2010)</a> method, fitting only to the 0.9-1.4 micron band (optional, default = '')</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param best<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to return the best fit standard type (optional, default = True)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param average<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to return an chi-square weighted type only (optional, default = False)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param compareto<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to the single standard (string or number) you want to compare to (optional, default = None)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param plot<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to generate a plot comparing best fit template to source; can also set keywords associated with <a href="#id146"><span class="problematic" id="id147">plotSpectrum_</span></a> routine (optional, default = False)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param string<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to return spectral type as a string (optional, default = True)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param return_standard<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to return a Spectrum class of the standard properly scaled (optional, default = False)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param return_statistic<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to return a best match spectral type and statistic (instead of uncertainty) (optional, default = False)</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param verbose<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to give extra feedback (optional, default = False)</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p>Users can also set keyword parameters defined in <a href="#id148"><span class="problematic" id="id149">plotSpectrum_</span></a> and <a class="reference external" href="api.html#splat.core.compareSpectra">compareSpectra</a> routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple listing the best match standard and uncertainty based on F-test weighting and systematic uncertainty of 0.5 subtypes</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">classifyByStandard</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    Using dwarf standards</span>
<span class="go">    Type M3.0: statistic = 5763368.10355, scale = 0.000144521824721</span>
<span class="go">    Type M2.0: statistic = 5613862.67356, scale = 0.000406992798674</span>
<span class="go">    Type T8.0: statistic = 18949835.2087, scale = 9.70960919364</span>
<span class="go">    Type T9.0: statistic = 21591485.163, scale = 29.1529786804</span>
<span class="go">    Type L8.0: statistic = 3115605.62687, scale = 1.36392504072</span>
<span class="go">    Type L9.0: statistic = 2413450.79206, scale = 0.821131769522</span>
<span class="go">    ...</span>
<span class="go">    Best match to L1.0 spectral standard</span>
<span class="go">    Best spectral type = L1.0+/-0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>
<span class="go">    (&#39;L1.0&#39;, 0.5)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">classifyByStandard</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">sd</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">average</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    (&#39;sdL0.0:&#39;, 1.8630159149200021)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.classifyByTemplate">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">classifyByTemplate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">templates</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'best'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxtemplates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.classifyByTemplate" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sp</strong><span class="classifier">Spectrum class</span></dt><dd><p>spectrum to copmare to templates</p>
</dd>
<dt><strong>templates</strong><span class="classifier">dict</span></dt><dd><p>dictionary of spectrum objects, where each key corresponds to the template identifier (e.g., spectral type)
and points to a Spectrum class object of the template</p>
</dd>
<dt><strong>output = 'best'</strong><span class="classifier">str [optional]</span></dt><dd><p>signifies what should be returned by call to classifyByTemplate()</p>
</dd>
<dt><strong>nbest = 1</strong><span class="classifier">int [optional]</span></dt><dd><p>indicate what number of best-fit templates to return, in order of lowest fit statistic</p>
</dd>
<dt><strong>maxtemplates = 100</strong><span class="classifier">int [optional]</span></dt><dd><p>maximum number of templates to compare to if time is an issue; -1 is unlimited</p>
</dd>
<dt><strong>plot = False</strong><span class="classifier">bool [optional]</span></dt><dd><p>plot comparison between source and best-fit template</p>
</dd>
<dt><strong>verbose = False</strong><span class="classifier">bool [optional]</span></dt><dd><p>return verbose feedback during execution</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.classifyGravity">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">classifyGravity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'classification'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.classifyGravity" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Determine the gravity classification of a brown dwarf using the method of <a class="reference external" href="http://adsabs.harvard.edu/abs/2013ApJ...772...79A">Allers &amp; Liu (2013)</a>.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sp</strong> (<em>required</em>) -- Spectrum class object, which should contain wave, flux and
noise array elements. Must be between M6.0 and L7.0.</p></li>
<li><p><strong>spt</strong> (<em>optional</em><em>, </em><em>default = False</em>) -- spectral type of <code class="docutils literal notranslate"><span class="pre">sp</span></code>. Must be between M6.0 and L7.0</p></li>
<li><p><strong>indices</strong> (<em>optional</em><em>, </em><em>default = 'allers'</em>) -- specify indices set using <code class="docutils literal notranslate"><span class="pre">measureIndexSet</span></code>.</p></li>
<li><p><strong>plot</strong> (<em>optional</em><em>, </em><em>default = False</em>) -- Set to True to plot sources against closest dwarf spectral standard</p></li>
<li><p><strong>allscores</strong> (<em>optional</em><em>, </em><em>default = False</em>) -- Set to True to return a dictionary containing the gravity scores from individual indices</p></li>
<li><p><strong>verbose</strong> (<em>optional</em><em>, </em><em>default = False</em>) -- Give feedback while computing</p></li>
</ul>
</dd>
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>Either a string specifying the gravity classification or a dictionary specifying the gravity scores for each index</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1507-1627&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">classifyGravity</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="go">    FLD-G</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">classifyGravity</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">allscores</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    Gravity Classification:</span>
<span class="go">        SpT = L4.0</span>
<span class="go">        VO-z: 1.012+/-0.029 =&gt; 0.0</span>
<span class="go">        FeH-z: 1.299+/-0.031 =&gt; 1.0</span>
<span class="go">        H-cont: 0.859+/-0.032 =&gt; 0.0</span>
<span class="go">        KI-J: 1.114+/-0.038 =&gt; 1.0</span>
<span class="go">        Gravity Class = FLD-G</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>
<span class="go">    {&#39;FeH-z&#39;: 1.0,</span>
<span class="go">     &#39;H-cont&#39;: 0.0,</span>
<span class="go">     &#39;KI-J&#39;: 1.0,</span>
<span class="go">     &#39;VO-z&#39;: 0.0,</span>
<span class="go">     &#39;gravity_class&#39;: &#39;FLD-G&#39;,</span>
<span class="go">     &#39;score&#39;: 0.5,</span>
<span class="go">     &#39;spt&#39;: &#39;L4.0&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.empirical.redden">
<span class="sig-prename descclassname"><span class="pre">splat.empirical.</span></span><span class="sig-name descname"><span class="pre">redden</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sp</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.empirical.redden" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Description:</dt><dd><p>Redden a spectrum based on an either Mie theory or a standard interstellar profile
using Cardelli, Clayton, and Mathis (1989 ApJ. 345, 245)</p>
</dd>
</dl>
<p><strong>Usage</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="mi">10001</span><span class="p">)</span>                   <span class="c1"># read in a source</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spr</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">redden</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">av</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span><span class="n">rv</span><span class="o">=</span><span class="mf">3.2</span><span class="p">)</span>          <span class="c1"># redden to equivalent of AV=5</span>
</pre></div>
</div>
<dl class="simple">
<dt><strong>Note</strong></dt><dd><p>This routine is still in beta form; only the CCM89 currently works</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.core.generateMask">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">generateMask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-99.0,</span> <span class="pre">-99.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_telluric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_standard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.core.generateMask" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Generates a mask array based on wavelength vector and optional inputs on what to mask.</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>A mask array, where 0 = OK and 1 = ignore</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>

</section>
<section id="spectrophotometry">
<h3>Spectrophotometry<a class="headerlink" href="#spectrophotometry" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="splat.photometry.checkFilter">
<span class="sig-prename descclassname"><span class="pre">splat.photometry.</span></span><span class="sig-name descname"><span class="pre">checkFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.photometry.checkFilter" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.photometry.filterInfo">
<span class="sig-prename descclassname"><span class="pre">splat.photometry.</span></span><span class="sig-name descname"><span class="pre">filterInfo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.photometry.filterInfo" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Prints out the current list of filters in the SPLAT reference library.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.photometry.filterMag">
<span class="sig-prename descclassname"><span class="pre">splat.photometry.</span></span><span class="sig-name descname"><span class="pre">filterMag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computevalue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vega'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">custom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">notch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vegafile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vega_kurucz.txt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filterfolder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/Users/adam/projects/splat/code/splat/splat/..//resources/Filters/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.photometry.filterMag" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>sp</strong><span class="classifier">Spectrum class object</span></dt><dd><p>Spectrum to compute spectrophotometry, which should contain wave, flux and noise array elements.</p>
</dd>
<dt><strong>filter</strong><span class="classifier">str</span></dt><dd><p>String giving name of filter, which can either be one of the predefined filters listed in splat.FILTERS.keys() or a custom filter name</p>
</dd>
<dt><strong>computevalue</strong><span class="classifier">str, default = 'vega'</span></dt><dd><p>Type of value to compute; must be one of vega, ab, energy, photons; can also be set with vega, ab, energy, and photons keywords</p>
</dd>
<dt><strong>custom</strong><span class="classifier">array, default = None</span></dt><dd><p>A 2 x N vector array specifying the wavelengths and transmissions for a custom filter</p>
</dd>
<dt><strong>notch</strong><span class="classifier">array, default = None:</span></dt><dd><p>A 2 element array that specifies the lower and upper wavelengths for a notch filter (100% transmission within, 0% transmission without)</p>
</dd>
<dt><strong>filterfolder</strong><span class="classifier">str, default = splat.FILTER_FOLDER</span></dt><dd><p>Optional filepath to folder containing the filter transmission files</p>
</dd>
<dt><strong>vegafile</strong><span class="classifier">str, default = 'vega_kurucz.txt'</span></dt><dd><p>Filename containing Vega flux file, either full path or assumed to be within <code class="docutils literal notranslate"><span class="pre">filterfolder</span></code></p>
</dd>
<dt><strong>nsamples</strong><span class="classifier">int, default = 100</span></dt><dd><p>Number of samples to use in Monte Carlo error estimation</p>
</dd>
<dt><strong>info</strong><span class="classifier">bool default = False:</span></dt><dd><p>Set to True to list the predefined filter names available</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool, default = False</span></dt><dd><p>Set to True to receive verbose feedback</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id37">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">filterMag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id37" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Wrapper for <a class="reference external" href="api.html#splat.photometry.filterMag">filterMag()</a> function in splat.photometry</p>
</dd>
</dl>
<p>Required Inputs:</p>
<blockquote>
<div><p><strong>filter</strong>: string specifiying the name of the filter</p>
</div></blockquote>
<p>Optional Inputs:</p>
<blockquote>
<div><p>See <a class="reference external" href="api.html#splat.photometry.filterMag">filterMag()</a></p>
</div></blockquote>
<p>Outputs:</p>
<blockquote>
<div><p>Returns tuple containing filter-based spectrophotometic magnitude and its uncertainty</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxCalibrate</span><span class="p">(</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">,</span><span class="mf">15.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">filterMag</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">)</span>
<span class="go"> (15.002545668628173, 0.017635234089677564)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.photometry.filterProfile">
<span class="sig-prename descclassname"><span class="pre">splat.photometry.</span></span><span class="sig-name descname"><span class="pre">filterProfile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filterfolder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/Users/adam/projects/splat/code/splat/splat/..//resources/Filters/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.photometry.filterProfile" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filter</strong><span class="classifier">str</span></dt><dd><p>String giving the name of one of the predefined filters listed in splat.FILTERS.keys()</p>
</dd>
<dt><strong>filterfolder</strong><span class="classifier">str, default = splat.FILTER_FOLDER</span></dt><dd><p>Optional filepath to folder containing the filter transmission files</p>
</dd>
<dt><strong>plot</strong><span class="classifier">bool, default = False</span></dt><dd><p>Set to True to plot the filter profile (using <cite>visualizeFilter()_</cite>)</p>
</dd>
<dt><strong>file</strong><span class="classifier">str, default = ''</span></dt><dd><p>Full filepath for plot output; if empty string, no plot created</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool, default = False</span></dt><dd><p>Set to True to receive verbose feedback</p>
</dd>
<dt><strong>additional plotting options contained in matplotlib.pyplot can be passed as well,</strong></dt><dd></dd>
<dt><strong>including color, label, xlim, ylim, xlabel, ylabel, figsize, normalize, and fill</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.photometry.magToFlux">
<span class="sig-prename descclassname"><span class="pre">splat.photometry.</span></span><span class="sig-name descname"><span class="pre">magToFlux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.photometry.magToFlux" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts a magnitude into an energy, and vice versa.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>mag</strong> -- magnitude on whatever system is defined for the filter or provided (required)</p></li>
<li><p><strong>filter</strong> -- name of filter, must be one of the specifed filters given by splat.FILTERS.keys() (required)</p></li>
<li><p><strong>reverse</strong> -- convert energy into magnitude instead (optional, default = False)</p></li>
<li><p><strong>ab</strong> -- magnitude is on the AB system (optional, default = filter preference)</p></li>
<li><p><strong>vega</strong> -- magnitude is on the Vega system (optional, default = filter preference)</p></li>
<li><p><strong>rsr</strong> -- magnitude is on the Vega system (optional, default = filter preference)</p></li>
<li><p><strong>units</strong> -- units for energy as an astropy.units variable; if this conversion does not work, the conversion is ignored (optional, default = erg/cm2/s)</p></li>
<li><p><strong>verbose</strong> -- print out information about filter to screen (optional, default = False)</p></li>
</ul>
</dd>
</dl>
<p>WARNING: THIS CODE IS ONLY PARTIALLY COMPLETE</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.photometry.visualizeFilter">
<span class="sig-prename descclassname"><span class="pre">splat.photometry.</span></span><span class="sig-name descname"><span class="pre">visualizeFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fprof</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectrum</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.photometry.visualizeFilter" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>fprof</strong><span class="classifier">str or list/array</span></dt><dd><p>Either of string or list of strings of predefined filter names listed in splat.FILTERS.keys()
or a list of numerical arrays: lists of pairs of numbers =&gt; notch filters; list of pairs of number arrays =&gt; wave,transmission profiles</p>
</dd>
<dt><strong>spectrum</strong><span class="classifier">Spectrum class object, default = None</span></dt><dd><p>Assign to a spectrum class object you want to overplot; spectrum should be normalized in advance</p>
</dd>
<dt><strong>file</strong><span class="classifier">str, default = ''</span></dt><dd><p>Full filepath for plot output; if empty string, no plot created</p>
</dd>
<dt><strong>color</strong><span class="classifier">str or list, default = 'k''</span></dt><dd><p>single or list of color labels</p>
</dd>
<dt><strong>linestyle</strong><span class="classifier">str or list, default = '-''</span></dt><dd><p>single or list of linestyles</p>
</dd>
<dt><strong>fill</strong><span class="classifier">bool, default = False</span></dt><dd><p>Set to True to fill in the filter profile region</p>
</dd>
<dt><strong>legend</strong><span class="classifier">bool, default = False</span></dt><dd><p>Set to True to include legend</p>
</dd>
<dt><strong>nsample</strong><span class="classifier">int, default = 100</span></dt><dd><p>Number of samples for a notch filter</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool, default = False</span></dt><dd><p>Set to True to receive verbose feedback</p>
</dd>
<dt><strong>additional plotting options contained in matplotlib.pyplot can be passed as well,</strong></dt><dd></dd>
<dt><strong>including figsize, xlim, ylim, xlabel, ylabel, wave_unit, normalize, spectrum_scale, spectrum_color, spectrum_alpha</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="high-resolution-spectroscopic-functions">
<h3>High-resolution Spectroscopic Functions<a class="headerlink" href="#high-resolution-spectroscopic-functions" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.baryVel">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">baryVel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obstime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'keck'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'barycenter'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.baryVel" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Computes the barycentric or heliocentric velocity in a direction and from a specific Earth location</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><dl class="field-list simple">
<dt class="field-odd">param coord<span class="colon">:</span></dt>
<dd class="field-odd"><p>Coordinate of source; should be astropy.coordinates.SkyCoord, but can also be converted from splat.propoCoordinates</p>
</dd>
</dl>
</li>
<li><dl class="field-list simple">
<dt class="field-odd">param obstime<span class="colon">:</span></dt>
<dd class="field-odd"><p>A date/time, preferred in astropy.time.Time format but can be converted from splat.properDate</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><dl class="field-list simple">
<dt class="field-odd">param location<span class="colon">:</span></dt>
<dd class="field-odd"><p>location on Earth, specified by astropy.coordinates.EarthLocation; string of location;</p>
</dd>
</dl>
</li>
</ul>
<p>dictionary containing 'ra', 'dec', and 'height'; or array of [ra,dec,height] (default = 'keck')
- :param correction: type of correction, can be either 'barycentric' or 'heliocentric' (default = 'heliocentric')</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>The velocity correction in km/s</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coord</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">properCoordinates</span><span class="p">(</span><span class="s1">&#39;J15104786-2818174&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">splat</span><span class="o">.</span><span class="n">baryVel</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span><span class="s1">&#39;2017-07-31&#39;</span><span class="p">,</span><span class="n">location</span><span class="o">=</span><span class="s1">&#39;keck&#39;</span><span class="p">)</span>
<span class="go">    -27.552554878923033 km / s</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.lsfRotation">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">lsfRotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vsini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vsamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.lsfRotation" title="Link to this definition">¶</a></dt>
<dd><p>Purpose:</p>
<blockquote>
<div><p>Generates a line spread function for rotational broadening, based on Gray (1992)
Ported over by Chris Theissen and Adam Burgasser from the IDL routine
<a class="reference external" href="https://idlastro.gsfc.nasa.gov/ftp/pro/astro/lsf_rotate.pro">lsf_rotate</a> writting by W. Landsman</p>
</div></blockquote>
<p>Required Inputs:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>vsini</strong>: vsini of rotation, assumed in units of km/s</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>vsamp</strong>: sampling velocity, assumed in unit of km/s. vsamp must be smaller than vsini or else a delta function is returned</p>
</dd>
</dl>
</div></blockquote>
<p>Optional Inputs:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>epsilon</strong>: limb darkening parameter based on Gray (1992)</p>
</dd>
</dl>
</div></blockquote>
<p>Output:</p>
<blockquote>
<div><p>Line spread function kernel with length 2*vsini/vsamp (forced to be odd)</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kern</span> <span class="o">=</span> <span class="n">lsfRotation</span><span class="p">(</span><span class="mf">30.</span><span class="p">,</span><span class="mf">3.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">kern</span><span class="p">)</span>
<span class="go">    array([ 0.        ,  0.29053574,  0.44558751,  0.55691445,  0.63343877,</span>
<span class="go">    0.67844111,  0.69330989,  0.67844111,  0.63343877,  0.55691445,</span>
<span class="go">    0.44558751,  0.29053574,  0.        ])</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id39">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">rvShift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id39" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Shifts the wavelength scale by a given radial velocity. This routine changes the underlying Spectrum object.</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">rvShift</span><span class="p">(</span><span class="mi">15</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id40">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">broaden</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbroad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kern</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rotation'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id40" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Broadens a spectrum in velocity space using a line spread function (LSF) either based on rotation or gaussian.
This routine changes the underlying Spectrum object.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param vbroad<span class="colon">:</span></dt>
<dd class="field-odd"><p>broadening width, nominally in km/s</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param method<span class="colon">:</span></dt>
<dd class="field-odd"><p>method of broadening, should be one of:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gaussian</span></code>: (default) Gaussian broadening, with vbroad equal to Gaussian sigma</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rotation</span></code>: rotational broadening using splat.lsfRotation()</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delta</span></code>: Delta function (no broadening)</p></li>
</ul>
</dd>
<dt class="field-even">param kern<span class="colon">:</span></dt>
<dd class="field-even"><p>input kernel, must be at least three elements wide (default = None)</p>
</dd>
<dt class="field-odd">param epsilon<span class="colon">:</span></dt>
<dd class="field-odd"><p>epsilon parameter for limb darkening in rotational broadening (default = 0.6)</p>
</dd>
<dt class="field-even">param verbose<span class="colon">:</span></dt>
<dd class="field-even"><p>provide extra feedback (default = False)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None; Spectral flux is smoothed using the desired line spread function. No change is made to noise or other axes</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="mi">10001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">broaden</span><span class="p">(</span><span class="mf">30.</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;rotation&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go"> History:</span>
<span class="go">     SPEX_PRISM spectrum successfully loaded</span>
<span class="go">     Rotationally broadened spectrum by 30.0 km/s</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id41">
<span class="sig-prename descclassname"><span class="pre">splat.core.Spectrum.</span></span><span class="sig-name descname"><span class="pre">rotate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vsini</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id41" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Rotationally broaden the lines of a spectrum; a shortcut call to <a class="reference external" href="api.html#splat.core.Spectrum.broaden">Spectrum.broaden()</a></p>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd">Required Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param vsini<span class="colon">:</span></dt>
<dd class="field-odd"><p>Rotational velocity in km/s</p>
</dd>
</dl>
</dd>
<dt class="field-even">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param epsilon<span class="colon">:</span></dt>
<dd class="field-odd"><p>epsilon parameter for limb darkening in rotational broadening (default = 0.6)</p>
</dd>
<dt class="field-even">param verbose<span class="colon">:</span></dt>
<dd class="field-even"><p>provide extra feedback (default = False)</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Outputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None; Spectral flux is smoothed by rotational broadening</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="mi">10001</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">vsini</span><span class="p">(</span><span class="mf">30.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go"> History:</span>
<span class="go">     SPEX_PRISM spectrum successfully loaded</span>
<span class="go">     Rotationally broadened spectrum by 30.0 km/s</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</section>
<section id="empirical-relationships">
<h3>Empirical Relationships<a class="headerlink" href="#empirical-relationships" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="splat.empirical.estimateDistance">
<span class="sig-prename descclassname"><span class="pre">splat.empirical.</span></span><span class="sig-name descname"><span class="pre">estimateDistance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.empirical.estimateDistance" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Takes the apparent magnitude and either takes or determines the absolute
magnitude, then uses the magnitude/distance relation to estimate the
distance to the object in parsecs. Returns estimated distance and
uncertainty in parsecs</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>sp</strong> -- Spectrum class object, which should be flux calibrated to its empirical apparent magnitude</p></li>
<li><p><strong>mag</strong> (<em>optional</em><em>, </em><em>default = False</em>) -- apparent magnitude of <code class="docutils literal notranslate"><span class="pre">sp</span></code></p></li>
<li><p><strong>mag_unc</strong> (<em>optional</em><em>, </em><em>default = 0</em>) -- uncertainty of the apparent magnitude</p></li>
<li><p><strong>absmag</strong> (<em>optional</em><em>, </em><em>default = False</em>) -- absolute magnitude of <code class="docutils literal notranslate"><span class="pre">sp</span></code></p></li>
<li><p><strong>absmag_unc</strong> (<em>optional</em><em>, </em><em>default = 0</em>) -- uncertainty of the absolute magnitude</p></li>
<li><p><strong>spt</strong> (<em>optional</em><em>, </em><em>default = False</em>) -- spectral type of <code class="docutils literal notranslate"><span class="pre">sp</span></code></p></li>
<li><p><strong>spt_e</strong> (<em>optional</em><em>, </em><em>default = 0</em>) -- uncertainty of the spectral type</p></li>
<li><p><strong>nsamples</strong> (<em>optional</em><em>, </em><em>default = 100</em>) -- number of samples to use in Monte Carlo error estimation</p></li>
<li><p><strong>filter</strong> (<em>optional</em><em>, </em><em>default = False</em>) -- <p>Name of filter, must be one of the following:</p>
<ul>
<li><p>'2MASS J', '2MASS H', '2MASS Ks'</p></li>
<li><p>'MKO J', 'MKO H', 'MKO K', MKO Kp', 'MKO Ks'</p></li>
<li><p>'NICMOS F090M', 'NICMOS F095N', 'NICMOS F097N', 'NICMOS F108N'</p></li>
<li><p>'NICMOS F110M', 'NICMOS F110W', 'NICMOS F113N', 'NICMOS F140W'</p></li>
<li><p>'NICMOS F145M', 'NICMOS F160W', 'NICMOS F164N', 'NICMOS F165M'</p></li>
<li><p>'NICMOS F166N', 'NICMOS F170M', 'NICMOS F187N', 'NICMOS F190N'</p></li>
<li><p>'NIRC2 J', 'NIRC2 H', 'NIRC2 Kp', 'NIRC2 Ks'</p></li>
<li><p>'WIRC J', 'WIRC H', 'WIRC K', 'WIRC CH4S', 'WIRC CH4L'</p></li>
<li><p>'WIRC CO', 'WIRC PaBeta', 'WIRC BrGamma', 'WIRC Fe2'</p></li>
<li><p>'WISE W1', 'WISE W2'</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1555+0954&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">estimateDistance</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="go">    Please specify the filter used to determine the apparent magnitude</span>
<span class="go">    (nan, nan)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">estimateDistance</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">mag</span> <span class="o">=</span> <span class="mf">12.521</span><span class="p">,</span> <span class="n">mag_unc</span> <span class="o">=</span> <span class="mf">0.022</span><span class="p">,</span> <span class="n">absmag</span> <span class="o">=</span> <span class="mf">7.24</span><span class="p">,</span> <span class="n">absmag_unc</span> <span class="o">=</span> <span class="mf">0.50</span><span class="p">,</span> <span class="n">spt</span> <span class="o">=</span> <span class="s1">&#39;M3&#39;</span><span class="p">)</span>
<span class="go">    (116.36999172188771, 33.124820555524224)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id43">
<span class="sig-prename descclassname"><span class="pre">splat.empirical.</span></span><span class="sig-name descname"><span class="pre">redden</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sp</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id43" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Description:</dt><dd><p>Redden a spectrum based on an either Mie theory or a standard interstellar profile
using Cardelli, Clayton, and Mathis (1989 ApJ. 345, 245)</p>
</dd>
</dl>
<p><strong>Usage</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="mi">10001</span><span class="p">)</span>                   <span class="c1"># read in a source</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spr</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">redden</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">av</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span><span class="n">rv</span><span class="o">=</span><span class="mf">3.2</span><span class="p">)</span>          <span class="c1"># redden to equivalent of AV=5</span>
</pre></div>
</div>
<dl class="simple">
<dt><strong>Note</strong></dt><dd><p>This routine is still in beta form; only the CCM89 currently works</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.empirical.typeToColor">
<span class="sig-prename descclassname"><span class="pre">splat.empirical.</span></span><span class="sig-name descname"><span class="pre">typeToColor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'skrzypek2015'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncertainty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forgiving</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.empirical.typeToColor" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Takes a spectral type and optionally a color (string) and returns the typical color of the source.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param spt<span class="colon">:</span></dt>
<dd class="field-odd"><p>string, integer, float, list or numpy array specify the spectral type(s) to be evaluated</p>
</dd>
<dt class="field-even">param color<span class="colon">:</span></dt>
<dd class="field-even"><p>string indicating color; e.g., color='SDSS_I-SDSS_Z'; filter names are checked against splat.FILTERS structure</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param reference<span class="colon">:</span></dt>
<dd class="field-odd"><p>Abs Mag/SpT relation used to compute the absolute magnitude. Options are:</p>
<ul class="simple">
<li><p><em>skrzypek</em> (default): Color trends from <a class="reference external" href="http://adsabs.harvard.edu/abs/2015A%26A...574A..78S">Skryzpek et al. (2015)</a>.
Spectral type range is M5 to T8
Colors include SDSS_I-SDSS_Z, SDSS_Z-UKIDSS_Y, UKIDSS_Y-MKO_J, MKO_J-MKO_H, MKO_H-MKO_K, MKO_K-WISE_W1, WISE_W1-WISE_W2, and combinations therein.</p></li>
<li><p><em>leggett</em>: Color trends from <a class="reference external" href="http://adsabs.harvard.edu/abs/2017ApJ...842..118L">Leggett et al. (2017)</a>.
Spectral type range is T7.5 to Y2
Colors include MKO_Y-WFC3_F105W, MKO_J-WFC3_F125W, MKO_J-WFC3_F127M, MKO_H-WFC3_F160W, MKO_H-WIRC_CH4S</p></li>
</ul>
</dd>
<dt class="field-even">param uncertainty<span class="colon">:</span></dt>
<dd class="field-even"><p>uncertainty on input spectral types, should be float, list of floats or numpy array (default = 0)</p>
</dd>
<dt class="field-odd">param nsamples<span class="colon">:</span></dt>
<dd class="field-odd"><p>number of Monte Carlo samples for error computation (default = 100)</p>
</dd>
<dt class="field-even">param verbose<span class="colon">:</span></dt>
<dd class="field-even"><p>Give feedback while in operation (default = False)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the value and uncertainty (including systematic) of the resulting color.
If more than one spectral type is given, this tuple contains two numpy arrays</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.empirical</span> <span class="k">as</span> <span class="nn">spem</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spem</span><span class="o">.</span><span class="n">typeToColor</span><span class="p">(</span><span class="s1">&#39;L3&#39;</span><span class="p">,</span> <span class="s1">&#39;MKO_J-MKO_K&#39;</span><span class="p">)</span>
<span class="go">    (1.4266666666666665, 0.07)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spem</span><span class="o">.</span><span class="n">typeToColor</span><span class="p">([</span><span class="s1">&#39;M5&#39;</span><span class="p">,</span><span class="s1">&#39;M6&#39;</span><span class="p">,</span><span class="s1">&#39;M7&#39;</span><span class="p">],</span> <span class="s1">&#39;SDSS_I-SDSS_Z&#39;</span><span class="p">,</span> <span class="n">reference</span> <span class="o">=</span> <span class="s1">&#39;skrzypek&#39;</span><span class="p">,</span> <span class="n">uncertainty</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">    (array([0.91      , 1.4275    , 1.74333333]),</span>
<span class="go">     array([0.5624636 , 0.27662768, 0.13987478]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spem</span><span class="o">.</span><span class="n">typeToColor</span><span class="p">(</span><span class="s1">&#39;M0&#39;</span><span class="p">,</span> <span class="s1">&#39;SDSS_I-SDSS_Z&#39;</span><span class="p">,</span> <span class="n">ref</span> <span class="o">=</span> <span class="s1">&#39;skrzypek&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    Using the SpT/color trends from skrzypek2015</span>
<span class="go">    Rejected 1 spectral type(s) for being outside relation range</span>
<span class="go">    (nan, nan)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.empirical.typeToMag">
<span class="sig-prename descclassname"><span class="pre">splat.empirical.</span></span><span class="sig-name descname"><span class="pre">typeToMag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncertainty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'filippazzo2015'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.empirical.typeToMag" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Takes a spectral type and a filter, and returns the expected absolute magnitude based on empirical relations</p>
<dl class="field-list">
<dt class="field-odd">Required Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param spt<span class="colon">:</span></dt>
<dd class="field-odd"><p>string or integer of the spectral type</p>
</dd>
<dt class="field-even">param filter<span class="colon">:</span></dt>
<dd class="field-even"><p>filter for which to retrieve absolute magnitude, which must be defined for the given reference set.</p>
</dd>
</dl>
<p>You can check what filters are available by printing splat.SPT_ABSMAG_RELATIONS[reference]['filters'].keys(), where reference is, e.g., 'filippazzo2015'</p>
</dd>
<dt class="field-even">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param reference<span class="colon">:</span></dt>
<dd class="field-odd"><p>Abs Mag/SpT relation used to compute the absolute magnitude (also 'ref' and 'set'). These are defined in splat.SPT_ABSMAG_RELATIONS and are currently as follows:</p>
<ul class="simple">
<li><p><em>dahn2002</em>: Abs Mag/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2002AJ....124.1170D">Dahn et al. (2002)</a>
Allowed spectral type range is M7 to L8, and allowed filters are 2MASS J</p></li>
<li><p><em>hawley2002</em>: Abs Mag/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2002AJ....123.3409H">Hawley et al. (2002)</a>
Allowed spectral type range is M0 to T6, and allowed filters are 2MASS J</p></li>
<li><p><em>cruz2003</em>: Abs Mag/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2003AJ....126.2421C">Cruz et al. (2003)</a>
Allowed spectral type range is M6 to L8, and allowed filters are 2MASS J</p></li>
<li><p><em>tinney2003</em>: Abs Mag/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2003AJ....126..975T">Tinney et al. (2003)</a>.
Allowed spectral type range is L0 to T7.5, and allowed filters are Cousins I, UKIRT Z, J, K and 2MASS J, Ks</p></li>
<li><p><em>burgasser2007</em>: Abs Mag/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2007ApJ...659..655B">Burgasser (2007)</a>.
Allowed spectral type range is L0 to T8, and allowed filters are MKO K.</p></li>
<li><p><em>looper2008</em>: Abs Mag/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2008ApJ...685.1183L">Looper et al. (2008)</a>.
Allowed spectral type range is L0 to T8, and allowed filters are 2MASS J, H, Ks.</p></li>
<li><p><em>dupuy2012</em>: Abs Mag/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJS..201...19D">Dupuy &amp; Liu (2012)</a>.
Allowed spectral type range is M6 to T9, and allowed filters are MKO Y, J, H,K, LP, 2MASS J, H, Ks, and WISE W1, W2.</p></li>
<li><p><em>faherty2012</em>: Abs Mag/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...752...56F">Faherty et al. (2012)</a>.
Allowed spectral type range is L0 to T8, and allowed filters are MKO J, H, K.</p></li>
<li><p><em>tinney2014</em>: Abs Mag/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2014ApJ...796...39T">Tinney et al. (2014)</a>.
Allowed spectral type range is T6.5 to Y2, and allowed filters are MKO J, WISE W2</p></li>
<li><p><em>filippazzo2015</em> (default): Abs Mag/SpT relation from Filippazzo et al. (2015).
Allowed spectral type range is M6 to T9, and allowed filters are 2MASS J and WISE W2.</p></li>
<li><p><em>faherty2016</em>: Abs Mag/SpT relation for field dwarfs from <a class="reference external" href="http://adsabs.harvard.edu/abs/2016ApJS..225...10F">Faherty et al. (2016)</a>.
Allowed spectral type range is M6 to T9, and allowed filters are 2MASS J, H, Ks and WISE W1, W2, W3</p></li>
<li><p><em>faherty2016-group</em>: Abs Mag/SpT relation for &quot;group&quot; dwarfs from <a class="reference external" href="http://adsabs.harvard.edu/abs/2016ApJS..225...10F">Faherty et al. (2016)</a>.
Allowed spectral type range is M7 to L7, and allowed filters are 2MASS J, H, Ks and WISE W1, W2, W3</p></li>
<li><p><em>faherty2016-young</em>: Abs Mag/SpT relation for &quot;young&quot; dwarfs from <a class="reference external" href="http://adsabs.harvard.edu/abs/2016ApJS..225...10F">Faherty et al. (2016)</a>.
Allowed spectral type range is M7 to L7, and allowed filters are 2MASS J, H, Ks and WISE W1, W2, W3</p></li>
</ul>
</dd>
<dt class="field-even">param uncertainty<span class="colon">:</span></dt>
<dd class="field-even"><p>uncertainty of <code class="docutils literal notranslate"><span class="pre">spt</span></code> (default = 0)</p>
</dd>
<dt class="field-odd">param nsamples<span class="colon">:</span></dt>
<dd class="field-odd"><p>number of Monte Carlo samples for error computation (default = 100)</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>2 element tuple providing the absolute magnitude and its uncertainty</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToMag</span><span class="p">(</span><span class="s1">&#39;L3&#39;</span><span class="p">,</span> <span class="s1">&#39;2MASS J&#39;</span><span class="p">)</span>
<span class="go">    (12.730064813273996, 0.4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToMag</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="s1">&#39;MKO K&#39;</span><span class="p">,</span> <span class="n">ref</span> <span class="o">=</span> <span class="s1">&#39;burgasser&#39;</span><span class="p">)</span>
<span class="go">    (10.705292820099999, 0.26)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToMag</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;2MASS J&#39;</span><span class="p">,</span> <span class="n">ref</span> <span class="o">=</span> <span class="s1">&#39;faherty&#39;</span><span class="p">)</span>
<span class="go">    Invalid filter given for Abs Mag/SpT relation from Faherty et al. (2012)</span>
<span class="go">    (nan, nan)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToMag</span><span class="p">(</span><span class="s1">&#39;M0&#39;</span><span class="p">,</span> <span class="s1">&#39;2MASS H&#39;</span><span class="p">,</span> <span class="n">ref</span> <span class="o">=</span> <span class="s1">&#39;dupuy&#39;</span><span class="p">)</span>
<span class="go">    Spectral Type is out of range for Abs Mag/SpT relation from Dupuy &amp; Liu (2012) Abs Mag/SpT relation</span>
<span class="go">    (nan, nan)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.empirical.typeToTeff">
<span class="sig-prename descclassname"><span class="pre">splat.empirical.</span></span><span class="sig-name descname"><span class="pre">typeToTeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncertainty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'stephens09'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.empirical.typeToTeff" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Returns an effective temperature (Teff) and its uncertainty for a given spectral type (or vice versa) based on an empirical relation</p>
<dl class="field-list">
<dt class="field-odd">Required Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param inp<span class="colon">:</span></dt>
<dd class="field-odd"><p>A single or array of either spectral types or effective temperatures (reverse).</p>
</dd>
</dl>
<p>If spectral types, these can be ints, floats or strings from 0 (K0) and 49.0 (Y9).
If temperatures, these can be ints or floats and assumed to be in units of Kelvin.
Note: you must set reverse=True to convert temperature to spectral type.</p>
</dd>
<dt class="field-even">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param uncertainty<span class="colon">:</span></dt>
<dd class="field-odd"><p>uncertainty of spectral type/temperature (default = 0.001; also 'unc', 'spt_e')</p>
</dd>
<dt class="field-even">param reference<span class="colon">:</span></dt>
<dd class="field-even"><p>Teff/SpT relation used to compute the effective temperature (also 'set'). Options are:</p>
</dd>
</dl>
<ul class="simple">
<li><p><em>stephens</em> (default): Teff/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2009ApJ...702..154S">Stephens et al. (2009)</a>.
Allowed spectral type range is M6 to T8 and uses alternate coefficients for L3 to T8.</p></li>
<li><p><em>golimowski</em>: Teff/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2004AJ....127.3516G">Golimowski et al. (2004)</a>.
Allowed spectral type range is M6 to T8.</p></li>
<li><p><em>looper</em>: Teff/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2008ApJ...685.1183L">Looper et al. (2008)</a>.
Allowed spectral type range is L0 to T8.</p></li>
<li><p><em>marocco</em>: Teff/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2013AJ....146..161M">Marocco et al. (2013)</a>.
Allowed spectral type range is M7 to T8.</p></li>
<li><p><em>filippazzo</em>: Teff/SpT relation from Filippazzo et al. (2015) &lt;<a class="reference external" href="http://adsabs.harvard.edu/abs/2015ApJ...810..158F">http://adsabs.harvard.edu/abs/2015ApJ...810..158F</a>&gt;`_. Allowed spectral type range is M6 to T9.</p></li>
<li><p><em>faherty</em>: Teff/SpT relation from Faherty et al. (2016) &lt;<a class="reference external" href="http://adsabs.harvard.edu/abs/2016ApJS..225...10F">http://adsabs.harvard.edu/abs/2016ApJS..225...10F</a>&gt;`_.</p></li>
</ul>
<p>This relation is defined for normal dwarfs (M7 &lt; SpT &lt; T8), young dwarfs (<code class="docutils literal notranslate"><span class="pre">-young</span></code> and <code class="docutils literal notranslate"><span class="pre">-young2</span></code>, M7 &lt; SpT &lt; L7),
and young dwarfs in groups (<code class="docutils literal notranslate"><span class="pre">-group</span></code>, M7 &lt; SpT &lt; L7)
- <em>dupuy</em>: Teff/SpT relation from Dupuy et al. (2017).
This relation is defined for Saumon &amp; Marley (2008) models (<code class="docutils literal notranslate"><span class="pre">-saumon</span></code>, L1.5 &lt; SpT &lt; T5) and Lyon models (<code class="docutils literal notranslate"><span class="pre">-lyon</span></code>, M7 &lt; SpT &lt; T5)</p>
<dl class="field-list simple">
<dt class="field-odd">param reverse<span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to convert effective temperature to spectral type (default=False)</p>
</dd>
<dt class="field-even">param nsamples<span class="colon">:</span></dt>
<dd class="field-even"><p>number of samples to use in Monte Carlo error estimation (default=100)</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>A 2-element tuple containing the Teff/SpT and its uncertainty</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToTeff</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">    (2233.4796740905499, 100.00007874571999)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToTeff</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">unc</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">ref</span> <span class="o">=</span> <span class="s1">&#39;golimowski&#39;</span><span class="p">)</span>
<span class="go">    (2305.7500497902788, 127.62548366132124)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.empirical.typeToLuminosity">
<span class="sig-prename descclassname"><span class="pre">splat.empirical.</span></span><span class="sig-name descname"><span class="pre">typeToLuminosity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncertainty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'filippazzo2015'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.empirical.typeToLuminosity" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Takes a spectral type and returns the expected scaled log luminosity (log Lbol/Lsun) based on empirical relations</p>
<dl class="field-list">
<dt class="field-odd">Required Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param spt<span class="colon">:</span></dt>
<dd class="field-odd"><p>string or integer of the spectral type</p>
</dd>
</dl>
</dd>
<dt class="field-even">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param reference<span class="colon">:</span></dt>
<dd class="field-odd"><p>log Lbol/SpT relation reference (also 'ref' and 'set'). These are defined in splat.SPT_LBOL_RELATIONS and are currently as follows:</p>
<ul class="simple">
<li><p><em>filippazzo2015</em> (default): Lbol/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2013Sci...341.1492D">Filippazzo et al. (2015)</a>
Allowed spectral type range is M6 to T9</p></li>
</ul>
</dd>
<dt class="field-even">param uncertainty<span class="colon">:</span></dt>
<dd class="field-even"><p>uncertainty of <code class="docutils literal notranslate"><span class="pre">spt</span></code> (default = 0)</p>
</dd>
<dt class="field-odd">param reverse<span class="colon">:</span></dt>
<dd class="field-odd"><p>apply reverse approach: given BC, infer spectral type</p>
</dd>
<dt class="field-even">param nsamples<span class="colon">:</span></dt>
<dd class="field-even"><p>number of Monte Carlo samples for error computation (default = 100)</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>2 element tuple providing the absolute magnitude and its uncertainty</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToLuminosity</span><span class="p">(</span><span class="s1">&#39;L3&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.empirical.typeToBC">
<span class="sig-prename descclassname"><span class="pre">splat.empirical.</span></span><span class="sig-name descname"><span class="pre">typeToBC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncertainty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'filippazzo2015'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.empirical.typeToBC" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p>Takes a spectral type and a filter, and returns the expected bolometric correction BC = M_bol - M_filter</p>
<dl class="field-list">
<dt class="field-odd">Required Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param spt<span class="colon">:</span></dt>
<dd class="field-odd"><p>string or integer of the spectral type</p>
</dd>
<dt class="field-even">param filter<span class="colon">:</span></dt>
<dd class="field-even"><p>filter for which to retrieve absolute magnitude, which must be defined for the given reference set.</p>
</dd>
</dl>
<p>You can check what filters are available by printing splat.SPT_BC_RELATIONS[reference]['filters'].keys(), where reference is, e.g., 'filippazzo2015'</p>
</dd>
<dt class="field-even">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param reference<span class="colon">:</span></dt>
<dd class="field-odd"><p>Abs Mag/SpT relation used to compute the absolute magnitude (also 'ref' and 'set'). These are defined in splat.SPT_BC_RELATIONS and are currently as follows:</p>
<ul class="simple">
<li><p><em>liu2010</em>: BC/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJ...722..311L">Liu et al. (2010)</a>
Allowed spectral type range is M6 to T8.5, and allowed filters are MKO J, H, K</p></li>
<li><p><em>dupuy2013</em>: BC/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2013Sci...341.1492D">Dupuy &amp; Kraus (2013)</a>
Allowed spectral type range is T8 to Y0.5, and allowed filters are MKO Y, J, H</p></li>
<li><p><em>filippazzo2015</em> (default): BC/SpT relation from <a class="reference external" href="http://adsabs.harvard.edu/abs/2013Sci...341.1492D">Filippazzo et al. (2015)</a>
Allowed spectral type range is M6 to T8/9, and allowed filters are 2MASS J, Ks</p></li>
<li><p><em>filippazzo2015-young</em>: BC/SpT relation for young sources from <a class="reference external" href="http://adsabs.harvard.edu/abs/2013Sci...341.1492D">Filippazzo et al. (2015)</a>
Allowed spectral type range is M7 to T8, and allowed filters are 2MASS J, Ks</p></li>
</ul>
</dd>
<dt class="field-even">param uncertainty<span class="colon">:</span></dt>
<dd class="field-even"><p>uncertainty of <code class="docutils literal notranslate"><span class="pre">spt</span></code> (default = 0)</p>
</dd>
<dt class="field-odd">param reverse<span class="colon">:</span></dt>
<dd class="field-odd"><p>apply reverse approach: given BC, infer spectral type</p>
</dd>
<dt class="field-even">param nsamples<span class="colon">:</span></dt>
<dd class="field-even"><p>number of Monte Carlo samples for error computation (default = 100)</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>2 element tuple providing the absolute magnitude and its uncertainty</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToBC</span><span class="p">(</span><span class="s1">&#39;L3&#39;</span><span class="p">,</span> <span class="s1">&#39;2MASS J&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.checkAbsMag">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">checkAbsMag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.checkAbsMag" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Purpose:</dt><dd><p>Checks that an input reference name and filter are among the available sets for <a class="reference external" href="TMP">typeToMag()</a>,
including a check of alternate names</p>
</dd>
</dl>
<dl>
<dt>Required Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param ref<span class="colon">:</span></dt>
<dd class="field-odd"><p>A string containing the reference for absolute magnitude relation,</p>
</dd>
</dl>
<p>among the keys and alternate names in splat.SPT_ABSMAG_RELATIONS</p>
</dd>
<dt>Optional Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param filt<span class="colon">:</span></dt>
<dd class="field-odd"><p>A string containing the filter name, to optionally check if this filter is among those defined in the reference set</p>
</dd>
</dl>
</dd>
<dt>Output:</dt><dd><p>A string containing SPLAT's default name for a given reference set, or False if that reference is not present</p>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">splat</span><span class="o">.</span><span class="n">checkEvolutionaryModelName</span><span class="p">(</span><span class="s1">&#39;burrows&#39;</span><span class="p">))</span>
<span class="go">    burrows01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">splat</span><span class="o">.</span><span class="n">checkEvolutionaryModelName</span><span class="p">(</span><span class="s1">&#39;allard&#39;</span><span class="p">))</span>
<span class="go">    False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.checkBC">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">checkBC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.checkBC" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Purpose:</dt><dd><p>Checks that an input reference name and filter are among the available sets for <a class="reference external" href="TMP">typeToBC()</a>,
including a check of alternate names</p>
</dd>
</dl>
<dl>
<dt>Required Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param ref<span class="colon">:</span></dt>
<dd class="field-odd"><p>A string containing the reference for absolute magnitude relation,</p>
</dd>
</dl>
<p>among the keys and alternate names in splat.SPT_BC_RELATIONS</p>
</dd>
<dt>Optional Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param filt<span class="colon">:</span></dt>
<dd class="field-odd"><p>A string containing the filter name, to optionally check if this filter is among those defined in the reference set</p>
</dd>
</dl>
</dd>
<dt>Output:</dt><dd><p>A string containing SPLAT's default name for a given reference set, or False if that reference is not present</p>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">splat</span><span class="o">.</span><span class="n">checkBC</span><span class="p">(</span><span class="s1">&#39;filippazzo&#39;</span><span class="p">,</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">))</span>
<span class="go">    filippazzo2015</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">splat</span><span class="o">.</span><span class="n">checkBC</span><span class="p">(</span><span class="s1">&#39;dupuy&#39;</span><span class="p">,</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">))</span>
<span class="go">    False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.checkLbol">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">checkLbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.checkLbol" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Purpose:</dt><dd><p>Checks that an input reference name are among the available sets for <a class="reference external" href="TMP">typeToLuminosity()</a>,
including a check of alternate names</p>
</dd>
</dl>
<dl>
<dt>Required Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param ref<span class="colon">:</span></dt>
<dd class="field-odd"><p>A string containing the reference for lumiosity/SpT relation,</p>
</dd>
</dl>
<p>among the keys and alternate names in splat.SPT_LBOL_RELATIONS</p>
</dd>
<dt>Optional Inputs:</dt><dd><p>None</p>
</dd>
<dt>Output:</dt><dd><p>A string containing SPLAT's default name for a given reference set, or False if that reference is not present</p>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">splat</span><span class="o">.</span><span class="n">checkLbol</span><span class="p">(</span><span class="s1">&#39;filippazzo&#39;</span><span class="p">))</span>
<span class="go">    filippazzo2015</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">splat</span><span class="o">.</span><span class="n">checkBC</span><span class="p">(</span><span class="s1">&#39;burgasser&#39;</span><span class="p">))</span>
<span class="go">    False</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="conversion-routines">
<h3>Conversion Routines<a class="headerlink" href="#conversion-routines" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.coordinateToDesignation">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">coordinateToDesignation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'J'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.coordinateToDesignation" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts right ascension and declination into a designation string</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>c</strong> -- RA and Dec coordinate to be converted; can be a SkyCoord object with units of degrees,
a list with RA and Dec in degrees, or a string with RA measured in hour
angles and Dec in degrees</p>
</dd>
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>Designation string</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="mf">238.86</span><span class="p">,</span> <span class="mf">9.90</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">coordinateToDesignation</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">    J15552640+0954000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">coordinateToDesignation</span><span class="p">([</span><span class="mf">238.86</span><span class="p">,</span> <span class="mf">9.90</span><span class="p">])</span>
<span class="go">    J15552640+0954000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">coordinateToDesignation</span><span class="p">(</span><span class="s1">&#39;15:55:26.4 +09:54:00.0&#39;</span><span class="p">)</span>
<span class="go">    J15552640+0954000</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.designationToCoordinate">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">designationToCoordinate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.designationToCoordinate" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Convert a designation string into a RA, Dec tuple or ICRS SkyCoord objects (default)</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>value</strong> (<em>required</em>) -- Designation string with RA measured in hour angles and Dec in degrees</p></li>
<li><p><strong>icrs</strong> (<em>optional</em><em>, </em><em>defualt = True</em>) -- returns astropy SkyCoord coordinate in ICRS frame if <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li>
</ul>
</dd>
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>Coordinate, either as [RA, Dec] or SkyCoord object</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">designationToCoordinate</span><span class="p">(</span><span class="s1">&#39;J1555264+0954120&#39;</span><span class="p">)</span>
<span class="go">&lt;SkyCoord (ICRS): (ra, dec) in deg</span>
<span class="go">    (238.8585, 9.90333333)&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.designationToCoordinateString">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">designationToCoordinateString</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">designation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radec_delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.designationToCoordinateString" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Convert a designation string into a coordinate string with delimiters between hour, minute, second, etc.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param designation<span class="colon">:</span></dt>
<dd class="field-odd"><p>designation, which should be a string of the form 'J12345678+01234567'</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>delimiter = ' ': delimiter between coordinate elements</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>radec_delimiter = ' ': delimiter between RA and declination substrings</p>
</dd>
</dl>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>coordinate string of the form '12 34 56.78 +01 23 45.67' (depending on delimiters)</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">designationToCoordinateString</span><span class="p">(</span><span class="s1">&#39;J1555264+0954120&#39;</span><span class="p">)</span>
<span class="go">15 55 26.4 +09 54 12.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">designationToCoordinateString</span><span class="p">(</span><span class="s1">&#39;J155526400+095412000&#39;</span><span class="p">,</span><span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="go">15 55 26.400 +09 54 12.000</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.designationToShortName">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">designationToShortName</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.designationToShortName" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Produce a shortened version of designation</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>value</strong> (<em>required</em>) -- Designation string with RA measured in hour angles and Dec in degrees</p>
</dd>
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>Shorthand designation string</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">designationToShortName</span><span class="p">(</span><span class="s1">&#39;J1555264+0954120&#39;</span><span class="p">)</span>
<span class="go">    J1555+0954</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.typeToNum">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">typeToNum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subclass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dwarf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncertainty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">luminosity_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metallicity_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">peculiar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.typeToNum" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts between string and numeric spectral types, with the option of specifying the class prefix/suffix and uncertainty tags</p>
</dd>
<dt class="field-even">Required inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param inp<span class="colon">:</span></dt>
<dd class="field-odd"><p>Spectral type to convert. Can convert a number or a string from 0.0 (K0) and 49.0 (Y9).</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>error = '': flag to indicate magnitude of classification uncertainty; by default ':' for uncertainty &gt; 1 subtypes and '::' for uncertainty &gt; 2 subtype added as suffix to string output. Can also use <cite>err</cite>.</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>uncertainty = 0: numerical uncertainty of classification; can also use <cite>unc</cite></p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>subclass = 'dwarf': spectral class; options include:</p>
<ul class="simple">
<li><p><em>field</em> or <em>fld</em> or <em>alpha</em>: object is a field dwarf - no prefix/suffix to string output</p></li>
<li><p><em>sd</em> or <em>subdwarf</em>: object is a subdwarf - 'sd' prefix to string output</p></li>
<li><p><em>dsd</em> or <em>d/sd</em>: object is an intermediate subdwarf - 'd/sd' prefix to string output</p></li>
<li><p><em>esd</em>: object is an extreme subdwarf - 'esd' prefix to string output</p></li>
<li><p><em>usd</em>: object is an ultra subdwarf - 'usd' prefix to string output</p></li>
<li><p><em>delta</em>: object is a extremely low surface gravity dwarf (~1 Myr) - 'delta' suffix to string output</p></li>
<li><p><em>vlg</em> or <em>gamma</em> or <em>lowg</em>: object is a low surface gravity dwarf (~10 Myr) - 'gamma' suffix to string output</p></li>
<li><p><em>intg</em> or <em>beta</em>: object is an intermediate surface gravity dwarf (~100 Myr) - 'beta' suffix to string output</p></li>
<li><p><em>giant</em>: object is a giant with luminosity class III suffix added to string output</p></li>
<li><p><em>subgiant</em>: object is a subgiant with luminosity class IV suffix added to string output</p></li>
<li><p><em>supergiant</em>: object is a supergiant with luminosity class I suffix added to string output</p></li>
</ul>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>metallicity_class = '': metallicity class of object, traditionally represented by 'sd','d/sd','esd','usd', and added on as prefix to string output. Can also use <cite>lumclass</cite></p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>luminosity_class = '': luminosity class of object traditionally represented by roman numerals (e.g., 'III') and added on as suffix to string output. Can also use <cite>lumclass</cite></p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>age_class = '': age class of object, traditionally one of 'alpha', 'beta', 'gamma', 'delta' and added on as suffix to string output (see subclass). Can also use 'ageclass'</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>color_class: color class of object, traditionally 'b' (for blue) or 'r' (for red), added as prefix to string output. Can also use 'colorclass'</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>peculiar = False: Set to True if object is peculiar, which adds a 'pec' suffix to string output</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>verbose = False: Set to True to provide more feedback</p>
</dd>
</dl>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>The number or string of a spectral type</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToNum</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="go">    T0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToNum</span><span class="p">(</span><span class="s1">&#39;T0.0&#39;</span><span class="p">)</span>
<span class="go">    30.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToNum</span><span class="p">(</span><span class="mi">27</span><span class="p">,</span> <span class="n">peculiar</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">uncertainty</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span> <span class="n">lumclass</span> <span class="o">=</span> <span class="s1">&#39;II&#39;</span><span class="p">)</span>
<span class="go">    L7.0IIp:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToNum</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="go">    Spectral type number must be between 0 (K0) and 49.0 (Y9)</span>
<span class="go">    nan</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.properCoordinates">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">properCoordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'icrs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">icrs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.properCoordinates" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts various coordinate forms to the proper SkyCoord format. Convertible forms include lists and strings.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>c</strong> -- coordinate to be converted. Can be a list (ra, dec) or a string.</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">properCoordinates</span><span class="p">([</span><span class="mf">104.79</span><span class="p">,</span> <span class="mf">25.06</span><span class="p">])</span>
<span class="go">    &lt;SkyCoord (ICRS): ra=104.79 deg, dec=25.06 deg&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">properCoordinates</span><span class="p">(</span><span class="s1">&#39;06:59:09.60 +25:03:36.0&#39;</span><span class="p">)</span>
<span class="go">    &lt;SkyCoord (ICRS): ra=104.79 deg, dec=25.06 deg&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">properCoordinates</span><span class="p">(</span><span class="s1">&#39;J06590960+2503360&#39;</span><span class="p">)</span>
<span class="go">    &lt;SkyCoord (ICRS): ra=104.79 deg, dec=25.06 deg&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.properDate">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">properDate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">din</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.properDate" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts various date formats into a standardized date of YYYY-MM-DD</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>d</strong> -- Date to be converted.</p></li>
<li><p><strong>format</strong> (<em>Optional</em><em>, </em><em>string</em>) -- Optional input format of the following form:
* 'YYYY-MM-DD': e.g., 2011-04-03 (this is default output)
* 'YYYYMMDD': e.g., 20110403
* 'YYMMDD': e.g., 20110403
* 'MM/DD/YY': e.g., 03/04/11
* 'MM/DD/YYYY': e.g., 03/04/2011
* 'YYYY/MM/DD': e.g., 2011/03/04
* 'DD/MM/YYYY': e.g., 04/03/2011
* 'DD MMM YYYY': e.g., 04 Mar 2011
* 'YYYY MMM DD': e.g., 2011 Mar 04</p></li>
<li><p><strong>output</strong> (<em>Optional</em><em>, </em><em>string</em>) -- Format of the output based on the prior list</p></li>
</ul>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">properDate</span><span class="p">(</span><span class="s1">&#39;20030502&#39;</span><span class="p">)</span>
<span class="go">    &#39;2003-05-02&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">properDate</span><span class="p">(</span><span class="s1">&#39;2003/05/02&#39;</span><span class="p">)</span>
<span class="go">    &#39;02-2003-05&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">properDate</span><span class="p">(</span><span class="s1">&#39;2003/05/02&#39;</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;YYYY/MM/DD&#39;</span><span class="p">)</span>
<span class="go">    &#39;2003-05-02&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">properDate</span><span class="p">(</span><span class="s1">&#39;2003/05/02&#39;</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;YYYY/MM/DD&#39;</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;YYYY MMM DD&#39;</span><span class="p">)</span>
<span class="go">    &#39;2003 May 02&#39;</span>
</pre></div>
</div>
<p>Note that the default output format can be read into an astropy.time quantity
&gt;&gt;&gt; import splat
&gt;&gt;&gt; from astropy.time import Time
&gt;&gt;&gt; t = Time(splat.properDate('20030502'))
&gt;&gt;&gt; print(t)</p>
<blockquote>
<div><p>2003-05-02 00:00:00.000</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.UVW">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">UVW</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_distance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_mu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.0,</span> <span class="pre">0.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_rv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.UVW" title="Link to this definition">¶</a></dt>
<dd><p>THIS FUNCTION NEEDS CLEANING</p>
</dd></dl>

</section>
<section id="plotting-routines">
<h3>Plotting Routines<a class="headerlink" href="#plotting-routines" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="splat.plot.plotMap">
<span class="sig-prename descclassname"><span class="pre">splat.plot.</span></span><span class="sig-name descname"><span class="pre">plotMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.plot.plotMap" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plot coordinates onto an equatorial map grid</p>
</dd>
<dt class="field-even">Input<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<p>One or more coordinates, specified as astropy.coordinates.SkyCoord objects, two-element arrays
(RA and declination in decimal degrees), or string coordinate designation; the latter two are
converted to SkyCoord variables using <cite>splat.properCoordinates()</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<dl class="simple">
<dt>projection = 'mollweide'</dt><dd><p>projection type; see the <a class="reference external" href="https://matplotlib.org/basemap/users/mapsetup.html">Basemap documentation</a></p>
</dd>
<dt>reference_declination or rdec</dt><dd><p>a single or array of declinations to indicates as references, useful for denoting pointing limits</p>
</dd>
<dt>galactic = False</dt><dd><p>Plot in galactic coordinates (NOT YET IMPLEMENTED)</p>
</dd>
<dt>ecliptic = False</dt><dd><p>Plot in ecliptic coordinates (NOT YET IMPLEMENTED)</p>
</dd>
<dt>extrgalactic or supergalactic = False</dt><dd><p>Plot in supergalactic coordinates (NOT YET IMPLEMENTED)</p>
</dd>
<dt>marker or markers or symbol or symbols = 'o'</dt><dd><p>symbol type; see the <a class="reference external" href="https://matplotlib.org/api/markers_api.html">matplotlib documentation</a></p>
</dd>
<dt>size or sizes or symsize or symsizes = 10</dt><dd><p>symbol size</p>
</dd>
<dt>color or colors = 'k'</dt><dd><p>color of plot symbols</p>
</dd>
<dt>alpha or alphas = 0.5</dt><dd><p>transparency of plot symbols</p>
</dd>
<dt>legend, legends, label or labels = None</dt><dd><p>list of strings providing legend-style labels for each spectrum plotted</p>
</dd>
<dt>grid = True:</dt><dd><p>add a grid</p>
</dd>
<dt>file or filename or output:</dt><dd><p>filename or filename base for output</p>
</dd>
<dt>figsize = (8,6)</dt><dd><p>set the figure size; set to default size if not indicated</p>
</dd>
<dt>tight = True:</dt><dd><p>makes a <a href="#id50"><span class="problematic" id="id51">``</span></a>tight'' box plot to elimate extra whitespace</p>
</dd>
</dl>
<dl class="field-list">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.plot</span> <span class="k">as</span> <span class="nn">splot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">searchLibrary</span><span class="p">(</span><span class="n">young</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="n">splat</span><span class="o">.</span><span class="n">properCoordinates</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">s</span><span class="p">[</span><span class="s1">&#39;DESIGNATION&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splot</span><span class="o">.</span><span class="n">plotMap</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.plot.plotSpectrum">
<span class="sig-prename descclassname"><span class="pre">splat.plot.</span></span><span class="sig-name descname"><span class="pre">plotSpectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xrng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yrng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_location</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'upper</span> <span class="pre">right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_fontscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comparison</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_comparison</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'grey'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle_comparison</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth_comparison</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_comparison</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'m'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_residual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">telluric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_telluric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'grey'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle_telluric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth_telluric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_telluric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mdwarf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ldwarf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tdwarf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">young</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_label_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bottom'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeropoint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">':'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linewidth_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inset_xrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inset_yrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inset_position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.65,</span> <span class="pre">0.6,</span> <span class="pre">0.2,</span> <span class="pre">0.2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inset_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multipage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.plot.plotSpectrum" title="Link to this definition">¶</a></dt>
<dd><p>Primary plotting program for splat Spectrum objects.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>inp</strong><span class="classifier">Spectrum objects or array of Spectrum objects or nested array of Spectrum objects</span></dt><dd><dl class="simple">
<dt>These are the spectra to be plotted; the input is flexible:</dt><dd><ul class="simple">
<li><p><cite>Spec</cite>: plot the spectrum Spec</p></li>
<li><p><cite>[Spec1, Spec2, ...]</cite>: plot multiple spectra together, or separately if multiplot = True</p></li>
<li><p><cite>[[Spec1, Spec2], [Spec3, Spec4], ..]</cite>: plot multiple sets of spectra (multiplot forced to be True)</p></li>
</ul>
</dd>
</dl>
</dd>
<dt><strong>xrange: array of two floats or two unitted astropy quantities, default = [0.85,2.42]</strong></dt><dd><p>plot range for wavelength axis</p>
</dd>
<dt><strong>yrange</strong><span class="classifier">array of two floats or two unitted astropy quantities, default = [-0.02,1.2] times <a href="#id150"><span class="problematic" id="id151">`fluxMax()`_</span></a></span></dt><dd><p>plot range for flux axis</p>
</dd>
<dt><strong>xlabel</strong><span class="classifier">string, default = wave.unit</span></dt><dd><p>wavelength axis label; by default set by wave.unit in first Spectrum object</p>
</dd>
<dt><strong>ylabel</strong><span class="classifier">string, default = flux.unit</span></dt><dd><p>flux axis label; by default set by flux.unit in first Spectrum object</p>
</dd>
<dt><strong>xlog, ylog</strong><span class="classifier">bool, default = False</span></dt><dd><p>set the x (wavelength) or y (flux) axis to plot as a log scale</p>
</dd>
<dt><strong>grid</strong><span class="classifier">bool, default = False</span></dt><dd><p>set to True to add a grid</p>
</dd>
<dt><strong>telluric</strong><span class="classifier">bool, default = False</span></dt><dd><p>indicate telluric absorption features</p>
</dd>
<dt><strong>features</strong><span class="classifier">array of strings, default = []</span></dt><dd><p>A list of strings indicating chemical features to label on the spectra
options include H2O, CH4, CO, TiO, VO, FeH, H2, HI, KI, NaI, SB (for spectral binary)</p>
</dd>
<dt><strong>mdwarf, ldwarf, tdwarf, young, binary</strong><span class="classifier">boolean, default = False</span></dt><dd><p>Set to True to add pre-defined features characteristic of these classes</p>
</dd>
<dt><strong>legend</strong><span class="classifier">array of strings, default = []</span></dt><dd><p>list of strings providing legend-style labels for each spectrum plotted</p>
</dd>
<dt><strong>legend_location</strong><span class="classifier">string, default = 'upper right'</span></dt><dd><p>place of legend; options are 'upper left', 'center middle', 'lower right' (variations thereof)
and 'outside'</p>
</dd>
<dt><strong>legend_fontscale: float, default = 1</strong></dt><dd><p>sets the scale factor for the legend fontsize (defaults to fontscale)</p>
</dd>
<dt><strong>band</strong><span class="classifier">array of two floats or array of arrays of two floatS, default = []</span></dt><dd><p>a single or array of 2-element arrays that indicate bands that you want to specifically shade in</p>
</dd>
<dt><strong>band_color</strong><span class="classifier">string or array of strings, default = 'k'</span></dt><dd><p>a single or array of colors to shade the bands</p>
</dd>
<dt><strong>band_alpha</strong><span class="classifier">float or array of floats, default = 0.2</span></dt><dd><p>a single or array of alphas to shade the bands (default = 0.2)</p>
</dd>
<dt><strong>band_label</strong><span class="classifier">string or array of strings, default = ''</span></dt><dd><p>a single or array of labels to annotate the bands (default = '')</p>
</dd>
<dt><strong>band_label_position</strong><span class="classifier">string or array of strings, default = 'bottom'</span></dt><dd><p>a single or array of strings indicating the position of the labels;
can be 'bottom', 'middle', or 'top' (default = 'bottom')</p>
</dd>
<dt><strong>stack</strong><span class="classifier">float, default = 0.</span></dt><dd><p>numerical offset to stack spectra on top of each other</p>
</dd>
<dt><strong>zeropoint</strong><span class="classifier">float or array of floats, default = 0.</span></dt><dd><p>list of offsets for each spectrum, giving finer control than stack</p>
</dd>
<dt><strong>show_zero</strong><span class="classifier">book, default = True</span></dt><dd><p>plot the zeropoint(s) of the spectra</p>
</dd>
<dt><strong>comparison:</strong></dt><dd><p>a comparison Spectrum to compare in each plot, useful for common reference standard</p>
</dd>
<dt><strong>show_noise</strong><span class="classifier">boolean, default = False</span></dt><dd><p>set to True to plot the uncertainty for each spectrum</p>
</dd>
<dt><strong>residual = False:</strong></dt><dd><p>plots the residual between two spectra</p>
</dd>
<dt><strong>color_comparison:</strong></dt><dd><p>color of comparison source plot lines; by default all grey</p>
</dd>
<dt><strong>color:</strong></dt><dd><p>color of plot lines; by default all black</p>
</dd>
<dt><strong>color_noise:</strong></dt><dd><p>color of uncertainty lines; by default same as line color but reduced opacity</p>
</dd>
<dt><strong>colormap:</strong></dt><dd><p>color map to apply based on matplotlib colormaps;
see <a class="reference external" href="http://matplotlib.org/api/pyplot_summary.html?highlight=colormaps#matplotlib.pyplot.colormaps">http://matplotlib.org/api/pyplot_summary.html?highlight=colormaps#matplotlib.pyplot.colormaps</a></p>
</dd>
<dt><strong>linestyle or linestyles:</strong></dt><dd><p>line style of plot lines; by default all solid</p>
</dd>
<dt><strong>fontscale = 1:</strong></dt><dd><p>sets a scale factor for the fontsize</p>
</dd>
<dt><strong>inset = False:</strong></dt><dd><p>place an inset panel showing a close up region of the spectral data</p>
</dd>
<dt><strong>inset_xrange = False:</strong></dt><dd><p>wavelength range for inset panel</p>
</dd>
<dt><strong>inset_yrange = False:</strong></dt><dd><p>flux range for inset panel (otherwise set by flux)</p>
</dd>
<dt><strong>inset_position = [0.65,0.60,0.20,0.20]</strong></dt><dd><p>position of inset planet in normalized units, in order left, bottom, width, height</p>
</dd>
<dt><strong>inset_features = False</strong></dt><dd><p>list of features to label in inset plot</p>
</dd>
<dt><strong>output:</strong></dt><dd><p>filename or filename base for output</p>
</dd>
<dt><strong>multiplot = False:</strong></dt><dd><p>creates multiple plots, depending on format of input (optional)</p>
</dd>
<dt><strong>multipage = False:</strong></dt><dd><p>spreads plots across multiple pages; output file format must be PDF
if not set and plots span multiple pages, these pages are output sequentially as separate files</p>
</dd>
<dt><strong>layout = [1,1]:</strong></dt><dd><p>defines how multiple plots are laid out on a page</p>
</dd>
<dt><strong>figsize:</strong></dt><dd><p>set the figure size; set to default size if not indicated</p>
</dd>
<dt><strong>interactive = False:</strong></dt><dd><p>if plotting to window, set this to make window interactive</p>
</dd>
<dt><strong>tight = True:</strong></dt><dd><p>makes a <a href="#id52"><span class="problematic" id="id53">``</span></a>tight'' box plot to elimate extra whitespace</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>array of matplotlib figure objects</dt><dd><p>Each array element is one of the plots</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#splat.plot.plotBatch" title="splat.plot.plotBatch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plotBatch</span></code></a></dt><dd><p>plots an array of spectra into a grid</p>
</dd>
<dt><a class="reference internal" href="#splat.plot.plotSequence" title="splat.plot.plotSequence"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plotSequence</span></code></a></dt><dd><p>plots a sequence of spectra vertically</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Case 1: A simple view of a random spectrum.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.plot</span> <span class="k">as</span> <span class="nn">splot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spc</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">spt</span><span class="o">=</span><span class="s1">&#39;T5&#39;</span><span class="p">,</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># grab one T5 spectrum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spc</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>                                       <span class="c1"># this automatically generates a &quot;quicklook&quot; plot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splot</span><span class="o">.</span><span class="n">plotSpectrum</span><span class="p">(</span><span class="n">spc</span><span class="p">)</span>                          <span class="c1"># does the same thing</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splot</span><span class="o">.</span><span class="n">plotSpectrum</span><span class="p">(</span><span class="n">spc</span><span class="p">,</span><span class="n">show_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">tdwarf</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># shows the spectrum uncertainty and T dwarf absorption features</span>
</pre></div>
</div>
<dl>
<dt>Case 2: Viewing a set of spectra for a given object</dt><dd><blockquote>
<div><p>In this case we'll look at all of the spectra of TWA 30B in the library,
sorted by year and compared to the first epoch data
This is an example of using multiplot and multipage.</p>
</div></blockquote>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.plot</span> <span class="k">as</span> <span class="nn">splot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splist</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;TWA 30B&#39;</span><span class="p">)</span>         <span class="c1"># get all spectra of TWA 30B</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">junk</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">([</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">1.2</span><span class="p">])</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">splist</span><span class="p">]</span>    <span class="c1"># normalize the spectra</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">observation_date</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">splist</span><span class="p">]</span>       <span class="c1"># observation dates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spsort</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="n">s</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span><span class="n">splist</span><span class="p">))]</span>  <span class="c1"># sort spectra by dates</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dates</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>                                         <span class="c1"># don&#39;t forget to sort dates!</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splot</span><span class="o">.</span><span class="n">plotSpectrum</span><span class="p">(</span><span class="n">spsort</span><span class="p">,</span><span class="n">multiplot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">layout</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">multipage</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span><span class="n">comparison</span><span class="o">=</span><span class="n">spsort</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">show_noise</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">mdwarf</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">telluric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">legend</span><span class="o">=</span><span class="n">dates</span><span class="p">,</span>
<span class="gp">... </span><span class="n">yrange</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.2</span><span class="p">],</span><span class="n">legend_location</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span><span class="n">color_comparison</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span><span class="n">alpha_comparison</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="gp">... </span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;TWA30B.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Case 3: Display a spectra sequence of L dwarfs</dt><dd><blockquote>
<div><p>This example uses the list of standard L dwarf spectra contained in SPLAT,
and illustrates the stack feature.</p>
</div></blockquote>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.plot</span> <span class="k">as</span> <span class="nn">splot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spt</span> <span class="o">=</span> <span class="p">[</span><span class="n">splat</span><span class="o">.</span><span class="n">typeToNum</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">20</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>     <span class="c1"># generate list of L spectral types</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">initiateStandards</span><span class="p">()</span>                            <span class="c1"># initiate standards</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splist</span> <span class="o">=</span> <span class="p">[</span><span class="n">splat</span><span class="o">.</span><span class="n">STDS_DWARF_SPEX</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">spt</span><span class="p">]</span>     <span class="c1"># extact just L dwarfs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">junk</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">normalize</span><span class="p">([</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">1.3</span><span class="p">])</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">splist</span><span class="p">]</span>    <span class="c1"># normalize the spectra</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">legend</span> <span class="o">=</span> <span class="p">[</span><span class="n">sp</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">splist</span><span class="p">]</span>                  <span class="c1"># set labels to be names</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splot</span><span class="o">.</span><span class="n">plotSpectrum</span><span class="p">(</span><span class="n">splist</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="n">legend</span><span class="o">=</span><span class="n">legend</span><span class="p">,</span><span class="n">stack</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># here&#39;s our plot statement</span>
<span class="gp">... </span><span class="n">colormap</span><span class="o">=</span><span class="s1">&#39;copper&#39;</span><span class="p">,</span><span class="n">legend_location</span><span class="o">=</span><span class="s1">&#39;outside&#39;</span><span class="p">,</span><span class="n">telluric</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span><span class="n">xrange</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">2.45</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;lstandards.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.plot.plotBatch">
<span class="sig-prename descclassname"><span class="pre">splat.plot.</span></span><span class="sig-name descname"><span class="pre">plotBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spectra_plot.pdf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comparisons</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normrange</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.9,</span> <span class="pre">1.4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">2]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basecolors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['k',</span> <span class="pre">'m']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classify_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.plot.plotBatch" title="Link to this definition">¶</a></dt>
<dd><p>Plots a batch of spectra into a 2x2 set of PDF files, with options of overplotting
comparison spectra, including best-match spectral standards inferred from <a class="reference external" href="api.html#splat.classifyByStandard">splat.classifyByStandard()</a>.
This routine is essentially a wrapper for a specific use case of <a class="reference external" href="api.html#splat.plot.plotSpectrum">splat.plot.plotSpectrum()</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>inp</strong><span class="classifier">Spectrum or string or array of these</span></dt><dd><p>A single or list of Spectrum objects or filenames, or the glob search string
for a set of files (e.g., '/Data/myspectra/<a href="#id54"><span class="problematic" id="id55">*</span></a>.fits').</p>
</dd>
<dt><strong>output</strong><span class="classifier">string, default = 'spectra_plot.pdf'</span></dt><dd><p>Filename for PDF file output; full path should be included if not saving to local directory</p>
</dd>
<dt><strong>comparisons</strong><span class="classifier">Spectrum or string or array of these, default = None</span></dt><dd><p>list of Spectrum objects or filenames for comparison spectra. If comparisons list is shorter
than source list, then the last comparison source will be repeated. If the comparisons list is
longer, the list will be truncated.</p>
</dd>
<dt><strong>classify</strong><span class="classifier">boolean, default = False</span></dt><dd><p>Set to True to classify sources based on comparison to spectral standards using <a class="reference external" href="api.html#splat.classifyByStandard">splat.classifyByStandard()</a>.
Specific parameters for classification can be specifed with the <cite>classify_kwargs</cite> keyword</p>
</dd>
<dt><strong>normalize</strong><span class="classifier">boolean, default = False</span></dt><dd><p>Set to True to normalize source and (if passed) comparison spectra.</p>
</dd>
<dt><strong>normrange</strong><span class="classifier">list, default = [0.9,1.4]</span></dt><dd><p>Range in micron to compute the normalization</p>
</dd>
<dt><strong>layout</strong><span class="classifier">list, default = [2,2]</span></dt><dd><p>Layout of plots on page (# per row x # per column)</p>
</dd>
<dt><strong>basecolors</strong><span class="classifier">list, default = ['k','m']</span></dt><dd><p>Baseline color pair for plotted spectrum and its (optional) comparison template</p>
</dd>
<dt><strong>legend</strong><span class="classifier">list, default = []</span></dt><dd><p>Set to list of legends for plots. The number of legends should equal the number of
sources and comparisons (if passed) in an alternating sequence. The default is to display
the file name for each source and object name for comparison (if passed)</p>
</dd>
<dt><strong>fontscale</strong><span class="classifier">float, default = 0.7</span></dt><dd><p>Scale factor to change font size; default value is optimal for 2x2 layout</p>
</dd>
<dt><strong>classify_kwargs</strong><span class="classifier">dict, default = {}</span></dt><dd><p>Dictionary of keywords for <a class="reference external" href="api.html#splat.classifyByStandard">splat.classifyByStandard()</a></p>
</dd>
<dt><strong>plot_kwargs</strong><span class="classifier">dict, default = {}</span></dt><dd><p>Dictionary of additional keywords for <a class="reference external" href="api.html#splat.plot.plotSpectrum">splat.plot.plotSpectrum()</a></p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>Additional keyword parameters</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>matplotlib figure object</dt><dd><p>Figure object containing all of the generated plots</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#splat.plot.plotSpectrum" title="splat.plot.plotSpectrum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plotSpectrum</span></code></a></dt><dd><p>primary Spectrum plotting routine</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p><strong>Case 1:</strong> These commands will grab a set of high S/N, optically-classified L5 dwarfs, and
plot them into a single multiple-page PDF document in a 2x2 grid with the best fit
classification standard overplotted:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">glob</span><span class="o">,</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.plot</span> <span class="k">as</span> <span class="nn">splot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splist</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">opt_spt</span><span class="o">=</span><span class="s1">&#39;L5&#39;</span><span class="p">,</span><span class="n">snr</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splot</span><span class="o">.</span><span class="n">plotBatch</span><span class="p">(</span><span class="n">splist</span><span class="p">,</span><span class="n">classify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">yrange</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.2</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;comparison.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Case 2:</strong> These commands will grab a list of spectral files, plot them into a single multiple-page PDF
document in a 2x2 grid, with the best fit classification standard overplotted. The three
calls of <cite>plotBatch()</cite> produce the same outcome.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">glob</span><span class="o">,</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.plot</span> <span class="k">as</span> <span class="nn">splot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;/home/mydata/*.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splot</span><span class="o">.</span><span class="n">plotBatch</span><span class="p">(</span><span class="n">files</span><span class="p">,</span><span class="n">classify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;comparison.pdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splot</span><span class="o">.</span><span class="n">plotBatch</span><span class="p">(</span><span class="s1">&#39;/home/mydata/*.fits&#39;</span><span class="p">,</span><span class="n">classify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;comparison.pdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splot</span><span class="o">.</span><span class="n">plotBatch</span><span class="p">([</span><span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">],</span><span class="n">classify</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;comparison.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.plot.plotSequence">
<span class="sig-prename descclassname"><span class="pre">splat.plot.</span></span><span class="sig-name descname"><span class="pre">plotSequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dwarf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.plot.plotSequence" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Visualze compares a spectrum to a sequence of standards laid out vertically. The standards are chosen to be some number of
type about the best-guess classification, either passed as a parameter or determined with <a class="reference external" href="api.html#splat.classifyByStandard">classifyByStandard()</a>.
More than one spectrum can be provided, in which case multiple plots are returned</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>spec: A single or series of Spectrum objects or filenames, or the glob search string for a set of files to read in (e.g., '/Data/myspectra/<a href="#id56"><span class="problematic" id="id57">*</span></a>.fits'). At least one input must be provided</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>spt = '': Default spectral type for source; this input skips <a class="reference external" href="api.html#splat.classifyByStandard">classifyByStandard()</a></p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>type_range = 2: Number of subtypes to consider above and below best-fit spectral type</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>std_type = 'dwarf': Type of standards to compare to. Should be one of the following: 'dwarf' (default), 'sd', 'dsd', 'esd', 'vlg', 'intg'. These can also be defined by setting the equalivalent keyword parameter; e.g., plotSequence(spec,dwarf=True).</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>output = '': Filename for output; full path should be include if not saving to current directory. If blank, plot is shown on screen</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>verbose = False: Set to True to provide additional feedback</p>
</dd>
</dl>
<p>In addition, relevant parameters for <a href="#id152"><span class="problematic" id="id153">`plotSpectrum()`_</span></a> and <a class="reference external" href="api.html#splat.classifyByStandard">classifyByStandard()</a> may be provided</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>A matplotlib figure object containing the plot  of the spectrum(a) compared to sequence of standards on screen or saved to file</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.plot</span> <span class="k">as</span> <span class="nn">splot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">lucky</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">plotSequence</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;classify.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
</dd></dl>

</section>
<section id="utility-routines">
<h3>Utility Routines<a class="headerlink" href="#utility-routines" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.distributionStats">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">distributionStats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.16,</span> <span class="pre">0.5,</span> <span class="pre">0.84]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.distributionStats" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Find key values along distributions based on quantile steps.
This code is derived almost entirely from triangle.py.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.integralResample">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">integralResample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fast'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.integralResample" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>A 1D integral smoothing and resampling function that attempts to preserve total flux. Uses</p>
</dd>
</dl>
<p>scipy.interpolate.interp1d and scipy.integrate.trapz to perform piece-wise integration</p>
<p>Required Inputs:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xh</strong> -- x-axis values for &quot;high resolution&quot; data</p></li>
<li><p><strong>yh</strong> -- y-axis values for &quot;high resolution&quot; data</p></li>
<li><p><strong>xl</strong> -- x-axis values for resulting &quot;low resolution&quot; data, must be contained within high resolution and have fewer values</p></li>
</ul>
</dd>
</dl>
<p>Optional Inputs:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>nsamp</strong> -- Number of samples for stepwise integration</p>
</dd>
</dl>
<p>Output:</p>
<p>y-axis values for resulting &quot;low resolution&quot; data</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># a coarse way of downsampling spectrum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span><span class="o">,</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;high_resolution_spectrum.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w_low</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">value</span><span class="p">),</span><span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">value</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">/</span><span class="mf">10.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_low</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">integralResample</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="n">w_low</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_low</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">integralResample</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="n">sp</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="n">w_low</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span> <span class="o">=</span> <span class="n">w_low</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">f_low</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">noise</span> <span class="o">=</span> <span class="n">n_low</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">unit</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.reMap">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">reMap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fast'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.reMap" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Maps a function y(x) onto a new grid x'. If x' is higher resolution this is done through interpolation;
if x' is lower resolution, this is done by integrating over the relevant pixels</p>
</dd>
</dl>
<p>Required Inputs:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param x1<span class="colon">:</span></dt>
<dd class="field-odd"><p>x-axis values for original function</p>
</dd>
<dt class="field-even">param y1<span class="colon">:</span></dt>
<dd class="field-even"><p>y-axis values for original function</p>
</dd>
<dt class="field-odd">param x2<span class="colon">:</span></dt>
<dd class="field-odd"><p>x-axis values for output function</p>
</dd>
</dl>
</div></blockquote>
<p>Optional Inputs:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param nsamp<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of samples for stepwise integration if going from high resolution to low resolution</p>
</dd>
</dl>
</div></blockquote>
<p>Output:</p>
<blockquote>
<div><p>y-axis values for resulting remapped function</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># a coarse way of downsampling spectrum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span><span class="o">,</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;high_resolution_spectrum.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w_low</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">value</span><span class="p">),</span><span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">value</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">/</span><span class="mf">10.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_low</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">integralResample</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="n">w_low</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_low</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">integralResample</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="n">sp</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="n">w_low</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span> <span class="o">=</span> <span class="n">w_low</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span> <span class="o">=</span> <span class="n">f_low</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">flux</span><span class="o">.</span><span class="n">unit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">noise</span> <span class="o">=</span> <span class="n">n_low</span><span class="o">*</span><span class="n">sp</span><span class="o">.</span><span class="n">noise</span><span class="o">.</span><span class="n">unit</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id59">
<span class="sig-prename descclassname"><span class="pre">splat.core.</span></span><span class="sig-name descname"><span class="pre">readSpectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Unit('micron')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Unit('erg</span> <span class="pre">/</span> <span class="pre">(micron</span> <span class="pre">s</span> <span class="pre">cm2)')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensionless</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delimiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crval1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CRVAL1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cdelt1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CDELT1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catch_sn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_nans</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">no_zero_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_instrument_reader</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SPEX-PRISM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument_param</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id59" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>file</strong><span class="classifier">string</span></dt><dd><p>filename of data to be read in; if full path not provided, routine will search in local directory
or in folder indicated by folder keyword; can also pass a URL to a remote file</p>
</dd>
<dt><strong>folder = ''</strong><span class="classifier">string [optional]</span></dt><dd><p>full path to folder containing file</p>
</dd>
<dt><strong>file_type = ''</strong><span class="classifier">string [optional]</span></dt><dd><dl class="simple">
<dt>a string indicating some flags that specify what kind of file this is; some examples include:</dt><dd><ul class="simple">
<li><p>csv = comma separated file (sets delimiter = ',')</p></li>
<li><p>tab or tsv = tab delimited file (sets delimiter = '       ')</p></li>
<li><p>pipe = pipe delimited file (sets delimiter = '|')</p></li>
<li><p>latex = latex-style table data (sets delimiter = ' &amp; ')</p></li>
<li><p>waveheader = wavelength solution is contained within the fits header</p></li>
<li><p>wavelog = wavelength solution is logarithmic (common for echelle data)</p></li>
<li><p>sdss = sets both waveheader and wavelog</p></li>
</ul>
</dd>
</dl>
</dd>
<dt><strong>wave_unit = DEFAULT_WAVE_UNIT</strong><span class="classifier">astropy.unit [optional]</span></dt><dd><p>units of wavelength axis, by default specified by the DEFAULT_WAVE_UNIT global parameter</p>
</dd>
<dt><strong>flux_unit = DEFAULT_FLUX_UNIT</strong><span class="classifier">astropy.unit [optional]</span></dt><dd><p>units of flux and uncertainty axes, by default specified by the DEFAULT_FLUX_UNIT global parameter
note that you can specify a unitless number</p>
</dd>
<dt><strong>dimensionless = False</strong><span class="classifier">boolean [optional]</span></dt><dd><p>set to True to set the flux units to a dimensionless quantity (for transmission, reflectance)</p>
</dd>
<dt><strong>comment = '#'</strong><span class="classifier">string [optional]</span></dt><dd><p>for ascii files, character that indicates the file line is a comment (to be ignored)</p>
</dd>
<dt><strong>delimiter = ''</strong><span class="classifier">string [optional]</span></dt><dd><p>for ascii files, character that separates columns of values</p>
</dd>
<dt><strong>crval1,cdelt1 = 'CRVAL1','CDELT1'</strong><span class="classifier">string [optional]</span></dt><dd><p>for fits files for which the wavelength solution is embedded in header,
these are the keywords containing the zeroth wavelength and linear change coefficient</p>
</dd>
<dt><strong>catch_sn = True</strong><span class="classifier">boolean [optional]</span></dt><dd><p>set to True to check if uncertainty axis is actually signal-to-noise,
by checking if median(flux/uncertainty) &lt; 1 [NOTE: NO LONGER IMPLEMENTED]</p>
</dd>
<dt><strong>remove_nans = True</strong><span class="classifier">boolean [optional]</span></dt><dd><p>set to True to remove all wave/flux/noise values for which wave or flux are nan</p>
</dd>
<dt><strong>no_zero_noise = True</strong><span class="classifier">boolean [optional]</span></dt><dd><p>set to True to set all elements of noise array that are zero to numpy.nan;
this helps in later computations of S/N or fit statistics</p>
</dd>
<dt><strong>use_instrument_reader = True</strong><span class="classifier">bool [optional]</span></dt><dd><p>set to True to use the default instrument read in the DEFAULT-INSTRUMENT global parameter
checked against INSTRUMENTS dictionary</p>
</dd>
<dt><strong>instrument = DEFAULT_INSTRUMENT</strong><span class="classifier">string [optional]</span></dt><dd><p>instrument by which data was acquired, by default the DEFAULT-INSTRUMENT global parameter
checked against INSTRUMENTS dictionary</p>
</dd>
<dt><strong>instrument_param = {}</strong><span class="classifier">dict [optional]</span></dt><dd><p>instrument-specific parameters to pass to instrument reader</p>
</dd>
<dt><strong>verbose = False</strong><span class="classifier">boolean [optional]</span></dt><dd><p>set to True to have program return verbose output</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.weightedMeanVar">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">weightedMeanVar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">winp</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.weightedMeanVar" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Computes weighted mean of an array of values through various methods. Returns weighted mean and weighted uncertainty.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param <strong>vals</strong><span class="colon">:</span></dt>
<dd class="field-odd"><p>array of values</p>
</dd>
<dt class="field-even">param <strong>winp</strong><span class="colon">:</span></dt>
<dd class="field-even"><p>array of weights associated with <code class="docutils literal notranslate"><span class="pre">vals</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param <strong>method</strong><span class="colon">:</span></dt>
<dd class="field-odd"><p>type of weighting to be used. Options include:</p>
<ul class="simple">
<li><p><em>default</em>: (default) <code class="docutils literal notranslate"><span class="pre">winp</span></code> is taken to be actual weighting values</p></li>
<li><p><em>uncertainty</em>: uncertainty weighting, where <code class="docutils literal notranslate"><span class="pre">winp</span></code> is the uncertainties of <code class="docutils literal notranslate"><span class="pre">vals</span></code></p></li>
<li><p><em>ftest</em>: ftest weighting, where <code class="docutils literal notranslate"><span class="pre">winp</span></code> is the chi squared values of <code class="docutils literal notranslate"><span class="pre">vals</span></code></p></li>
</ul>
</dd>
<dt class="field-even">param <strong>weight_minimum</strong><span class="colon">:</span></dt>
<dd class="field-even"><p>minimum possible weight value (default = 0.)</p>
</dd>
<dt class="field-odd">param <strong>dof</strong><span class="colon">:</span></dt>
<dd class="field-odd"><p>effective degrees of freedom (default = len(vals) - 1)</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">ftest</span></code> method, extra <code class="docutils literal notranslate"><span class="pre">dof</span></code> value is required</p>
</div>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>Weighted mean and uncertainty</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">weightedMeanVar</span><span class="p">([</span><span class="mf">3.52</span><span class="p">,</span> <span class="mf">5.88</span><span class="p">,</span> <span class="mf">9.03</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.19</span><span class="p">])</span>
<span class="go">    (5.0057009345794379, 4.3809422657000594)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">weightedMeanVar</span><span class="p">([</span><span class="mf">3.52</span><span class="p">,</span> <span class="mf">5.88</span><span class="p">,</span> <span class="mf">9.03</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.24</span><span class="p">,</span> <span class="mf">2.09</span><span class="p">,</span> <span class="mf">2.29</span><span class="p">],</span> <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;uncertainty&#39;</span><span class="p">)</span>
<span class="go">    (5.0069199363443841, 4.3914329968409946)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.isNumber">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">isNumber</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.isNumber" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Checks if something is a number.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>s</strong> (<em>required</em>) -- object to be checked</p>
</dd>
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>True or False</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">isNumber</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">    True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">isNumber</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
<span class="go">    False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.isUnit">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">isUnit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.isUnit" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Checks if something is an astropy unit quantity; written in response to the
many ways that astropy now codes unit quantities</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param s<span class="colon">:</span></dt>
<dd class="field-odd"><p>quantity to be checked</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>True or False</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">isUnit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">    False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">isUnit</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
<span class="go">    True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">isUnit</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
<span class="go">    True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">splat</span><span class="o">.</span><span class="n">isUnit</span><span class="p">((</span><span class="mf">3.</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="go">    False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.numberList">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">numberList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">numstr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.numberList" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Convert a string listing of numbers into an array of numbers</p>
</dd>
<dt class="field-even">Required Input<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param <strong>numstr</strong><span class="colon">:</span></dt>
<dd class="field-odd"><p>string indicating number list, e.g., '45,50-67,69,72-90'</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Input<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param <strong>sort</strong><span class="colon">:</span></dt>
<dd class="field-odd"><p>set to True to sort output list (default = False)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>list of integers specified by string</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">numberList</span><span class="p">(</span><span class="s1">&#39;45,50-67,69,72-90&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">    [45, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 69,</span>
<span class="go">    72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90]</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.randomSphereAngles">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">randomSphereAngles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">longitude_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">6.283185307179586]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latitude_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[-1.5707963267948966,</span> <span class="pre">1.5707963267948966]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_longitude_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_latitude_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degrees</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.randomSphereAngles" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Draw a set of angles from a uniform spherical distribution, with areal inclusion and exclusion constraints.
Note that latitude range is assumed to run from -pi/2 to +pi/2</p>
</dd>
<dt class="field-even">Required Input<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param num<span class="colon">:</span></dt>
<dd class="field-odd"><p>number of points to draw</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Input<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>longitude_range = [0,2pi]: range over longitude to draw values</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>latitude_range = [-pi,+pi]: range over latitude to draw values</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>exclude_longitude_range = []: range of longitudes to exclude values</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>exclude_latitude_range = []: range of latitudes to exclude values</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>degrees = False: by default, radians are assumed; set to True to convert to degrees (also checks if inclusion/exclusion ranges are in degrees)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>2 arrays of longitudes and latitudes drawn uniformly over select area</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">randomSphereAngles</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">    (array([ 2.52679013,  0.85193769,  5.98514797,  0.89943465,  5.36310536,</span>
<span class="go">     5.34344768,  0.01743906,  4.93856229,  0.06508084,  0.5517308 ]),</span>
<span class="go">    array([-0.53399501,  0.04208564,  0.03089855, -0.60445954,  0.55800151,</span>
<span class="go">     0.80119146, -0.19318715,  0.76230148, -0.5935969 , -0.65839849]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">randomSphereAngles</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="n">latitude_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">    (array([  28.55709202,  297.34760719,  152.79525894,   71.08745583,</span>
<span class="go">             153.56948338,   80.68486463,    7.75479896,  100.8408509 ,</span>
<span class="go">             356.63091754,   66.16572906]),</span>
<span class="go">     array([ 0.6747939 , -1.00316889, -2.26239023,  9.27397372, -8.96797181,</span>
<span class="go">             7.34796163, -1.93175289,  3.07888912,  0.69826684, -5.08428339]))</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</section>
<section id="i-o-routines">
<h3>I/O Routines<a class="headerlink" href="#i-o-routines" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.checkOnline">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">checkOnline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.checkOnline" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Checks if SPLAT's URL is accessible from your machine--
that is, checks if you and the host are online. Alternately
checks if a given filename is present locally or online</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spl</span><span class="o">.</span><span class="n">checkOnline</span><span class="p">()</span>
<span class="go">True  # SPLAT&#39;s URL was detected.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spl</span><span class="o">.</span><span class="n">checkOnline</span><span class="p">()</span>
<span class="go">False # SPLAT&#39;s URL was not detected.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spl</span><span class="o">.</span><span class="n">checkOnline</span><span class="p">(</span><span class="s1">&#39;SpectralModels/BTSettl08/parameters.txt&#39;</span><span class="p">)</span>
<span class="go">&#39;&#39; # Could not find this online file.</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.checkOnlineFile">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">checkOnlineFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.checkOnlineFile" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Checks if SPLAT's URL is accessible from your machine--
that is, checks if you and the host are online. Alternately
checks if a given filename is present locally or online</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spl</span><span class="o">.</span><span class="n">checkOnlineFile</span><span class="p">(</span><span class="s1">&#39;SpectralModels/BTSettl08/parameters.txt&#39;</span><span class="p">)</span>
<span class="go">&#39;&#39; # Could not find this online file.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spl</span><span class="o">.</span><span class="n">checkOnlineFile</span><span class="p">()</span>
<span class="go">&#39;&#39; # SPLAT&#39;s URL was not detected; you are not online.</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.checkFile">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">checkFile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.checkFile" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Checks if a spectrum file exists in the SPLAT's library.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>filename</strong> -- A string containing the spectrum's filename.</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spectrum1</span> <span class="o">=</span> <span class="s1">&#39;spex_prism_1315+2334_110404.fits&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">spl</span><span class="o">.</span><span class="n">checkFile</span><span class="p">(</span><span class="n">spectrum1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spectrum2</span> <span class="o">=</span> <span class="s1">&#39;fake_name.fits&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">spl</span><span class="o">.</span><span class="n">checkFile</span><span class="p">(</span><span class="n">spectrum2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.checkLocal">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">checkLocal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.checkLocal" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Checks if a file is present locally or within the SPLAT
code directory</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spl</span><span class="o">.</span><span class="n">checkLocal</span><span class="p">(</span><span class="s1">&#39;spl.py&#39;</span><span class="p">)</span>
<span class="go">True  # found the code</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spl</span><span class="o">.</span><span class="n">checkLocal</span><span class="p">(</span><span class="s1">&#39;parameters.txt&#39;</span><span class="p">)</span>
<span class="go">False  # can&#39;t find this file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spl</span><span class="o">.</span><span class="n">checkLocal</span><span class="p">(</span><span class="s1">&#39;SpectralModels/BTSettl08/parameters.txt&#39;</span><span class="p">)</span>
<span class="go">True  # found it</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="modeling-and-simulation-routines">
<h2>Modeling and Simulation Routines<a class="headerlink" href="#modeling-and-simulation-routines" title="Link to this heading">¶</a></h2>
<section id="spectral-modeling-routines">
<h3>Spectral Modeling Routines<a class="headerlink" href="#spectral-modeling-routines" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="splat.model.getModel">
<span class="sig-prename descclassname"><span class="pre">splat.model.</span></span><span class="sig-name descname"><span class="pre">getModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.model.getModel" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Purpose:</dt><dd><p>Redundant routine with <a class="reference external" href="api.html#splat_model.loadModel">loadModel()</a> to match syntax of <a class="reference external" href="api.html#splat.getSpectrum">getSpectrum()</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.model.loadModel">
<span class="sig-prename descclassname"><span class="pre">splat.model.</span></span><span class="sig-name descname"><span class="pre">loadModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modelset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'btsettl08'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SPEX-PRISM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.model.loadModel" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Purpose:</dt><dd><p>Loads up a model spectrum based on a set of input parameters. The models may be any one of the following listed below. For parameters between the model grid points, loadModel calls the function <a class="reference external" href="api.html#splat_model._loadInterpolatedModel">_loadInterpolatedModel()</a>.</p>
</dd>
</dl>
<dl class="simple">
<dt>Required Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong>: The model set to use; may be one of the following:</p>
<ul class="simple">
<li><p><em>nextgen99</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012RSPTA.370.2765A">Allard et al. (1999)</a>  with effective temperatures of 900 to 1600 K (steps of 100 K); surface gravities of 5.0 and 5.5 in units of cm/s^2; and metallicity fixed to solar (alternate designations: <cite>nextgen</cite>)</p></li>
<li><p><em>cond01</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2001ApJ...556..357A">Allard et al. (2001)</a>  with effective temperatures of 100 to 4000 K (steps of 100 K); surface gravities of 4.0 to 6.0 in units of cm/s^2 (steps of 0.5 dex); and metallicity fixed to solar; with condensate species removed from the photosphere (alternate designation: <cite>cond</cite>)</p></li>
<li><p><em>dusty01</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2001ApJ...556..357A">Allard et al. (2001)</a>  with effective temperatures of 500 to 3000 K (steps of 100 K); surface gravities of 3.5 to 6.0 in units of cm/s^2 (steps of 0.5 dex); and metallicity fixed to solar; with condensate species left in situ (alternate designation: <cite>dusty</cite>)</p></li>
<li><p><em>burrows06</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2006ApJ...640.1063B">Burrows et al. (2006)</a> with effective temperatures of 700 to 2000 K (steps of 50 K); surface gravities of 4.5 to 5.5 in units of cm/s^2 (steps of 0.1 dex); metallicity of -0.5, 0.0 and 0.5; and either no clouds or grain size 100 microns (fsed = 'nc' or 'f100'). equilibrium chemistry is assumed. Note that this grid is not completely filled and some gaps have been interpolated (alternate designations: <cite>burrows</cite>, <cite>burrows2006</cite>)</p></li>
<li><p><em>btsettl08</em>: (default) model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012RSPTA.370.2765A">Allard et al. (2012)</a>  with effective temperatures of 400 to 2900 K (steps of 100 K); surface gravities of 3.5 to 5.5 in units of cm/s^2 (steps of 0.5 dex); and metallicity of -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.3, and 0.5 for temperatures greater than 2000 K only; cloud opacity is fixed in this model, and equilibrium chemistry is assumed. Note that this grid is not completely filled and some gaps have been interpolated (alternate designations: <cite>btsettled</cite>, <cite>btsettl</cite>, <cite>allard</cite>, <cite>allard12</cite>)</p></li>
<li><p><em>btsettl15</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2015A&amp;A...577A..42B">Allard et al. (2015)</a>  with effective temperatures of 1200 to 6300 K (steps of 100 K); surface gravities of 2.5 to 5.5 in units of cm/s^2 (steps of 0.5 dex); and metallicity fixed to solar (alternate designations: 'allard15','allard2015','btsettl015','btsettl2015','BTSettl2015')</p></li>
<li><p><em>morley12</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...756..172M">Morley et al. (2012)</a> with effective temperatures of 400 to 1300 K (steps of 50 K); surface gravities of 4.0 to 5.5 in units of cm/s^2 (steps of 0.5 dex); and sedimentation efficiency (fsed) of 2, 3, 4 or 5; metallicity is fixed to solar, equilibrium chemistry is assumed, and there are no clouds associated with this model (alternate designations: <cite>morley2012</cite>)</p></li>
<li><p><em>morley14</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2014ApJ...787...78M">Morley et al. (2014)</a> with effective temperatures of 200 to 450 K (steps of 25 K) and surface gravities of 3.0 to 5.0 in units of cm/s^2 (steps of 0.5 dex); metallicity is fixed to solar, equilibrium chemistry is assumed, sedimentation efficiency is fixed at fsed = 5, and cloud coverage fixed at 50% (alternate designations: <cite>morley2014</cite>)</p></li>
<li><p><em>saumon12</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...750...74S">Saumon et al. (2012)</a> with effective temperatures of 400 to 1500 K (steps of 50 K); and surface gravities of 3.0 to 5.5 in units of cm/s^2 (steps of 0.5 dex); metallicity is fixed to solar, equilibrium chemistry is assumed, and no clouds are associated with these models (alternate designations: <cite>saumon</cite>, <cite>saumon2012</cite>)</p></li>
<li><p><em>drift</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2011A%26A...529A..44W">Witte et al. (2011)</a> with effective temperatures of 1700 to 3000 K (steps of 50 K); surface gravities of 5.0 and 5.5 in units of cm/s^2; and metallicities of -3.0 to 0.0 (in steps of 0.5 dex); cloud opacity is fixed in this model, equilibrium chemistry is assumed (alternate designations: <cite>witte</cite>, <cite>witte2011</cite>, <cite>helling</cite>)</p></li>
<li><p><em>madhusudhan11</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2011ApJ...737...34M">Madhusudhan et al. (2011)</a> with effective temperatures of 600 K to 1700 K (steps of 50-100 K); surface gravities of 3.5 and 5.0 in units of cm/s^2; and metallicities of 0.0 to 1.0 (in steps of 0.5 dex); there are multiple cloud prescriptions for this model, equilibrium chemistry is assumed (alternate designations: <cite>madhusudhan</cite>)</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Optional Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>teff</strong>: effective temperature of the model in K (e.g. <cite>teff</cite> = 1000)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>logg</strong>: log10 of the surface gravity of the model in cm/s^2 units (e.g. <cite>logg</cite> = 5.0)</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>z</strong>: log10 of metallicity of the model relative to solar metallicity (e.g. <cite>z</cite> = -0.5)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fsed</strong>: sedimentation efficiency of the model (e.g. <cite>fsed</cite> = 'f2')</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cld</strong>: cloud shape function of the model (e.g. <cite>cld</cite> = 'f50')</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>kzz</strong>: vertical eddy diffusion coefficient of the model (e.g. <cite>kzz</cite> = 2)</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>slit</strong>: slit weight of the model in arcseconds (e.g. <cite>slit</cite> = 0.3)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>sed</strong>: if set to True, returns a broad-band spectrum spanning 0.3-30 micron (applies only for BTSettl2008 models with Teff &lt; 2000 K)</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>folder</strong>: string of the folder name containing the model set (default = '')</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>filename</strong>: string of the filename of the desired model; should be a space-delimited file containing columns for wavelength (units of microns) and surface flux (F_lambda units of erg/cm^2/s/micron) (default = '')</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>force</strong>: force the filename to be exactly as specified</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>fast</strong>: set to True to do a fast interpolation if needed, only for Teff and logg (default = False)</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>url</strong>: string of the url to the SPLAT website (default = '<a class="reference external" href="http://www.browndwarfs.org/splat/">http://www.browndwarfs.org/splat/</a>')</p>
</dd>
</dl>
</dd>
<dt>Output:</dt><dd><p>A SPLAT Spectrum object of the interpolated model with wavelength in microns and surface fluxes in F_lambda units of erg/cm^2/s/micron.</p>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mdl</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">loadModel</span><span class="p">(</span><span class="n">teff</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">logg</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mdl</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go">    BTSettl2008 model with the following parmeters:</span>
<span class="go">    Teff = 1000 K</span>
<span class="go">    logg = 5.0 cm/s2</span>
<span class="go">    z = 0.0</span>
<span class="go">    fsed = nc</span>
<span class="go">    cld = nc</span>
<span class="go">    kzz = eq</span>
<span class="go">    Smoothed to slit width 0.5 arcseconds</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mdl</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">loadModel</span><span class="p">(</span><span class="n">teff</span><span class="o">=</span><span class="mi">2500</span><span class="p">,</span><span class="n">logg</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;burrows&#39;</span><span class="p">)</span>
<span class="go">    Input value for teff = 2500 out of range for model set burrows06</span>
<span class="go">    Warning: Creating an empty Spectrum object</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.model.loadOriginalModel">
<span class="sig-prename descclassname"><span class="pre">splat.model.</span></span><span class="sig-name descname"><span class="pre">loadOriginalModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'btsettl08'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'UNKNOWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.model.loadOriginalModel" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Loads up an original model spectrum at full resolution/spectral range, based on filename or model parameters.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong>: The model set to use; may be one of the following:</p>
<ul class="simple">
<li><p><em>btsettl08</em>: (default) model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012RSPTA.370.2765A">Allard et al. (2012)</a>  with effective temperatures of 400 to 2900 K (steps of 100 K); surface gravities of 3.5 to 5.5 in units of cm/s^2 (steps of 0.5 dex); and metallicity of -3.0, -2.5, -2.0, -1.5, -1.0, -0.5, 0.0, 0.3, and 0.5 for temperatures greater than 2000 K only; cloud opacity is fixed in this model, and equilibrium chemistry is assumed. Note that this grid is not completely filled and some gaps have been interpolated (alternate designations: <cite>btsettled</cite>, <cite>btsettl</cite>, <cite>allard</cite>, <cite>allard12</cite>)</p></li>
<li><p><em>burrows06</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2006ApJ...640.1063B">Burrows et al. (2006)</a> with effective temperatures of 700 to 2000 K (steps of 50 K); surface gravities of 4.5 to 5.5 in units of cm/s^2 (steps of 0.1 dex); metallicity of -0.5, 0.0 and 0.5; and either no clouds or grain size 100 microns (fsed = 'nc' or 'f100'). equilibrium chemistry is assumed. Note that this grid is not completely filled and some gaps have been interpolated (alternate designations: <cite>burrows</cite>, <cite>burrows2006</cite>)</p></li>
<li><p><em>morley12</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...756..172M">Morley et al. (2012)</a> with effective temperatures of 400 to 1300 K (steps of 50 K); surface gravities of 4.0 to 5.5 in units of cm/s^2 (steps of 0.5 dex); and sedimentation efficiency (fsed) of 2, 3, 4 or 5; metallicity is fixed to solar, equilibrium chemistry is assumed, and there are no clouds associated with this model (alternate designations: <cite>morley2012</cite>)</p></li>
<li><p><em>morley14</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2014ApJ...787...78M">Morley et al. (2014)</a> with effective temperatures of 200 to 450 K (steps of 25 K) and surface gravities of 3.0 to 5.0 in units of cm/s^2 (steps of 0.5 dex); metallicity is fixed to solar, equilibrium chemistry is assumed, sedimentation efficiency is fixed at fsed = 5, and cloud coverage fixed at 50% (alternate designations: <cite>morley2014</cite>)</p></li>
<li><p><em>saumon12</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...750...74S">Saumon et al. (2012)</a> with effective temperatures of 400 to 1500 K (steps of 50 K); and surface gravities of 3.0 to 5.5 in units of cm/s^2 (steps of 0.5 dex); metallicity is fixed to solar, equilibrium chemistry is assumed, and no clouds are associated with these models (alternate designations: <cite>saumon</cite>, <cite>saumon2012</cite>)</p></li>
<li><p><em>drift</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2011A%26A...529A..44W">Witte et al. (2011)</a> with effective temperatures of 1700 to 3000 K (steps of 50 K); surface gravities of 5.0 and 5.5 in units of cm/s^2; and metallicities of -3.0 to 0.0 (in steps of 0.5 dex); cloud opacity is fixed in this model, equilibrium chemistry is assumed (alternate designations: <cite>witte</cite>, <cite>witte2011</cite>, <cite>helling</cite>)</p></li>
<li><p><em>madhusudhan</em>: model set from <a class="reference external" href="http://adsabs.harvard.edu/abs/2011ApJ...737...34M">Madhusudhan et al. (2011)</a> with effective temperatures of 600 K to 1700 K (steps of 50-100 K); surface gravities of 3.5 and 5.0 in units of cm/s^2; and metallicities of 0.0 to 1.0 (in steps of 0.5 dex); there are multiple cloud prescriptions for this model, equilibrium chemistry is assumed (alternate designations: <cite>madhusudhan</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>teff</strong>: effective temperature of the model in K (e.g. <cite>teff</cite> = 1000)</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>logg</strong>: log10 of the surface gravity of the model in cm/s^2 units (e.g. <cite>logg</cite> = 5.0)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>z</strong>: log10 of metallicity of the model relative to solar metallicity (e.g. <cite>z</cite> = -0.5)</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fsed</strong>: sedimentation efficiency of the model (e.g. <cite>fsed</cite> = 'f2')</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cld</strong>: cloud shape function of the model (e.g. <cite>cld</cite> = 'f50')</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kzz</strong>: vertical eddy diffusion coefficient of the model (e.g. <cite>kzz</cite> = 2)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>instrument</strong>: instrument the model should be converted to (default = 'raw')</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong>: file name for model (default = '' or generated from parameters)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>folder</strong>: folder containing file (default = '' or default folder for model set)</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>verbose</strong>: give lots of feedback</p>
</dd>
</dl>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>A SPLAT Spectrum object of the model with wavelength in microns and surface fluxes in F_lambda units of erg/cm^2/s/micron.</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mdl</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">loadOriginalModel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;btsettl&#39;</span><span class="p">,</span><span class="n">teff</span><span class="o">=</span><span class="mi">2600</span><span class="p">,</span><span class="n">logg</span><span class="o">=</span><span class="mf">4.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mdl</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go">    btsettl08 Teff=2600 logg=4.5 [M/H]=0.0 atmosphere model with the following parmeters:</span>
<span class="go">    Teff = 2600 K</span>
<span class="go">    logg = 4.5 dex</span>
<span class="go">    z = 0.0 dex</span>
<span class="go">    fsed = nc</span>
<span class="go">    cld = nc</span>
<span class="go">    kzz = eq</span>
</pre></div>
</div>
<blockquote>
<div><p>If you use this model, please cite Allard, F. et al. (2012, Philosophical Transactions of the Royal Society A, 370, 2765-2777)
bibcode = 2012RSPTA.370.2765A</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.model.loadTelluric">
<span class="sig-prename descclassname"><span class="pre">splat.model.</span></span><span class="sig-name descname"><span class="pre">loadTelluric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wave_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'transmission'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'eso'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.model.loadTelluric" title="Link to this definition">¶</a></dt>
<dd><p>Purpose:</p>
<blockquote>
<div><p>Loads up telluric absorption spectrum from <a class="reference external" href="http://adsabs.harvard.edu/abs/1991aass.book.....L">Livingston and Wallace (1991)</a></p>
</div></blockquote>
<p>Required Inputs:</p>
<blockquote>
<div><p>A wavelength array must be input in one of the following manners:</p>
<blockquote>
<div><ul class="simple">
<li><p>as an list passed as an argument <code class="docutils literal notranslate"><span class="pre">wave</span></code>; e.g., loadTelluric(wave)</p></li>
<li><p>by specifying the min and max wavelengths with <code class="docutils literal notranslate"><span class="pre">wave_range</span></code> and number of points with <code class="docutils literal notranslate"><span class="pre">ndata</span></code>; e.g., loadTelluric(wave_range=[1.3,1.5],ndata=100)</p></li>
</ul>
</div></blockquote>
</div></blockquote>
<p>Optional Inputs:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>linear</strong>: linear sampling over <code class="docutils literal notranslate"><span class="pre">wave_range</span></code> (default = True)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>log</strong>: log-linear sampling over <code class="docutils literal notranslate"><span class="pre">wave_range</span></code> (default = False)</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>folder</strong>: set to folder containing the Livingston and Wallace files (default = SPLAT's reference folder)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>output</strong>: set to one of the following possible outputs:
- <code class="docutils literal notranslate"><span class="pre">transmission</span></code> (default) - a numpy array containing the transmission spectrum
- <code class="docutils literal notranslate"><span class="pre">spectrum</span></code> - a Spectrum object containing the transmission spectrum</p>
</dd>
</dl>
</div></blockquote>
<p>Output:</p>
<blockquote>
<div><p>Either a numpy array or Spectrum object containing the transmission spectrum sampled
over the wavelength range provided, with values ranging from 0 to 1</p>
</div></blockquote>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.model</span> <span class="k">as</span> <span class="nn">spmdl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trans</span> <span class="o">=</span> <span class="n">spmdl</span><span class="o">.</span><span class="n">loadTelluric</span><span class="p">(</span><span class="n">wave_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1.3</span><span class="p">,</span><span class="mf">1.5</span><span class="p">],</span><span class="n">ndata</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">trans</span><span class="p">)</span>
<span class="go">    [  9.89881739e-01   9.77062180e-01   9.64035135e-01   1.00051461e+00</span>
<span class="go">       9.96495927e-01   9.96135086e-01   9.97309832e-01   9.17222383e-01</span>
<span class="go">       8.20866597e-01   9.24702335e-01   9.97319517e-01   9.97450808e-01</span>
<span class="go">       8.98421113e-01   9.98372247e-01   9.60017183e-01   9.98449332e-01</span>
<span class="go">       9.94087424e-01   9.52683627e-01   9.87684348e-01   7.75109019e-01</span>
<span class="go">       9.76381023e-01   9.89867274e-01   8.71284143e-01   8.79453464e-01</span>
<span class="go">       8.85513893e-01   9.96684751e-01   9.89084643e-01   9.80117987e-01</span>
<span class="go">       9.85237657e-01   9.93525954e-01   9.95844421e-01   7.88396747e-01</span>
<span class="go">       9.82524939e-01   9.98155509e-01   9.96245824e-01   9.55002105e-01   ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trans</span> <span class="o">=</span> <span class="n">spmdl</span><span class="o">.</span><span class="n">loadTelluric</span><span class="p">(</span><span class="n">wave_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1.3</span><span class="p">,</span><span class="mf">1.5</span><span class="p">],</span><span class="n">ndata</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trans</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go">    Telluric transmission spectrum</span>
</pre></div>
</div>
<blockquote>
<div><p>If you use these data, please cite Livingston, W. &amp; Wallace, L. (1991, UNKNOWN, , )
bibcode = 1991aass.book.....L</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.model.blackbody">
<span class="sig-prename descclassname"><span class="pre">splat.model.</span></span><span class="sig-name descname"><span class="pre">blackbody</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.model.blackbody" title="Link to this definition">¶</a></dt>
<dd><p>This program is still in development</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.model.modelFitGrid">
<span class="sig-prename descclassname"><span class="pre">splat.model.</span></span><span class="sig-name descname"><span class="pre">modelFitGrid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">specin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modelset='btsettl08'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument=''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbest=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">statistic='chisqr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output='fit'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius=&lt;Quantity</span> <span class="pre">0.1</span> <span class="pre">solRad&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_tolerance=&lt;Quantity</span> <span class="pre">0.01</span> <span class="pre">solRad&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius_model=''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_radius=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_radius=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.model.modelFitGrid" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Fits a spectrum to a grid of atmosphere models, reports the best-fit and weighted average parameters,
and returns either a dictionary with the best-fit model parameters or the model itself scaled to the optimal scaling factor.
If spectrum is absolutely flux calibrated with the <a class="reference external" href="api.html#splat.Spectrum.fluxCalibrate">fluxcalibrate()</a> method, the routine will also calculate
the equivalent radii of the source. In addition, an input radius can be used to provide an additional constraint on the model</p>
</dd>
</dl>
<p>Required inputs:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>spec</strong> -- a Spectrum class object, which should contain wave, flux and noise array elements.</p>
</dd>
</dl>
<p>Optional inputs:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> -- set of models to use (<code class="docutils literal notranslate"><span class="pre">set</span></code> and <code class="docutils literal notranslate"><span class="pre">model_set</span></code> may also be used), from the available models given by <a class="reference external" href="api.html#splat_model.loadModel">loadModel()</a>.</p></li>
<li><p><strong>stat</strong> -- the statistic to use for comparing models to spectrum; can be any one of the statistics allowed in <a class="reference external" href="api.html#splat.compareSpectra">compareSpectra()</a> routine (default = <cite>chisqr</cite>)</p></li>
<li><p><strong>nbest</strong> -- sets the number of best-fit models to return (default = 1)</p></li>
<li><p><strong>weights</strong> -- an array of the same length as the spectrum flux array, specifying the weight for each pixel (default: equal weighting)</p></li>
<li><p><strong>mask</strong> -- an array of the same length as the spectrum flux array, specifying which data to include in comparison statistic as coded by 0 = good data, 1 = bad (masked). The routine <a class="reference external" href="api.html#splat.generateMask">generateMask()</a> is called to create a mask, so parameters from that routine may be specified (default: no masking)</p></li>
<li><p><strong>compute_radius</strong> -- if set to True, force the computation of the radius based on the model scaling factor. This is automatically set to True if the input spectrum is absolutely flux calibrated (default = False)</p></li>
<li><p><strong>teff_range</strong> -- set to the range of temperatures over which model fitting will be done (<code class="docutils literal notranslate"><span class="pre">temperature_range</span></code> and <code class="docutils literal notranslate"><span class="pre">t_range</span></code> may also be used; default = full range of model temperatures)</p></li>
<li><p><strong>logg_range</strong> -- set to the range of surface gravities over which model fitting will be done (<code class="docutils literal notranslate"><span class="pre">gravity_range</span></code> and <code class="docutils literal notranslate"><span class="pre">g_range</span></code> may also be used; default = full range of model temperatures)</p></li>
<li><p><strong>z_range</strong> -- set to the range of metallicities over which model fitting will be done (<code class="docutils literal notranslate"><span class="pre">metallicity_range</span></code> may also be used; default = full range of model temperatures)</p></li>
<li><p><strong>return_model</strong> -- set to True to return a Spectrum class of the best-fit model instead of a dictionary of parameters (default = False)</p></li>
<li><p><strong>return_mean_parameters</strong> -- set to True a dictionary of mean parameters (default = False)</p></li>
<li><p><strong>return_all_parameters</strong> -- set to True to return all of the parameter sets and fitting values (default = False)</p></li>
<li><p><strong>summary</strong> -- set to True to report a summary of results (default = True)</p></li>
<li><p><strong>output</strong> -- a string containing the base filename for outputs associated with this fitting routine (<code class="docutils literal notranslate"><span class="pre">file</span></code> and <code class="docutils literal notranslate"><span class="pre">filename</span></code> may also be used; default = 'fit')</p></li>
<li><p><strong>plot</strong> -- set to True to suppress plotting outputs (default = False)</p></li>
<li><p><strong>plot_format</strong> -- specifes the file format for output plots (default = <cite>pdf</cite>)</p></li>
<li><p><strong>file_best_comparison</strong> -- filename to use for plotting spectrum vs. best-fit model (default = '<code class="docutils literal notranslate"><span class="pre">OUTPUT``_best_comparison.``PLOT_FORMAT</span></code>')</p></li>
<li><p><strong>file_mean_comparison</strong> -- filename to use for plotting spectrum vs. mean parameter model (default = '<code class="docutils literal notranslate"><span class="pre">OUTPUT``_mean_comparison.``PLOT_FORMAT</span></code>')</p></li>
</ul>
</dd>
</dl>
<p>In addition, the parameters for <a class="reference external" href="api.html#splat.compareSpectra">compareSpectra()</a> , <a class="reference external" href="api.html#splat.generateMask">generateMask()</a> and <a href="#id154"><span class="problematic" id="id155">`plotSpectrum()`_</span></a> may be used; see SPLAT API for details.</p>
<p>Output:</p>
<p>Default output is a dictionary containing the best-fit model parameters: model name, teff, logg, z, fsed, kzz, cloud and slit, as well as the scaling factor for the model and comparison statistic.
If the input spectrum is absolutely flux calibrated, radius is also returned.  Alternate outputs include:</p>
<blockquote>
<div><ul class="simple">
<li><p>a dictionary of the statistic-weighted mean parameters (<code class="docutils literal notranslate"><span class="pre">return_mean_parameters</span></code> = True)</p></li>
<li><p>a list of dictionaries containing all parameters and fit statistics (<code class="docutils literal notranslate"><span class="pre">return_all_parameters</span></code> = True)</p></li>
<li><p>a Spectrum class of the best-fit model scaled to the best-fit scaling (<code class="docutils literal notranslate"><span class="pre">return_model</span></code> = True)</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.model</span> <span class="k">as</span> <span class="nn">spmod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1507-1627&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span><span class="o">.</span><span class="n">fluxCalibrate</span><span class="p">(</span><span class="s1">&#39;2MASS J&#39;</span><span class="p">,</span><span class="mf">12.32</span><span class="p">,</span><span class="n">absolute</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">spmod</span><span class="o">.</span><span class="n">modelFitGrid</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">teff_range</span><span class="o">=</span><span class="p">[</span><span class="mi">1200</span><span class="p">,</span><span class="mi">2500</span><span class="p">],</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;Saumon&#39;</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;fit1507&#39;</span><span class="p">)</span>
<span class="go">    Best Parameters to fit to BT-Settl (2008) models:</span>
<span class="go">        $T_{eff}$=1800.0 K</span>
<span class="go">        $log g$=5.0 dex(cm / s2)</span>
<span class="go">        $[M/H]$=-0.0 dex</span>
<span class="go">        $f_{sed}$=nc</span>
<span class="go">        $cld$=nc</span>
<span class="go">        $log \kappa_{zz}$=eq dex(cm2 / s)</span>
<span class="go">        R=0.143324498969 solRad</span>
<span class="go">        chi=4500.24997585</span>
<span class="go">    Mean Parameters:</span>
<span class="go">        $T_{eff}$: 1800.0+/-0.0 K</span>
<span class="go">        $log g$: 5.0+/-0.0 dex(cm / s2)</span>
<span class="go">        Radius: 0.143324498969+/-0.0 solRad</span>
<span class="go">        $[M/H]$: 0.0+/-0.0 dex</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.model.modelFitMCMC">
<span class="sig-prename descclassname"><span class="pre">splat.model.</span></span><span class="sig-name descname"><span class="pre">modelFitMCMC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">specin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">modelset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BTSettl2008'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SPEX-PRISM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showRadius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.model.modelFitMCMC" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Uses Metropolis-Hastings Markov Chain Monte Carlo method to compare a spectrum to
atmosphere models. Returns the best estimate of whatever parameters are allowed to
vary; can also compute the radius based on the scaling factor.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>spec</strong> -- Spectrum class object, which should contain wave, flux and noise array elements (required)</p></li>
<li><p><strong>nsamples</strong> -- number of MCMC samples (optional, default = 1000)</p></li>
<li><p><strong>burn</strong> -- the decimal fraction (0 to 1) of the initial steps to be discarded (optional; default = 0.1; alternate keywords <code class="docutils literal notranslate"><span class="pre">initial_cut</span></code>)</p></li>
<li><p><strong>set</strong> -- set of models to use; see loadModel for list (optional; default = 'BTSettl2008'; alternate keywords <code class="docutils literal notranslate"><span class="pre">model</span></code>, <code class="docutils literal notranslate"><span class="pre">models</span></code>)</p></li>
<li><p><strong>verbose</strong> -- give lots of feedback (optional; default = False)</p></li>
<li><p><strong>showRadius</strong> -- set to True so evaluate radius (optional; default = False unless spec is absolute flux calibrated)</p></li>
</ul>
</dd>
</dl>
<p>Also takes commands for compareSpectra</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output</strong> -- filename or filename base for output files (optional; alternate keywords <code class="docutils literal notranslate"><span class="pre">filename</span></code>, <code class="docutils literal notranslate"><span class="pre">filebase</span></code>)</p></li>
<li><p><strong>savestep</strong> -- indicate when to save data output; e.g. <code class="docutils literal notranslate"><span class="pre">savestep</span> <span class="pre">=</span> <span class="pre">10</span></code> will save the output every 10 samples (optional, default = <code class="docutils literal notranslate"><span class="pre">nsamples</span></code>/10)</p></li>
<li><p><strong>dataformat</strong> (<em>optional</em><em>, </em><em>default = 'ascii.csv'</em>) -- output data format type</p></li>
<li><p><strong>initial_guess</strong> (<em>optional</em><em>, </em><em>default = array</em><em> of </em><em>random numbers within allowed ranges</em>) -- array including initial guess of the effective temperature, surface gravity and metallicity of <code class="docutils literal notranslate"><span class="pre">spec</span></code>.
Can also set individual guesses of spectral parameters by using <strong>initial_temperature</strong> or <strong>initial_teff</strong>,
<strong>initial_gravity</strong> or <strong>initial_logg</strong>, and <strong>initial_metallicity</strong> or <strong>initial_z</strong>.</p></li>
<li><p><strong>ranges</strong> (<em>optional</em><em>, </em><em>default = depends on model set</em>) -- array of arrays indicating ranges of the effective temperature, surface gravity and metallicity of the model set.
Can also set individual ranges of spectral parameters by using <strong>temperature_range</strong> or <strong>teff_range</strong>,
<strong>gravity_range</strong> or <strong>logg_range</strong>, and <strong>metallicity_range</strong> or <strong>z_range</strong>.</p></li>
<li><p><strong>step_sizes</strong> (<em>optional</em><em>, </em><em>default =</em><em> [</em><em>50</em><em>, </em><em>0.25</em><em>, </em><em>0.1</em><em>]</em>) -- an array specifying step sizes of spectral parameters. Can also set individual step sizes by using
<strong>temperature_step</strong> or <strong>teff_step</strong>, <strong>gravity_step</strong> or <strong>logg_step</strong>, and <strong>metallicity_step</strong> or <strong>z_step</strong>.</p></li>
<li><p><strong>nonmetallicity</strong> (<em>optional</em><em>, </em><em>default = False</em>) -- if True, sets metallicity = 0</p></li>
<li><p><strong>addon</strong> (<em>optional</em><em>, </em><em>default = False</em>) -- reads in prior calculation and starts from there. Allowed object types are tables, dictionaries and strings.</p></li>
<li><p><strong>evolutionary_model</strong> (<em>optional</em><em>, </em><em>default = 'Baraffe'</em>) -- <p>set of evolutionary models to use. See Brown Dwarf Evolutionary Models page for
more details. Options include:</p>
<ul>
<li><p><em>'baraffe'</em>: Evolutionary models from <a class="reference external" href="http://arxiv.org/abs/astro-ph/0302293">Baraffe et al. (2003)</a>.</p></li>
<li><p><em>'burrows'</em>: Evolutionary models from <a class="reference external" href="http://adsabs.harvard.edu/abs/1997ApJ...491..856B">Burrows et al. (1997)</a>.</p></li>
<li><p><em>'saumon'</em>: Evolutionary models from <a class="reference external" href="http://adsabs.harvard.edu/abs/2008ApJ...689.1327S">Saumon &amp; Marley (2008)</a>.</p></li>
</ul>
</p></li>
<li><p><strong>emodel</strong> (<em>optional</em><em>, </em><em>default = 'Baraffe'</em>) -- the same as <code class="docutils literal notranslate"><span class="pre">evolutionary_model</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.model</span> <span class="k">as</span> <span class="nn">spmod</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">getSpectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1047+2124&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>        <span class="c1"># T6.5 radio emitter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parameters</span> <span class="o">=</span> <span class="n">spmod</span><span class="o">.</span><span class="n">modelFitMCMC</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">initial_guess</span><span class="o">=</span><span class="p">[</span><span class="mi">900</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span><span class="n">nsamples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.model.modelFitEMCEE">
<span class="sig-prename descclassname"><span class="pre">splat.model.</span></span><span class="sig-name descname"><span class="pre">modelFitEMCEE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">specin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BTSettl2008'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SPEX-PRISM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nofit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">showRadius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwalkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threads</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propose_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.model.modelFitEMCEE" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Uses the <code class="docutils literal notranslate"><span class="pre">emcee</span></code> package by Dan Foreman-Mackey et al. to perform
Goodman &amp; Weare's Affine Invariant Markov chain Monte Carlo (MCMC) Ensemble sampler
to fit a spectrum to a set of atmosphere models.
Returns the best estimate of the effective temperature, surface
gravity, and (if selected) metallicity.  Includes an estimate of the time required to run, prompts
user if they want to proceed, and shows progress with iterative saving of outcomes</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>spec</strong> -- Spectrum class object, which should contain wave, flux and noise array elements (required)</p></li>
<li><p><strong>nwalkers</strong> -- number of MCMC walkers, should be at least 20 (optional, default = 20)</p></li>
<li><p><strong>nsamples</strong> -- number of MCMC samples (optional, default = 500)</p></li>
<li><p><strong>threads</strong> -- number of threads to run on a multiprocessing machine (optional, default = 1)</p></li>
<li><p><strong>burn_fraction</strong> -- the fraction of the initial steps to be discarded; e.g., if
<code class="docutils literal notranslate"><span class="pre">burn_fraction</span> <span class="pre">=</span> <span class="pre">0.2</span></code>, the first 20% of the samples are discarded. (optional, default = 0.5)</p></li>
<li><p><strong>initial_guess</strong> -- array including initial guess of the model parameters.
Can also set individual guesses of spectral parameters by using
<strong>initial_temperature</strong>, <strong>initial_teff</strong>, or <strong>t0</strong>;
<strong>initial_gravity</strong>, <strong>initial_logg</strong> or <strong>g0</strong>;
and <strong>initial_metallicity</strong>, <strong>initial_z</strong> or <strong>z0</strong> (optional, default = array of random numbers within allowed ranges)</p></li>
<li><p><strong>limits</strong> -- list of 2-element arrays indicating ranges of the model parameters to limit the parameter space.
Can also set individual ranges of spectral parameters by using
<strong>temperature_range</strong>, <strong>teff_range</strong> or <strong>t_range</strong>;
<strong>gravity_range</strong>, <strong>logg_range</strong> or <strong>g_range</strong>;
and <strong>metallicity_range</strong> or <strong>z_range</strong> (optional, default = depends on model set)</p></li>
<li><p><strong>prior_scatter</strong> -- array giving the widths of the normal distributions from which to draw prior parameter values (optional, default = [25,0.1,0.1])</p></li>
<li><p><strong>model</strong> (<em>optional</em><em>, </em><em>default = 'BTSettl2008'</em>) -- <p>set of models to use (<code class="docutils literal notranslate"><span class="pre">set</span></code> and <code class="docutils literal notranslate"><span class="pre">model_set</span></code> do the same); options include:</p>
<ul>
<li><p><em>'BTSettl2008'</em>: model set with effective temperature of 400 to 2900 K, surface gravity of 3.5 to 5.5 and metallicity of -3.0 to 0.5
from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012RSPTA.370.2765A">Allard et al. (2012)</a></p></li>
<li><p><em>'burrows06'</em>: model set with effective temperature of 700 to 2000 K, surface gravity of 4.5 to 5.5, metallicity of -0.5 to 0.5,
and sedimentation efficiency of either 0 or 100 from <a class="reference external" href="http://adsabs.harvard.edu/abs/2006ApJ...640.1063B">Burrows et al. (2006)</a></p></li>
<li><p><em>'morley12'</em>: model set with effective temperature of 400 to 1300 K, surface gravity of 4.0 to 5.5, metallicity of 0.0
and sedimentation efficiency of 2 to 5 from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...756..172M">Morley et al. (2012)</a></p></li>
<li><p><em>'morley14'</em>: model set with effective temperature of 200 to 450 K, surface gravity of 3.0 to 5.0, metallicity of 0.0
and sedimentation efficiency of 5 from <a class="reference external" href="http://adsabs.harvard.edu/abs/2014ApJ...787...78M">Morley et al. (2014)</a></p></li>
<li><p><em>'saumon12'</em>: model set with effective temperature of 400 to 1500 K, surface gravity of 3.0 to 5.5 and metallicity of 0.0
from <a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJ...750...74S">Saumon et al. (2012)</a></p></li>
<li><p><em>'drift'</em>: model set with effective temperature of 1700 to 3000 K, surface gravity of 5.0 to 5.5 and metallicity of -3.0 to 0.0
from <a class="reference external" href="http://adsabs.harvard.edu/abs/2011A%26A...529A..44W">Witte et al. (2011)</a></p></li>
</ul>
</p></li>
<li><p><strong>radius</strong> (<em>optional</em><em>, </em><em>default = False</em>) -- set to True to calculate and returns radius of object [NOT CURRENT IMPLEMENTED]</p></li>
<li><p><strong>save</strong> (<em>optional</em><em>, </em><em>default = True</em>) -- save interim results to a .dat file based on output filename</p></li>
<li><p><strong>output</strong> (<em>optional</em><em>, </em><em>default = None</em>) -- base filename for output (<code class="docutils literal notranslate"><span class="pre">filename</span></code> and <code class="docutils literal notranslate"><span class="pre">outfile</span></code> do the same);
outputs will include (each can be set individually with associated keywords):
- <code class="docutils literal notranslate"><span class="pre">filename_iterative.dat</span></code>: interative saved data
- <code class="docutils literal notranslate"><span class="pre">filename_summary.txt</span></code>: summary of results
- <code class="docutils literal notranslate"><span class="pre">filename_corner.eps</span></code>: corner plot of parameters
- <code class="docutils literal notranslate"><span class="pre">filename_comparison.eps</span></code>: plot spectrum compared to best fit model</p></li>
<li><p><strong>plot_format</strong> -- file type for diagnostic plots</p></li>
<li><p><strong>noprompt</strong> (<em>optional</em><em>, </em><em>default = False</em>) -- don't prompt user to continue of emcee run will be &gt; 10 minutes</p></li>
<li><p><strong>verbose</strong> (<em>optional</em><em>, </em><em>default = False</em>) -- give lots of feedback</p></li>
</ul>
</dd>
</dl>
<p>In addition, the parameters for <a class="reference external" href="api.html#splat.core.compareSpectra">compareSpectra</a>, <a href="#id156"><span class="problematic" id="id157">generateMask_</span></a>, <a href="#id158"><span class="problematic" id="id159">plotSpectrum_</span></a>; see SPLAT API for details.</p>
<dl>
<dt>Note: modelfitEMCEE requires external packages:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">emcee</span></code>: <a class="reference external" href="http://dan.iel.fm/emcee/current">http://dan.iel.fm/emcee/current</a></p></li>
</ul>
<p>-<code class="docutils literal notranslate"><span class="pre">corner</span></code>: <a class="reference external" href="http://corner.readthedocs.io/en/latest">http://corner.readthedocs.io/en/latest</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="n">shortname</span><span class="o">=</span><span class="s1">&#39;1507-1627&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spt</span><span class="p">,</span><span class="n">spt_e</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">classifyByStandard</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">teff</span><span class="p">,</span><span class="n">teff_e</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">typeToTeff</span><span class="p">(</span><span class="n">spt</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">modelFitEMCEE</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">t0</span><span class="o">=</span><span class="n">teff</span><span class="p">,</span><span class="n">g0</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span><span class="n">fit_metallicity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>    <span class="o">&gt;&gt;&gt;</span>    <span class="n">nwalkers</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">nsamples</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;/Users/adam/test_modelfitEMCEE&#39;</span><span class="p">)</span>
<span class="go">    Estimated time to compute = 9228 seconds = 153.8 minutes = 2.56 hours = 0.11 days</span>
<span class="go">    Do you want to continue? [Y/n]:</span>
<span class="go">    Progress: [**************************************************]</span>
</pre></div>
</div>
<p>Results are saved in test_modelfitEMCEE_interative.dat, <a href="#id79"><span class="problematic" id="id80">*</span></a>_chains.pdf, <a href="#id81"><span class="problematic" id="id82">*</span></a>_comparison.pdf, <a href="#id83"><span class="problematic" id="id84">*</span></a>_corner.pdf, and <a href="#id85"><span class="problematic" id="id86">*</span></a>_summary.txt</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.model.makeForwardModel">
<span class="sig-prename descclassname"><span class="pre">splat.model.</span></span><span class="sig-name descname"><span class="pre">makeForwardModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duplicate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instkern</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">contfitdeg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_nontelluric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkplots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkprefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tmp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timecheck</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.model.makeForwardModel" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>parameters may contain any of the following:</dt><dd><ul class="simple">
<li><p><strong>modelparam</strong> or <strong>modelparam1</strong>: dictionary of model parameters for primary if model not provided in model or model1: {modelset,teff,logg,z,fsed,kzz,cld,instrument}</p></li>
<li><p><strong>modelparam2</strong>: dictionary of model parameters for secondary if model not provided in model2: {modelset,teff,logg,z,fsed,kzz,cld,instrument}</p></li>
<li><p><strong>rv</strong> or <strong>rv1</strong>: radial velocity of primary</p></li>
<li><p><strong>rv2</strong>: radial velocity of secondary</p></li>
<li><p><strong>vsini</strong> or <strong>vsini1</strong>: rotational velocity of primary</p></li>
<li><p><strong>vsini2</strong>: rotational velocity of secondary</p></li>
<li><p><strong>f21</strong>: relative brightness of secondary to primary (f21 &lt;= 1)</p></li>
<li><p><strong>alpha</strong>: exponent to scale telluric absorption</p></li>
<li><p><strong>vinst</strong>: instrument velocity broadening profile if instrkern not provided</p></li>
<li><p><strong>vshift</strong>: instrument velocity shift</p></li>
<li><p><strong>continuum</strong>: polynomial coefficients for continuum correction; if not provided, a smooth continuum will be fit out</p></li>
<li><p><strong>offset</strong>: additive flux offset, useful if there may be residual background continuum</p></li>
<li><p><strong>offset_fraction</strong>: additive flux offset as a fraction of the median flux, useful if there may be residual background continuum</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.model.mcmcForwardModelFit">
<span class="sig-prename descclassname"><span class="pre">splat.model.</span></span><span class="sig-name descname"><span class="pre">mcmcForwardModelFit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_var</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwalkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'standard'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outlier_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duplicate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secondary_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report_each</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tmp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.model.mcmcForwardModelFit" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Conducts and Markov Chain Monte Carlo (MCMC) forward modeling fit of a spectrum.
This routine assumes the spectral data have already been wavelength calibrated
THIS ROUTINE IS CURRENTLY IN DEVELOPMENT</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param data<span class="colon">:</span></dt>
<dd class="field-odd"><p>Spectrum object containing the data to be modeled</p>
</dd>
<dt class="field-even">param param0<span class="colon">:</span></dt>
<dd class="field-even"><p>dictionary containing the initial parameters; allowed parameters are the same as those defined in <a href="#id160"><span class="problematic" id="id161">`makeForwardModel()`_</span></a></p>
</dd>
<dt class="field-odd">param param_var<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary containing the scales (gaussian sigmas) over which the parameters are varied at each iteration; should contain the same elements as param0. If a parameter var is set to 0, then that parameter is held fixed</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>limits = {}: dictionary containing the limits of the parameters; each parameter that is limited should be matched to a two-element list defining the upper and lower bounds</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>nwalkers = 1: number of MCMC walkers</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>nsteps = 100: number of MCMC steps taken by each walker; the actual number of fits is nsteps x # parameters</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>dof: degrees of freedom; if not provided, assumed to be the number of datapoints minus the number of varied parameters</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>binary = False: set to True to do a binary model fit</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>secondary_model = None: if binary = True, use this parameter to specify the model of the secondary</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>model = None: Spectrum object containing the spectral model to use if assumed fixed; should be of higher resolution and wider wavelength range than the data</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>atm = None: Spectrum object containing the atmospheric/instrumental transmission profile (e.g., <a href="#id162"><span class="problematic" id="id163">`loadTelluric()`_</span></a>); should be of higher resolution and wider wavelength range than the data</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>report = True: set to True to iteratively report the progress of the fit</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>report_index = 10: if report = True, the number of steps to provide an interim report</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>report_each = False: set to True to save all reports separately (useful for movie making)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>file = 'tmp': file prefix for outputs; should include full path unless in operating in desired folder</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>output = 'all': what to return on completion; options include:</p>
<ul class="simple">
<li><p>'all': (default) return a list of all parameter dictionaries and chi-square values</p></li>
<li><p>'best': return only a single dictionary of the best fit parameters and the best fit chi-square value</p></li>
</ul>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>verbose = False: provide extra feedback</p>
</dd>
</dl>
<p>mcmcForwardModelFit() will also take as inputs the plotting parameters for <a href="#id164"><span class="problematic" id="id165">`mcmcForwardModelReport()`_</span></a> and <a href="#id166"><span class="problematic" id="id167">`plotSpectrum()`_</span></a></p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>Depending on what is set for the <cite>output</cite> parameter, a list or single dictionary containing model parameters, and a list or single best chi-square values.
These outputs can be fed into <a href="#id168"><span class="problematic" id="id169">`mcmcForwardModelReport()`_</span></a> to visualize the best fitting model and parameters</p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.model</span> <span class="k">as</span> <span class="nn">spmdl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># read in spectrum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="s1">&#39;nirspec_spectrum.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># read in and trim model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mdl</span> <span class="o">=</span> <span class="n">spmdl</span><span class="o">.</span><span class="n">loadModel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;btsettl&#39;</span><span class="p">,</span><span class="n">teff</span><span class="o">=</span><span class="mi">2600</span><span class="p">,</span><span class="n">logg</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span><span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mdl</span><span class="o">.</span><span class="n">trim</span><span class="p">([</span><span class="n">numpy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="p">)</span><span class="o">-</span><span class="mf">0.01</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">micron</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="p">)</span><span class="o">+</span><span class="mf">0.01</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">micron</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># read in and trim atmospheric absorption</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atm</span> <span class="o">=</span> <span class="n">spmdl</span><span class="o">.</span><span class="n">loadTelluric</span><span class="p">(</span><span class="n">wave_range</span><span class="o">=</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">mdl</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">mdl</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">+</span><span class="mf">0.02</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;spec&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># inital parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mpar</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rv&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;vsini&#39;</span><span class="p">:</span> <span class="mf">10.</span><span class="p">,</span> <span class="s1">&#39;vinst&#39;</span><span class="p">:</span> <span class="mf">5.</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mvar</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rv&#39;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39;vsini&#39;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39;vinst&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlim</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vsini&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">500.</span><span class="p">],</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">100.</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># do fit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pars</span><span class="p">,</span><span class="n">chis</span> <span class="o">=</span> <span class="n">spmdl</span><span class="o">.</span><span class="n">mcmcForwardModelFit</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">mdl</span><span class="p">,</span><span class="n">mpar</span><span class="p">,</span><span class="n">mvar</span><span class="p">,</span><span class="n">limits</span><span class="o">=</span><span class="n">mlim</span><span class="p">,</span><span class="n">atm</span><span class="o">=</span><span class="n">atm</span><span class="p">,</span><span class="n">nsteps</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;fit&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># visualize results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spmdl</span><span class="o">.</span><span class="n">mcmcForwardModelReport</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">mdl</span><span class="p">,</span><span class="n">pars</span><span class="p">,</span><span class="n">chis</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;fit&#39;</span><span class="p">,</span><span class="n">chiweights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">plotParameters</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;rv&#39;</span><span class="p">,</span><span class="s1">&#39;vsini&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.model.mcmcForwardModelReport">
<span class="sig-prename descclassname"><span class="pre">splat.model.</span></span><span class="sig-name descname"><span class="pre">mcmcForwardModelReport</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotChains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotBest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotMean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotCorner</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">saveParameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotParameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">writeReport</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'tmp'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chiweights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duplicate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotColors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['k',</span> <span class="pre">'magenta',</span> <span class="pre">'r',</span> <span class="pre">'b',</span> <span class="pre">'grey',</span> <span class="pre">'grey']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotLines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['-',</span> <span class="pre">'-',</span> <span class="pre">'-',</span> <span class="pre">'-',</span> <span class="pre">'--',</span> <span class="pre">'--']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize_compare</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[15,</span> <span class="pre">5]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corner_smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.model.mcmcForwardModelReport" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plotting and fit analysis routine for <a href="#id170"><span class="problematic" id="id171">`mcmcForwardModelFit()`_</span></a></p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param data<span class="colon">:</span></dt>
<dd class="field-odd"><p>Spectrum object containing the data modeled</p>
</dd>
<dt class="field-even">param parameters<span class="colon">:</span></dt>
<dd class="field-even"><p>dictionary containing the parameters from the fit; each parameter should be linked to a array</p>
</dd>
<dt class="field-odd">param chis<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of the chi-square values (or equivalent statistic) that match the parameter arrays</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>atm = None: Spectrum object containing the atmospheric/instrumental transmission profile (e.g., <a href="#id172"><span class="problematic" id="id173">`loadTelluric()`_</span></a>)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>burn = 0.25: initial fraction of parameters to throw out (&quot;burn-in&quot;)</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>dof = 0: degrees of freedom; if not provided, assumed to be the number of datapoints minus the number of varied parameters</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>binary = False: set to True if a binary model fit was done</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>duplicate = False: set to True if the secondary spectrum has same model parameters as primary</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>vbary = 0.: set to a velocity (assumed barycentric) to add to rv values</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>model = None: Spectrum object containing the primary spectral model; should be of higher resolution and wider wavelength range than the data</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>model2 = None: Spectrum object containing the secondary spectral model; should be of higher resolution and wider wavelength range than the data</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>plotParameters = None: array of the parameters to plot, which should be keys in teh parameters input dictionary; if None, all of the parameters are plot</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>plotChains = True: set to True to plot the parameter &amp; chi-square value chains</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>plotBest = True: set to True to plot the best fit model</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>plotMean = True: set to True to plot the mean parameter model</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>plotColors = ['k','b','g','magenta','grey','grey']: colors for spectral plot, in order of data, model, model without telluric, difference, upper noise, lower noise</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>plotLines = ['-','-','-','-','--','--']: linestyles for spectral plot, in order of data, model, model without telluric, difference, upper noise, lower noise</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>plotCorner = True: set to True to plot a corner plot of parameters (requires corner.py package)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>writeReport = True: set to True to write out best and average parameters to a file</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>saveParameters = True: save parameters to an excel file</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>chiweights = False: apply chi-square weighting for determining mean parameter values</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>file = 'tmp': file prefix for outputs; should include full path unless in operating in desired folder</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>verbose = False: provide extra feedback</p>
</dd>
</dl>
<p>mcmcForwardModelReport() will also take as inputs the plotting parameters for <a href="#id174"><span class="problematic" id="id175">`plotSpectrum()`_</span></a></p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>Depending on the flags set, various plots showing the derived parameters and best fit model for <a href="#id176"><span class="problematic" id="id177">`mcmcForwardModelFit()`_</span></a></p>
</dd>
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.model</span> <span class="k">as</span> <span class="nn">spmdl</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># read in spectrum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sp</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">Spectrum</span><span class="p">(</span><span class="s1">&#39;nirspec_spectrum.txt&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># read in and trim model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mdl</span> <span class="o">=</span> <span class="n">spmdl</span><span class="o">.</span><span class="n">loadModel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;btsettl&#39;</span><span class="p">,</span><span class="n">teff</span><span class="o">=</span><span class="mi">2600</span><span class="p">,</span><span class="n">logg</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span><span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mdl</span><span class="o">.</span><span class="n">trim</span><span class="p">([</span><span class="n">numpy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="p">)</span><span class="o">-</span><span class="mf">0.01</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">micron</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">wave</span><span class="p">)</span><span class="o">+</span><span class="mf">0.01</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">micron</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># read in and trim atmospheric absorption</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atm</span> <span class="o">=</span> <span class="n">spmdl</span><span class="o">.</span><span class="n">loadTelluric</span><span class="p">(</span><span class="n">wave_range</span><span class="o">=</span><span class="p">[</span><span class="n">numpy</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">mdl</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">-</span><span class="mf">0.02</span><span class="p">,</span><span class="n">numpy</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">mdl</span><span class="o">.</span><span class="n">wave</span><span class="o">.</span><span class="n">value</span><span class="p">)</span><span class="o">+</span><span class="mf">0.02</span><span class="p">],</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;spec&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># inital parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mpar</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rv&#39;</span><span class="p">:</span> <span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;vsini&#39;</span><span class="p">:</span> <span class="mf">10.</span><span class="p">,</span> <span class="s1">&#39;vinst&#39;</span><span class="p">:</span> <span class="mf">5.</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.6</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mvar</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rv&#39;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39;vsini&#39;</span><span class="p">:</span> <span class="mf">1.</span><span class="p">,</span> <span class="s1">&#39;vinst&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mlim</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;vsini&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">500.</span><span class="p">],</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">100.</span><span class="p">]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># do fit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pars</span><span class="p">,</span><span class="n">chis</span> <span class="o">=</span> <span class="n">spmdl</span><span class="o">.</span><span class="n">mcmcForwardModelFit</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">mdl</span><span class="p">,</span><span class="n">mpar</span><span class="p">,</span><span class="n">mvar</span><span class="p">,</span><span class="n">limits</span><span class="o">=</span><span class="n">mlim</span><span class="p">,</span><span class="n">atm</span><span class="o">=</span><span class="n">atm</span><span class="p">,</span><span class="n">nsteps</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;fit&#39;&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># visualize results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spmdl</span><span class="o">.</span><span class="n">mcmcForwardModelReport</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span><span class="n">mdl</span><span class="p">,</span><span class="n">pars</span><span class="p">,</span><span class="n">chis</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;fit&#39;</span><span class="p">,</span><span class="n">chiweights</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">plotParameters</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;rv&#39;</span><span class="p">,</span><span class="s1">&#39;vsini&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.model.addUserModels">
<span class="sig-prename descclassname"><span class="pre">splat.model.</span></span><span class="sig-name descname"><span class="pre">addUserModels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folders</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.model.addUserModels" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Reads in list of folders with properly processed model sets, checks them, and adds them to the SPECTRAL_MODELS global variable</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><dl class="field-list simple">
<dt class="field-odd">param folders = []<span class="colon">:</span></dt>
<dd class="field-odd"><p>By default model folders are set in the .splat_spectral_models file;</p>
</dd>
</dl>
</li>
</ul>
<p>alternately (or in addition) folders of models can be included as an input list.
* :param default_info = {}: default parameter set to use for models; superceded by 'info.txt' file if present in model folder
* :param verbose = False: provide verbose feedback</p>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>None, simply adds new model sets to SPECTRAL_MODELS global variable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.model.processModelsToInstrument">
<span class="sig-prename descclassname"><span class="pre">splat.model.</span></span><span class="sig-name descname"><span class="pre">processModelsToInstrument</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instrument_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instrument</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'SPEX-PRISM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Unit('micron')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux_unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Unit('erg</span> <span class="pre">/</span> <span class="pre">(micron</span> <span class="pre">s</span> <span class="pre">cm2)')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixel_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.model.processModelsToInstrument" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Converts raw spectral models into instrument-specific model sets, based on pre-defined or
supplied information on wavelength range and resolution or a template spectrum</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><cite>modelset</cite> or <cite>set</cite>: name of the model set to convert, (for now) must be included in SPLAT distribution; may also be passed as a first argument</p></li>
<li><p><cite>instrument</cite> or <cite>instr</cite>: name of the instrument to convert, either a predefined one (splat.INSTRUMENTS.keys()) or place holder for user-specified parameters; may also be passed as a second argument</p></li>
</ul>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p>If a predefined instrument is not used, user must supply one of the following combinations either as keywords or in an <cite>instrument_parameters</cite> dictionary parameter:</p>
<ul class="simple">
<li><p><cite>wave</cite>: an array containing the wavelengths to sample to; resolution is assumed 2 pixels per resolution element</p></li>
<li><p><cite>wave_range</cite> and <cite>resolution</cite>: the first is a two-element array (assumed in microns if not specified), the second the effective resolution, assuming 2 pixels per resolution element</p></li>
<li><p><cite>wave_unit</cite>: the unit for the wavelength axis</p></li>
<li><p><cite>flux_unit</cite>: the unit for the flux density axis</p></li>
<li><p><cite>template</cite>: a template spectrum object, from which the <cite>wave</cite> array is selected</p></li>
<li><p><cite>pixel_resolution</cite> = 4: the number of pixels per resolution element</p></li>
<li><p><cite>oversample</cite> = 5: by what factor to oversample the spectral data when smoothing</p></li>
<li><p><cite>overscan</cite> = 0.05: percentage of total wavelength range to overextend in order to deal with edge effects in smoothing</p></li>
<li><p><cite>method</cite> = 'hanning': filter design for smoothing</p></li>
</ul>
</dd>
<dt class="field-even">Outputs<span class="colon">:</span></dt>
<dd class="field-even"><p>If necessary, creates a folder in the splat.SPECTRAL_MODEL_FOLDER/[modelset]/[instrument] and outputs the model files</p>
</dd>
<dt class="field-odd">WARNINGS<span class="colon">:</span></dt>
<dd class="field-odd"><p>there is currently a problem with &quot;extraneaous pixels&quot; for some conversions</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.checkSpectralModelName">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">checkSpectralModelName</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.checkSpectralModelName" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Purpose:</dt><dd><p>Checks that an input model name is one of the available spectral models, including a check of alternate names</p>
</dd>
<dt>Required Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>model: A string containing the spectral model to be checked. This should be one of the models listed in <a class="reference external" href="api.html#splat_model.loadModel">loadModel()</a></p>
</dd>
</dl>
</dd>
</dl>
<dl class="simple">
<dt>Optional Inputs:</dt><dd><p>None</p>
</dd>
<dt>Output:</dt><dd><p>A string containing SPLAT's default name for a given model set, or False if that model set is not present</p>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">splat</span><span class="o">.</span><span class="n">checkSpectralModelName</span><span class="p">(</span><span class="s1">&#39;burrows&#39;</span><span class="p">))</span>
<span class="go">    burrows06</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">splat</span><span class="o">.</span><span class="n">checkSpectralModelName</span><span class="p">(</span><span class="s1">&#39;allard&#39;</span><span class="p">))</span>
<span class="go">    BTSettl2008</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">splat</span><span class="o">.</span><span class="n">checkSpectralModelName</span><span class="p">(</span><span class="s1">&#39;somethingelse&#39;</span><span class="p">))</span>
<span class="go">    False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.model.info">
<span class="sig-prename descclassname"><span class="pre">splat.model.</span></span><span class="sig-name descname"><span class="pre">info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.model.info" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model = None</strong><span class="classifier">string</span></dt><dd><p>name of the model to summarize; set to None to list all models</p>
</dd>
<dt><strong>verbose = False</strong><span class="classifier">bool [optional]</span></dt><dd><p>set to True to return verbose output, including listing all models</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="evolutionary-model-routines">
<h3>Evolutionary Model Routines<a class="headerlink" href="#evolutionary-model-routines" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="splat.utilities.checkEvolutionaryModelName">
<span class="sig-prename descclassname"><span class="pre">splat.utilities.</span></span><span class="sig-name descname"><span class="pre">checkEvolutionaryModelName</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.utilities.checkEvolutionaryModelName" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Purpose:</dt><dd><p>Checks that an input model name is one of the available evolutionary models, including a check of alternate names</p>
</dd>
<dt>Required Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>model: A string containing the evolutionary model to be checked. This should be one of the models listed in splat.EVOLUTIONARY_MODELS.keys()</p>
</dd>
</dl>
</dd>
<dt>Optional Inputs:</dt><dd><p>None</p>
</dd>
<dt>Output:</dt><dd><p>A string containing SPLAT's default name for a given model set, or False if that model set is not present</p>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">splat</span><span class="o">.</span><span class="n">checkEvolutionaryModelName</span><span class="p">(</span><span class="s1">&#39;burrows&#39;</span><span class="p">))</span>
<span class="go">    burrows01</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">splat</span><span class="o">.</span><span class="n">checkEvolutionaryModelName</span><span class="p">(</span><span class="s1">&#39;allard&#39;</span><span class="p">))</span>
<span class="go">    False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.evolve.loadEvolModel">
<span class="sig-prename descclassname"><span class="pre">splat.evolve.</span></span><span class="sig-name descname"><span class="pre">loadEvolModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'baraffe2003'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returnpandas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.evolve.loadEvolModel" title="Link to this definition">¶</a></dt>
<dd><blockquote>
<div><dl class="field-list">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Reads in the evolutionary model parameters for the models listed below, which are used to interpolate parameters in <a href="#id178"><span class="problematic" id="id179">`modelParameters()`_</span></a>.</p>
<p>Available models are:</p>
<blockquote>
<div><ul class="simple">
<li><p><strong>baraffe1997</strong> : Models from <a class="reference external" href="http://adsabs.harvard.edu/abs/1997A&amp;A...327.1054B">Baraffe et al. (1997)</a> for 5 Gyr and 10 Gyr, 0.06 Msol &lt; mass &lt; 0.15 Msol, and [M/H] = -2 to 0 (COND dust prescription)</p></li>
<li><p><strong>baraffe1998</strong> : Models from <a class="reference external" href="http://adsabs.harvard.edu/abs/1998A&amp;A...337..403B">Baraffe et al. (1998)</a> for 1 Myr &lt; age &lt; 10 Gyr, 0.005 Msol &lt; mass &lt; 0.1 Msol, Teff &gt; 1700 K, [M/H] = -0.5 and 1.0, and variations in mixing length and He abundance (COND dust prescription)</p></li>
<li><p><strong>baraffe2015</strong> : Models from <a class="reference external" href="http://adsabs.harvard.edu/abs/2015A&amp;A...577A..42B">Baraffe et al. (2015)</a> for 1 Myr &lt; age &lt; 10 Gyr, 0.01 Msol &lt; mass &lt; 1.4 Msol, and solar metallicity</p></li>
<li><p><strong>burrows2001</strong> : Models from <a class="reference external" href="http://adsabs.harvard.edu/abs/2001RvMP...73..719B">Burrows et al. (2001)</a> for 1 Myr &lt; age &lt; 10 Gyr, 0.01 Msol &lt; mass &lt; 0.2 Msol, and solar metallicity</p></li>
<li><p><strong>chabrier1997</strong> : Models from <a class="reference external" href="http://adsabs.harvard.edu/abs/1997A&amp;A...328...83C">Chabrier &amp; Baraffe (1997)</a> for 1 Myr &lt; age &lt; 10 Gyr, 0.075 Msol &lt; mass &lt; 0.8 Msol, and [M/H] = -2.0 to 0.0 (COND dust prescription)</p></li>
<li><p><strong>saumon2008</strong> : Models from <a class="reference external" href="http://adsabs.harvard.edu/abs/2008ApJ...689.1327S">Saumon et al. (2008)</a> for 3 Myr &lt; age &lt; 10 Gyr, 0.002 Msol &lt; mass &lt; 0.085 Msol, Teff &lt; 2500 K, -0.3 &lt; [M/H] &lt; 0.3, and various cloud prescriptions.</p></li>
</ul>
</div></blockquote>
<p>Parameter units (in astropy convention) are:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>masses</cite>: Solar masses</p></li>
<li><p><cite>ages</cite>: Gyr</p></li>
<li><p><cite>temperature</cite>: K</p></li>
<li><p><cite>gravity</cite>: log10 of cm/s/s</p></li>
<li><p><cite>luminosity</cite>: log10 of Solar luminosities</p></li>
<li><p><cite>radius</cite>: Solar radii</p></li>
</ul>
</div></blockquote>
<p>Models are contained in SPLAT's EvolutionaryModels folder.</p>
</dd>
</dl>
<p>Required Inputs:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>model: string of the name of the evolutionary model set to be used; can be <cite>baraffe</cite> (default), <cite>burrows</cite>, or <cite>saumon</cite></p>
</dd>
</dl>
</div></blockquote>
<p>Optional Inputs:</p>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>metallicity: metallicity assumed for evolutionary models; can be either a single value or a list specifying a range. Be sure the given metallicity is included in the model</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>cloud: cloud property in Saumon &amp; Marley (2008) models; must be a string and equal to 'nc', 'f2' or 'hybrid' (default).</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>y: He fraction in Baraffe et al. (1998) and Chabrier &amp; Baraffe (1997) models.  Be sure the value is included in the model</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>l_mix: mixing length parameter in Baraffe et al. (1998) models.  Be sure the value is included in the model</p>
</dd>
</dl>
</div></blockquote>
<p>Output:</p>
<p>Dictionary containing keywords mass, age, temperature, luminosity, gravity, and radius, each linked to the evolutionary parameters retrieved.</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">loadEvolModel</span><span class="p">(</span><span class="s1">&#39;saumon&#39;</span><span class="p">,</span><span class="n">metallicity</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span><span class="n">cloud</span><span class="o">=</span><span class="s1">&#39;nc&#39;</span><span class="p">)</span>
<span class="go">You are using saumon&#39;s models.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="mi">12</span><span class="p">]))</span>
<span class="go">age: 0.15</span>
<span class="go">mass: [ 0.002  0.003  0.004  0.005  0.006  0.007  0.008  0.009  0.01   0.011</span>
<span class="go">  0.012  0.013  0.014  0.015  0.016  0.017  0.018  0.019  0.02   0.022</span>
<span class="go">  0.024  0.026  0.028  0.03   0.033  0.035  0.038  0.04   0.043  0.045</span>
<span class="go">  0.048  0.05   0.053]</span>
<span class="go">temperature: [  353.   418.   471.   523.   585.   642.   695.   748.   806.   893.</span>
<span class="go">  1146.  1228.  1114.  1113.  1148.  1183.  1227.  1270.  1316.  1402.</span>
<span class="go">  1489.  1572.  1654.  1739.  1853.  1930.  2030.  2096.  2187.  2240.</span>
<span class="go">  2316.  2362.  2426.]</span>
<span class="go">gravity: [ 3.576  3.746  3.871  3.972  4.056  4.128  4.191  4.246  4.296  4.335</span>
<span class="go">  4.337  4.368  4.437  4.479  4.512  4.543  4.571  4.597  4.621  4.665</span>
<span class="go">  4.704  4.74   4.772  4.8    4.839  4.861  4.892  4.909  4.931  4.947</span>
<span class="go">  4.966  4.978  4.996]</span>
<span class="go">luminosity: [-6.691 -6.393 -6.185 -6.006 -5.815 -5.658 -5.527 -5.404 -5.277 -5.098</span>
<span class="go"> -4.628 -4.505 -4.709 -4.724 -4.675 -4.627 -4.568 -4.51  -4.45  -4.342</span>
<span class="go"> -4.24  -4.146 -4.058 -3.969 -3.856 -3.781 -3.69  -3.628 -3.546 -3.5   -3.432</span>
<span class="go"> -3.393 -3.34 ]</span>
<span class="go">radius: [ 0.1206  0.1214  0.1214  0.1209  0.1202  0.1195  0.1189  0.1182  0.1178</span>
<span class="go">  0.1181  0.123   0.1235  0.1184  0.1167  0.1161  0.1154  0.1151  0.1148</span>
<span class="go">  0.1146  0.1142  0.1139  0.1139  0.1138  0.1141  0.1144  0.115   0.1155</span>
<span class="go">  0.1163  0.1174  0.118   0.1193  0.12    0.121 ]</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.evolve.modelParameters">
<span class="sig-prename descclassname"><span class="pre">splat.evolve.</span></span><span class="sig-name descname"><span class="pre">modelParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.evolve.modelParameters" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Retrieves the evolutionary model parameters given two of the following parameters: mass, age, temperature, luminosity, gravity, or radius. The inputs can be individual values or arrays.  Using the input parameters, the associated evolutionary model parameters are computed through log-linear interpolation of the original model grid. Parameters that fall outside the grid return nan.</p>
</dd>
</dl>
<p>Required Inputs:</p>
<dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>model: Either a string of the name of the evolutionary model set, which can be one of <cite>baraffe</cite> (default), <cite>burrows</cite>, or <cite>saumon</cite>; or a dictionary output from <a class="reference external" href="api.html#splat_evolve.loadEvolModel">loadEvolModel()</a> containing model parameters.</p>
</dd>
</dl>
<p>and two (2) of the following:</p>
<dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>mass: input value or list of values for mass (can also be <cite>masses</cite> or <cite>m</cite>)</p>
</dd>
<dt class="field-even">Param<span class="colon">:</span></dt>
<dd class="field-even"><p>age: input value or list of values for age (can also be <cite>ages</cite>, <cite>time</cite> or <cite>a</cite>)</p>
</dd>
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>temperature: input value or list of values for temperature (can also be <cite>temperatures</cite>, <cite>teff</cite>, <cite>temp</cite> or <cite>t</cite>)</p>
</dd>
<dt class="field-even">Param<span class="colon">:</span></dt>
<dd class="field-even"><p>gravity: input value or list of values for gravity (can also be <cite>gravities</cite>, <cite>grav</cite>, <cite>logg</cite> or <cite>g</cite>)</p>
</dd>
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>luminosity: input value or list of values for luminosity (can also be <cite>luminosities</cite>, <cite>lum</cite>, <cite>lbol</cite> or <cite>l</cite>)</p>
</dd>
<dt class="field-even">Param<span class="colon">:</span></dt>
<dd class="field-even"><p>radius: input value or list of values for radius (can also be <cite>radii</cite>, <cite>rad</cite> and <cite>r</cite>)</p>
</dd>
</dl>
<p>Optional Inputs:</p>
<dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>Parameters for <a class="reference external" href="api.html#splat_evolve.loadEvolModel">loadEvolModel()</a> may also be used.</p>
</dd>
</dl>
<p>Output:</p>
<p>Dictionary containing keywords mass, age, temperature, luminosity, gravity, and radius, each linked to the evolutionary parameters retrieved.</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span><span class="o">,</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masses</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ages</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">modelParameters</span><span class="p">(</span><span class="s1">&#39;baraffe&#39;</span><span class="p">,</span><span class="n">mass</span><span class="o">=</span><span class="n">masses</span><span class="p">,</span><span class="n">age</span><span class="o">=</span><span class="n">ages</span><span class="p">)</span>
<span class="go">You are using baraffe&#39;s models.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">temperature</span><span class="p">)</span>
<span class="go">[ 2502.90132332  2818.85920306  1002.64227134  1330.37273021  1192.86976417</span>
<span class="go">  500.45609068  2604.99966013  1017.03307609  1774.18267474  1675.12181635</span>
<span class="go">  2682.9697321   2512.45223777   346.41152614  2066.19972036   843.28528456</span>
<span class="go">  2264.93051445  2767.85660557   348.84214986   922.87030167  2669.27152307] K</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.evolve.plotModelParameters">
<span class="sig-prename descclassname"><span class="pre">splat.evolve.</span></span><span class="sig-name descname"><span class="pre">plotModelParameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xparam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yparam</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.evolve.plotModelParameters" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Plots pairs of physical star parameters and optionally compares to evolutionary model tracks.</p>
</dd>
<dt class="field-even">Required Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>parameters: dictionary or nested set of two arrays containing parameters to be plotted. For dictionary, keywords should include the <cite>xparameter</cite> and <cite>yparameter</cite> strings to be plotted. Values associated with keywords can be single numbers or arrays</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>xparam: string corresponding to the key in the <cite>parameters</cite> dictionary to be plot as the x (independent) variable.</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>yparam: string corresponding to the key in the <cite>parameters</cite> dictionary to be plot as the y (dependent) variable.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>showmodel: set to True to overplot evolutionary model tracks from <cite>model</cite> (default = True)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>model: either a string of the name of the evolutionary model set, one of  <cite>baraffe</cite> (default), <cite>burrows</cite>, or <cite>saumon</cite>; or a dictionary output from <a class="reference external" href="api.html#splat_evolve.loadEvolModel">loadEvolModel()</a> containing model parameters.</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>tracks: string indicating what model tracks to show; can either be <cite>mass</cite> (default) or <cite>age</cite></p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>file: name of file to output plot (<cite>output</cite> can also be used)</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>show: set to True to show the plot onscreen (default = True)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>figsize: a two-element array defining the figure size (default = [8,6])</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>color: color of data symbols (default = 'blue')</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>marker: matplotlib marker type for data symbols (default = 'o')</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>xlabel: string overriding the x-axis label (default = parameter name and unit)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>ylabel: string overriding the y-axis label (default = parameter name and unit)</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>title: string specifying plot title (no title by default)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>tight: set to True to tighten plot to focus on the data points (default = True)</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>A matplotlib plot object. Optionally, can also show plot on screen or output plot to a file.</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span><span class="o">,</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">age_samp</span> <span class="o">=</span> <span class="mf">10.</span><span class="o">**</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mass_samp</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">modelParameters</span><span class="p">(</span><span class="s1">&#39;baraffe&#39;</span><span class="p">,</span><span class="n">age</span><span class="o">=</span><span class="n">age_samp</span><span class="p">,</span><span class="n">mass</span><span class="o">=</span><span class="n">mass_samp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">splat</span><span class="o">.</span><span class="n">plotModelParameters</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="s1">&#39;age&#39;</span><span class="p">,</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span><span class="n">showmodels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;baraffe&#39;</span><span class="p">,</span><span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[plot of temperature vs age for 50 data points with baraffe models overplotted]</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="population-simulation-routines">
<h3>Population Simulation Routines<a class="headerlink" href="#population-simulation-routines" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="splat.simulate.UVWpopulation">
<span class="sig-prename descclassname"><span class="pre">splat.simulate.</span></span><span class="sig-name descname"><span class="pre">UVWpopulation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uvw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e_uvw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.0,</span> <span class="pre">0.0,</span> <span class="pre">0.0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.simulate.UVWpopulation" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Computes the probabilities of a source being within the thin disk, thick disk or halo populations</p>
</dd>
</dl>
<p>using the analysis of Bensby et al. 2003</p>
<p>Required Inputs:</p>
<dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>uvw: array containing the UVW velocities in km/s in right-hand coordinate system</p>
</dd>
</dl>
<p>Optional Inputs:</p>
<dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>e_uvw: uarray containing the uncertainties of UVW in km/s (default = [0.,0.,0.])</p>
</dd>
<dt class="field-even">Param<span class="colon">:</span></dt>
<dd class="field-even"><p>nsamp: number of Monte Carlo samples for error propogation (default = 1000)</p>
</dd>
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>verbose: Give feedback (default = False)</p>
</dd>
</dl>
<p>Output:</p>
<p>Three value specifying the probability of being in the thin disk, thick disk, or halo (sums to 1)</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.evolve</span> <span class="k">as</span> <span class="nn">spsim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pt</span><span class="p">,</span><span class="n">pth</span><span class="p">,</span><span class="n">ph</span> <span class="o">=</span> <span class="n">spsim</span><span class="o">.</span><span class="n">UVWpopulation</span><span class="p">([</span><span class="mf">20.</span><span class="p">,</span><span class="o">-</span><span class="mf">80.</span><span class="p">,</span><span class="mf">10.</span><span class="p">],</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">        P(thin) = 0.418</span>
<span class="go">        P(thick) = 0.581</span>
<span class="go">        P(halo) = 0.000</span>
<span class="go">        Borderline thin/thick disk star</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.simulate.volumeCorrection">
<span class="sig-prename descclassname"><span class="pre">splat.simulate.</span></span><span class="sig-name descname"><span class="pre">volumeCorrection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'juric'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sun'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Unit('pc')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">population</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.simulate.volumeCorrection" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Computes the correction between the effective volume searched given an underly stellar density</p>
</dd>
</dl>
<p>model and the geometric volume. This program computes the value of the ratio:</p>
<blockquote>
<div><p>$int_0^{x_{max}}{rho(x)x^2dx} / int_0^{x_{max}}{rho(0)x^2dx}$</p>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Required Inputs<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param coordinate<span class="colon">:</span></dt>
<dd class="field-odd"><p>a variable that can be converted to an astropy SkyCoord value with <a class="reference external" href="api.html#splat.utilities.properCoordinates">splat.properCoordinates()</a></p>
</dd>
<dt class="field-even">param dmax<span class="colon">:</span></dt>
<dd class="field-even"><p>the maximum distance to compute to, or an array of distances, assumed in units of parsec.
In the case of an array, the result is the cumulative volume correction up to the corresponding maximum distance</p>
</dd>
</dl>
</dd>
<dt class="field-even">Optional Inputs<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>model = 'juric': the galactic number density model; currently available:</p>
<ul class="simple">
<li><p>'juric': (default) <a class="reference external" href="http://adsabs.harvard.edu/abs/2008ApJ...673..864J">Juric et al. (2008, ApJ, 673, 864)</a> called by <a class="reference external" href="api.html#splat.simulate.galacticDensityJuric">splat.simulate.galacticDensityJuric()</a></p></li>
<li><p>'disk': exponential disk model parameterized by r1 and h1</p></li>
<li><p>'spheroid' or 'halo': spheroid model parameterized by q and n</p></li>
</ul>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>population = 'all': depending on model, specifies what population to return.
For example, model='juric' can take population='thin disk','thick disk','halo','bulge' or 'all'</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>center = 'sun': assumed center point, by default 'sun' but could also be 'galaxy'</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>nsamp = number of samples for sampling line of sight</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>unit = astropy.units.pc: preferred unit for positional arguments</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>Estimate of the correction factor for the effective volume</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.simulate</span> <span class="k">as</span> <span class="nn">spsim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">properCoordinates</span><span class="p">(</span><span class="s1">&#39;J05591914-1404488&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spsim</span><span class="o">.</span><span class="n">volumeCorrection</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="mf">10.</span><span class="p">)</span>
<span class="go">        1.0044083458899131 # note: slightly larger than 1 because we are going toward Galactic disk</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spsim</span><span class="o">.</span><span class="n">volumeCorrection</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="mf">10000.</span><span class="p">)</span>
<span class="go">        0.0060593740293862081</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">TBD<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>flag to return the integrated correction function as a function of distance (cumulative distribution)</p></li>
<li><p>flag to just integrate parts of a density distribution (e.g., &quot;thin disk&quot;, &quot;halo&quot;)</p></li>
<li><p>fix error at r = 0</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.simulate.galacticPotential">
<span class="sig-prename descclassname"><span class="pre">splat.simulate.</span></span><span class="sig-name descname"><span class="pre">galacticPotential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">report</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.simulate.galacticPotential" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Computes the specific gravitational potential (energy per mass) at a particular radius r and</p>
</dd>
</dl>
<p>scaleheight z in the Milky Way Galaxy based on the cylindrically symmetric models of Barros et al. (2016, AandA, 593A, 108)</p>
<p>Required Inputs:</p>
<dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>r: radial coordinate from center of Galaxy in units of kpc</p>
</dd>
<dt class="field-even">Param<span class="colon">:</span></dt>
<dd class="field-even"><p>r: vertical coordinate in plane of Galaxy in units of kpc</p>
</dd>
</dl>
<p>Optional Inputs:</p>
<dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>report: set to the following to return specific values:
* <cite>all</cite>: return total potential (default)
* <cite>disk</cite>: return only potential from the disk
* <cite>halo</cite>: return only potential from the halo
* <cite>bulge</cite>: return only potential from the bulge</p>
</dd>
<dt class="field-even">Param<span class="colon">:</span></dt>
<dd class="field-even"><p>verbose: Give feedback (default = False)</p>
</dd>
</dl>
<p>Output:</p>
<p>Specific potential in units of km2/s2</p>
<dl class="field-list simple">
<dt class="field-odd">Example<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.evolve</span> <span class="k">as</span> <span class="nn">spsim</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pot</span> <span class="o">=</span> <span class="n">spsim</span><span class="o">.</span><span class="n">galacticPotential</span><span class="p">(</span><span class="mf">8.5</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">        Thin disk potential = -16164.669941534123 km2 / s2</span>
<span class="go">        Thick disk potential = -2805.8541251994084 km2 / s2</span>
<span class="go">        H I disk potential = -4961.194452965543 km2 / s2</span>
<span class="go">        H II disk potential = -1320.2381374715114 km2 / s2</span>
<span class="go">        Total disk potential = -25251.956657170587 km2 / s2</span>
<span class="go">        Bulge potential = -12195.097166319883 km2 / s2</span>
<span class="go">        Halo potential = 64175.96074890407 km2 / s2</span>
</pre></div>
</div>
</dd></dl>

</section>
</section>
<section id="specialty-packages">
<h2>Specialty Packages<a class="headerlink" href="#specialty-packages" title="Link to this heading">¶</a></h2>
<section id="euclid-analysis-routines">
<h3>EUCLID Analysis Routines<a class="headerlink" href="#euclid-analysis-routines" title="Link to this heading">¶</a></h3>
</section>
<section id="bibtex-routines">
<h3>BibTeX Routines<a class="headerlink" href="#bibtex-routines" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="splat.citations.veryShortRef">
<span class="sig-prename descclassname"><span class="pre">splat.citations.</span></span><span class="sig-name descname"><span class="pre">veryShortRef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bib_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.citations.veryShortRef" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Takes a bibtex entry and returns a short (in-line) version of the citation</p>
</dd>
<dt class="field-even">Required parameters<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param bib_tex<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary output from bibTexParser, else a bibcode that is fed into bibTexParser</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>A string of the format <code class="docutils literal notranslate"><span class="pre">Burgasser</span> <span class="pre">et</span> <span class="pre">al.</span> <span class="pre">(2006)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.citations.shortRef">
<span class="sig-prename descclassname"><span class="pre">splat.citations.</span></span><span class="sig-name descname"><span class="pre">shortRef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bib_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.citations.shortRef" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Takes a bibtex dictionary and returns a short (in-line) version of the citation</p>
</dd>
<dt class="field-even">Required parameters<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param bib_tex<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary output from bibTexParser, else a bibcode that is fed into bibTexParser</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>A string of the format <code class="docutils literal notranslate"><span class="pre">Burgasser,</span> <span class="pre">A.</span> <span class="pre">J.,</span> <span class="pre">et</span> <span class="pre">al.</span> <span class="pre">(2006,</span> <span class="pre">ApJ,</span> <span class="pre">710,</span> <span class="pre">1142)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.citations.longRef">
<span class="sig-prename descclassname"><span class="pre">splat.citations.</span></span><span class="sig-name descname"><span class="pre">longRef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bib_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.citations.longRef" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Takes a bibtex dictionary and returns a long (in-line) version of the citation</p>
</dd>
<dt class="field-even">Required parameters<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param bib_tex<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary output from bibTexParser, else a bibcode that is fed into bibTexParser</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>A string of the format <code class="docutils literal notranslate"><span class="pre">Burgasser,</span> <span class="pre">A.</span> <span class="pre">J.,</span> <span class="pre">Cruz,</span> <span class="pre">K.</span> <span class="pre">L.,</span> <span class="pre">Cushing,</span> <span class="pre">M.,</span> <span class="pre">et</span> <span class="pre">al.</span> <span class="pre">SpeX</span> <span class="pre">Spectroscopy</span> <span class="pre">of</span> <span class="pre">Unresolved</span> <span class="pre">Very</span> <span class="pre">Low</span> <span class="pre">Mass</span> <span class="pre">Binaries.</span>
<span class="pre">I.</span> <span class="pre">Identification</span> <span class="pre">of</span> <span class="pre">17</span> <span class="pre">Candidate</span> <span class="pre">Binaries</span> <span class="pre">Straddling</span> <span class="pre">the</span> <span class="pre">L</span> <span class="pre">Dwarf/T</span> <span class="pre">Dwarf</span> <span class="pre">Transition.</span> <span class="pre">ApJ</span> <span class="pre">710,</span> <span class="pre">1142</span> <span class="pre">(2010)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.citations.veryLongRef">
<span class="sig-prename descclassname"><span class="pre">splat.citations.</span></span><span class="sig-name descname"><span class="pre">veryLongRef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bib_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.citations.veryLongRef" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Takes a bibtex dictionary and returns a long (in-line) version of the citation</p>
</dd>
<dt class="field-even">Required parameters<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param bib_tex<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary output from bibTexParser, else a bibcode that is fed into bibTexParser</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>A string of the format <code class="docutils literal notranslate"><span class="pre">Burgasser,</span> <span class="pre">A.</span> <span class="pre">J.,</span> <span class="pre">Cruz,</span> <span class="pre">K.</span> <span class="pre">L.,</span> <span class="pre">Cushing,</span> <span class="pre">M.,</span> <span class="pre">et</span> <span class="pre">al.</span> <span class="pre">SpeX</span> <span class="pre">Spectroscopy</span> <span class="pre">of</span> <span class="pre">Unresolved</span> <span class="pre">Very</span> <span class="pre">Low</span> <span class="pre">Mass</span> <span class="pre">Binaries.</span>
<span class="pre">I.</span> <span class="pre">Identification</span> <span class="pre">of</span> <span class="pre">17</span> <span class="pre">Candidate</span> <span class="pre">Binaries</span> <span class="pre">Straddling</span> <span class="pre">the</span> <span class="pre">L</span> <span class="pre">Dwarf/T</span> <span class="pre">Dwarf</span> <span class="pre">Transition.</span> <span class="pre">ApJ</span> <span class="pre">710,</span> <span class="pre">1142</span> <span class="pre">(2010)</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.citations.processBiblibrary">
<span class="sig-prename descclassname"><span class="pre">splat.citations.</span></span><span class="sig-name descname"><span class="pre">processBiblibrary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">biblibrary</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.citations.processBiblibrary" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Purpose</dt><dd><p>Processes a bibtex .bib library (multiple bibtex entries) into a dictionary whose keys
are the bibcode</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Required parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="field-list simple">
<dt class="field-odd">param biblibrary<span class="colon">:</span></dt>
<dd class="field-odd"><p>.bib file containing the bibtex entries</p>
</dd>
</dl>
</dd>
<dt class="field-even">Optional parameters<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>verbose = False: Set to True to provide extensive feedback</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Output<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary containing the bibtex information, organized by bibcode key</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.citations.bibTexParser">
<span class="sig-prename descclassname"><span class="pre">splat.citations.</span></span><span class="sig-name descname"><span class="pre">bibTexParser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bib_input</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.citations.bibTexParser" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Parses a bibtex segment and returns a dictionary of parameter fields</p>
</dd>
<dt class="field-even">Required parameters<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param bib_tex<span class="colon">:</span></dt>
<dd class="field-odd"><p>String containing bibtex data in standard format</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the parsed bibtex information</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.citations.citeURL">
<span class="sig-prename descclassname"><span class="pre">splat.citations.</span></span><span class="sig-name descname"><span class="pre">citeURL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bib_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.citations.citeURL" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Generate the URL corresponding to a citation, based on the bibcode and NASA ADS syntax</p>
</dd>
<dt class="field-even">Required parameters<span class="colon">:</span></dt>
<dd class="field-even"><dl class="field-list simple">
<dt class="field-odd">param bib_tex<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary output from bibTexParser, else a bibcode that is fed into bibTexParser</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Optional parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Output<span class="colon">:</span></dt>
<dd class="field-even"><p>A string of the format <code class="docutils literal notranslate"><span class="pre">Burgasser,</span> <span class="pre">A.</span> <span class="pre">J.,</span> <span class="pre">Cruz,</span> <span class="pre">K.</span> <span class="pre">L.,</span> <span class="pre">Cushing,</span> <span class="pre">M.,</span> <span class="pre">et</span> <span class="pre">al.</span> <span class="pre">SpeX</span> <span class="pre">Spectroscopy</span> <span class="pre">of</span> <span class="pre">Unresolved</span> <span class="pre">Very</span> <span class="pre">Low</span> <span class="pre">Mass</span> <span class="pre">Binaries.</span>
<span class="pre">I.</span> <span class="pre">Identification</span> <span class="pre">of</span> <span class="pre">17</span> <span class="pre">Candidate</span> <span class="pre">Binaries</span> <span class="pre">Straddling</span> <span class="pre">the</span> <span class="pre">L</span> <span class="pre">Dwarf/T</span> <span class="pre">Dwarf</span> <span class="pre">Transition.</span> <span class="pre">ApJ</span> <span class="pre">710,</span> <span class="pre">1142</span> <span class="pre">(2010)</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="astroquery-based-data-access">
<h3>Astroquery-based Data Access<a class="headerlink" href="#astroquery-based-data-access" title="Link to this heading">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="splat.database.getPhotometry">
<span class="sig-prename descclassname"><span class="pre">splat.database.</span></span><span class="sig-name descname"><span class="pre">getPhotometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_pandas=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catalog='2MASS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius=&lt;Quantity</span> <span class="pre">30.</span> <span class="pre">arcsec&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort='sep'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit=-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nearest=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.database.getPhotometry" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Purpose</dt><dd><p>Downloads photometry for a single source coordinate using astroquery.
If you are getting data on multiple sources, it is preferable to use <a class="reference external" href="api.html#splat.database.queryXMatch">splat.database.queryXMatch()</a></p>
</dd>
</dl>
<dl class="simple">
<dt>Required Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>coordinate: Either an astropy SkyCoord or a variable that can be converted into a SkyCoord using <a class="reference external" href="api.html#properCoordinates">properCoordinates()</a></p>
</dd>
</dl>
</dd>
</dl>
<dl class="simple">
<dt>Optional Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param radius<span class="colon">:</span></dt>
<dd class="field-odd"><p>Search radius, nominally in arcseconds although this can be changed by passing an astropy.unit quantity (default = 30 arcseconds)</p>
</dd>
<dt class="field-even">param catalog<span class="colon">:</span></dt>
<dd class="field-even"><p>Catalog to query, which can be set to the Vizier catalog identifier code or to one of the following preset catalogs:</p>
<ul class="simple">
<li><p>'2MASS' (or set <a href="#id90"><span class="problematic" id="id91">``</span></a>2MASS``=True): the 2MASS All-Sky Catalog of Point Sources (<a class="reference external" href="http://adsabs.harvard.edu/abs/2003yCat.2246....0C">Cutri et al. 2003</a>), Vizier id II/246</p></li>
<li><p>'SDSS' (or set <a href="#id92"><span class="problematic" id="id93">``</span></a>SDSS``=True): the The SDSS Photometric Catalog, Release 9 (<a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJS..203...21A">Adelman-McCarthy et al. 2012</a>), Vizier id V/139</p></li>
<li><p>'WISE' (or set <a href="#id94"><span class="problematic" id="id95">``</span></a>WISE``=True): the WISE All-Sky Data Release (<a class="reference external" href="http://adsabs.harvard.edu/abs/2012yCat.2311....0C">Cutri et al. 2012</a>), Vizier id II/311</p></li>
<li><p>'ALLWISE' (or set <a href="#id96"><span class="problematic" id="id97">``</span></a>ALLWISE``=True): the AllWISE Data Release (<a class="reference external" href="http://adsabs.harvard.edu/abs/2014yCat.2328....0C">Cutri et al. 2014</a>), Vizier id II/328</p></li>
<li><p>'VISTA' (or set <a href="#id98"><span class="problematic" id="id99">``</span></a>VISTA``=True): the VIKING catalogue data release 1 (<a class="reference external" href="http://adsabs.harvard.edu/abs/2013Msngr.154...32E">Edge et al. 2013</a>), Vizier id II/329</p></li>
<li><p>'CFHTLAS' (or set <a href="#id100"><span class="problematic" id="id101">``</span></a>CFHTLAS``=True): the CFHTLS Survey (T0007 release) by (<a class="reference external" href="http://adsabs.harvard.edu/abs/2012yCat.2317....0H">Hudelot et al. 2012</a>), Vizier id II/317</p></li>
<li><p>'DENIS' (or set <a href="#id102"><span class="problematic" id="id103">``</span></a>DENIS``=True): the DENIS DR3 (DENIS Consortium 2005), Vizier id B/denis/denis</p></li>
<li><p>'UKIDSS' (or set <a href="#id104"><span class="problematic" id="id105">``</span></a>UKIDSS``=True): the UKIDSS-DR8 LAS, GCS and DXS Surveys (<a class="reference external" href="http://adsabs.harvard.edu/abs/2007MNRAS.379.1599L">Lawrence et al. 2012</a>), Vizier id II/314</p></li>
<li><p>'LEHPM' (or set <a href="#id106"><span class="problematic" id="id107">``</span></a>LEHPM``=True): the Liverpool-Edinburgh High Proper Motion Catalogue (<a class="reference external" href="http://adsabs.harvard.edu/abs/2004A&amp;A...421..763P">Pokorny et al. 2004</a>), Vizier id J/A+A/421/763</p></li>
<li><p>'SIPS' (or set <a href="#id108"><span class="problematic" id="id109">``</span></a>SIPS``=True): the Southern Infrared Proper Motion Survey (<a class="reference external" href="http://adsabs.harvard.edu/abs/2005A&amp;A...435..363D">Deacon et al 2005</a>), Vizier id J/A+A/435/363</p></li>
<li><p>'UCAC4' (or set <a href="#id110"><span class="problematic" id="id111">``</span></a>UCAC4``=True): the UCAC4 Catalogue (<a class="reference external" href="http://adsabs.harvard.edu/abs/2012yCat.1322....0Z">Zacharias et al. 2012</a>), Vizier id I/322A</p></li>
<li><p>'USNOB' (or set <a href="#id112"><span class="problematic" id="id113">``</span></a>USNO``=True): the USNO-B1.0 Catalog (<a class="reference external" href="http://adsabs.harvard.edu/abs/2003AJ....125..984M">Monet et al. 2003</a>), Vizier id I/284</p></li>
<li><p>'LSPM' (or set <a href="#id114"><span class="problematic" id="id115">``</span></a>LSPM``=True): the LSPM-North Catalog (<a class="reference external" href="http://adsabs.harvard.edu/abs/2005AJ....129.1483L">Lepine et al. 2005</a>), Vizier id I/298</p></li>
<li><p>'GAIA-DR1': the GAIA DR1 Catalog (<a class="reference external" href="http://adsabs.harvard.edu/abs/2016yCat.1337....0G">Gaia Collaboration et al. 2016</a>), Vizier id I/337</p></li>
<li><p>'GAIA' or 'GAIA-DR2' (or set <a href="#id116"><span class="problematic" id="id117">``</span></a>GAIA``=True): the GAIA DR2 Catalog (REF TBD), Vizier id I/345/gaia2</p></li>
</ul>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>sort: String specifying the parameter to sort the returned SIMBAD table by; by default this is the offset from the input coordinate (default = 'sep')</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>nearest: Set to True to return on the single nearest source to coordinate (default = False)</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>return_pandas: Return a pandas table as opposed to an astropy Table (default = True)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>verbose: Give feedback (default = False)</p>
</dd>
</dl>
</dd>
<dt>Output:</dt><dd><p>An astropy or pandas Table that contains data from the Vizier query, or a blank Table if no sources are found</p>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.database</span> <span class="k">as</span> <span class="nn">spdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">properCoordinates</span><span class="p">(</span><span class="s1">&#39;J053625-064302&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">spdb</span><span class="o">.</span><span class="n">querySimbad</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">catalog</span><span class="o">=</span><span class="s1">&#39;SDSS&#39;</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mf">15.</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">  _r    _RAJ2000   _DEJ2000  mode q_mode  cl ... r_E_ g_J_ r_F_ i_N_  sep</span>
<span class="go"> arcs     deg        deg                     ... mag  mag  mag  mag   arcs</span>
<span class="go">------ ---------- ---------- ---- ------ --- ... ---- ---- ---- ---- ------</span>
<span class="go"> 7.860  84.105967  -6.715966    1          3 ...   --   --   --   --  7.860</span>
<span class="go">14.088  84.108113  -6.717206    1          6 ...   --   --   --   -- 14.088</span>
<span class="go">14.283  84.102528  -6.720843    1      +   6 ...   --   --   --   -- 14.283</span>
<span class="go">16.784  84.099524  -6.717878    1          3 ...   --   --   --   -- 16.784</span>
<span class="go">22.309  84.097988  -6.718049    1      +   6 ...   --   --   --   -- 22.309</span>
<span class="go">23.843  84.100079  -6.711999    1      +   6 ...   --   --   --   -- 23.843</span>
<span class="go">27.022  84.107504  -6.723965    1      +   3 ...   --   --   --   -- 27.022</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.database.querySimbad">
<span class="sig-prename descclassname"><span class="pre">splat.database.</span></span><span class="sig-name descname"><span class="pre">querySimbad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius=&lt;Quantity</span> <span class="pre">30.</span> <span class="pre">arcsec&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort='sep'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reject_type=''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nearest=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iscoordinate=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isname=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_pandas=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.database.querySimbad" title="Link to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Purpose</dt><dd><p>Queries SIMBAD using astroquery for a single source
If you are getting data on multiple sources, it is preferable to use <a class="reference external" href="api.html#splat.database.queryXMatch">splat.database.queryXMatch()</a></p>
</dd>
<dt>Required Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>variable: Either an astropy SkyCoord object containing position of a source, a variable that can be converted into a SkyCoord using <a class="reference external" href="api.html#spl.properCoordinates">spl.properCoordinates()</a>, or a string name for a source.</p>
</dd>
</dl>
</dd>
<dt>Optional Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>radius: Search radius, nominally in arcseconds although can be set by assigning and astropy.unit value (default = 30 arcseconds)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>sort: String specifying the parameter to sort the returned SIMBAD table by; by default this is the offset from the input coordinate (default = 'sep')</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>reject_type: Set to string or list of strings to filter out object types not desired. Useful for crowded fields (default = None)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>nearest: Set to True to return on the single nearest source to coordinate (default = False)</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>iscoordinate: Specifies that input is a coordinate of some kind (default = False)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>isname: Specifies that input is a name of some kind (default = False)</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>clean: Set to True to clean the SIMBAD output and reassign to a predefined set of parameters (default = True)</p>
</dd>
<dt class="field-even">param<span class="colon">:</span></dt>
<dd class="field-even"><p>return_pandas: Return a pandas table as opposed to an astropy Table (default = True)</p>
</dd>
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>verbose: Give lots of feedback (default = False)</p>
</dd>
</dl>
</dd>
<dt>Output:</dt><dd><p>An astropy or pandas Table that contains data from the SIMBAD search, or a blank Table if no sources found</p>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat.database</span> <span class="k">as</span> <span class="nn">spdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">splat</span><span class="o">.</span><span class="n">properCoordinates</span><span class="p">(</span><span class="s1">&#39;J053625-064302&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">spdb</span><span class="o">.</span><span class="n">querySimbad</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mf">15.</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">,</span><span class="n">reject_type</span><span class="o">=</span><span class="s1">&#39;**&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">          NAME          OBJECT_TYPE     OFFSET    ... K_2MASS K_2MASS_E</span>
<span class="go">----------------------- ----------- ------------- ... ------- ---------</span>
<span class="go">           BD-06  1253B        Star  4.8443894429 ...</span>
<span class="go">            [SST2010] 3        Star 5.74624887682 ...   18.36       0.1</span>
<span class="go">            BD-06  1253         Ae* 7.74205447776 ...   5.947     0.024</span>
<span class="go">           BD-06  1253A          ** 7.75783861347 ...</span>
<span class="go">2MASS J05362590-0643020     brownD* 13.4818185612 ...  12.772     0.026</span>
<span class="go">2MASS J05362577-0642541        Star  13.983717577 ...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.database.queryVizier">
<span class="sig-prename descclassname"><span class="pre">splat.database.</span></span><span class="sig-name descname"><span class="pre">queryVizier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coordinate</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.database.queryVizier" title="Link to this definition">¶</a></dt>
<dd><p>see <a class="reference external" href="api.html#splat.database.getPhotometry">splat.database.getPhotometry()</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.database.queryNist">
<span class="sig-prename descclassname"><span class="pre">splat.database.</span></span><span class="sig-name descname"><span class="pre">queryNist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['Observed']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noclean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vacuum'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.database.queryNist" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="splat.database.queryXMatch">
<span class="sig-prename descclassname"><span class="pre">splat.database.</span></span><span class="sig-name descname"><span class="pre">queryXMatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">db</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius=&lt;Quantity</span> <span class="pre">30.</span> <span class="pre">arcsec&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catalog='2MASS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file=''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desigCol='DESIGNATION'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raCol='RA'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decCol='DEC'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clean=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_repeats=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_select_columns=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_columns=[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#splat.database.queryXMatch" title="Link to this definition">¶</a></dt>
<dd><dl>
<dt>Purpose</dt><dd><p>Queries databases in the XXX XMatch service (REF), including SIMBAD
This is the preferred manner for extracting data for large numbers of sources</p>
</dd>
<dt>Required Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param<span class="colon">:</span></dt>
<dd class="field-odd"><p>db: a pandas Dataframe (FUTURE: astropy Table, dict, or file name for csv, txt or xls file).</p>
</dd>
</dl>
<p>This must contain column(s) for designation (specified in <cite>desigCol</cite>) and/or RA (specified in <cite>raCol</cite>) and DEC (specified in <cite>decCol</cite>)</p>
</dd>
</dl>
<dl class="simple">
<dt>Optional Inputs:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param radius<span class="colon">:</span></dt>
<dd class="field-odd"><p>Search radius, nominally in arcseconds although can be set by assigning and astropy.unit value (default = 30 arcseconds)</p>
</dd>
<dt class="field-even">param desigCol<span class="colon">:</span></dt>
<dd class="field-even"><p>column in db that specifies source designations ('Jhhmmss[.]s±ddmmss[.]s')</p>
</dd>
<dt class="field-odd">param raCol<span class="colon">:</span></dt>
<dd class="field-odd"><p>column in db that specifies source RAs (in degrees)</p>
</dd>
<dt class="field-even">param decCol<span class="colon">:</span></dt>
<dd class="field-even"><p>column in db that specifies source DECs (in degrees)</p>
</dd>
<dt class="field-odd">param catalog<span class="colon">:</span></dt>
<dd class="field-odd"><p>Database to query, which can be set one of the follow presets or any catalog listed in astroquery.xmatch.XMatch.get_available_tables():</p>
<ul class="simple">
<li><p>'SIMBAD' (or set <a href="#id120"><span class="problematic" id="id121">``</span></a>SIMBAD``=True): query SIMBAD (coordinate search only)</p></li>
<li><p>'2MASS' (or set <a href="#id122"><span class="problematic" id="id123">``</span></a>2MASS``=True): query the 2MASS All-Sky Catalog of Point Sources (<a class="reference external" href="http://adsabs.harvard.edu/abs/2003yCat.2246....0C">Cutri et al. 2003</a>), Vizier id II/246</p></li>
<li><p>'SDSS' (or set <a href="#id125"><span class="problematic" id="id126">``</span></a>SDSS``=True): query the SDSS Photometric Catalog, Release 12 (NEED REF), Vizier id V/147</p></li>
<li><p>'SDSS9' (or set <a href="#id127"><span class="problematic" id="id128">``</span></a>SDSS``=True): query the SDSS Photometric Catalog, Release 9 (<a class="reference external" href="http://adsabs.harvard.edu/abs/2012ApJS..203...21A">Adelman-McCarthy et al. 2012</a>), Vizier id V/147</p></li>
<li><p>'ALLWISE' (or set <a href="#id130"><span class="problematic" id="id131">``</span></a>ALLWISE``=True): the AllWISE Data Release (<a class="reference external" href="http://adsabs.harvard.edu/abs/2014yCat.2328....0C">Cutri et al. 2014</a>), Vizier id II/328</p></li>
<li><p>'DENIS' (or set <a href="#id133"><span class="problematic" id="id134">``</span></a>DENIS``=True): the DENIS DR3 (DENIS Consortium 2005), Vizier id B/denis/denis</p></li>
<li><p>'GAIA-DR1': the GAIA DR1 Catalog (<a class="reference external" href="http://adsabs.harvard.edu/abs/2016yCat.1337....0G">Gaia Collaboration et al. 2016</a>), Vizier id I/337</p></li>
<li><p>'GAIA' or 'GAIA-DR2' (or set <a href="#id136"><span class="problematic" id="id137">``</span></a>GAIA``=True): the GAIA DR2 Catalog (REF TBD), Vizier id I/345/gaia2, accessed using astroquery.gaia</p></li>
</ul>
</dd>
<dt class="field-even">param nearest<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to True to return only the single nearest source to each coordinate (default = True)</p>
</dd>
<dt class="field-odd">param clean<span class="colon">:</span></dt>
<dd class="field-odd"><p>Set to True to clean the SIMBAD output and reassign to a predefined set of parameters (default = True)</p>
</dd>
<dt class="field-even">param file<span class="colon">:</span></dt>
<dd class="field-even"><p>Write the output to a csv or xlsx file (default = '' or not saved)</p>
</dd>
<dt class="field-odd">param verbose<span class="colon">:</span></dt>
<dd class="field-odd"><p>Give lots of feedback (default = False)</p>
</dd>
<dt class="field-even">param sort<span class="colon">:</span></dt>
<dd class="field-even"><p>String specifying the parameter to sort the returned SIMBAD table by; by default this is the offset from the input coordinate (default = 'sep')</p>
</dd>
<dt class="field-odd">param return_pandas<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return a pandas table as opposed to an astropy Table (default = True)</p>
</dd>
<dt class="field-even">param reject_type<span class="colon">:</span></dt>
<dd class="field-even"><p>Set to string or list of strings to filter out object types not desired. Useful for crowded fields (default = None)</p>
</dd>
</dl>
</dd>
<dt>Output:</dt><dd><p>A pandas Dataframe that contains data from the search, or a blank frame if no sources found</p>
</dd>
</dl>
<p>Example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">splat</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">spl</span><span class="o">.</span><span class="n">properCoordinates</span><span class="p">(</span><span class="s1">&#39;J053625-064302&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">spl</span><span class="o">.</span><span class="n">querySimbad</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mf">15.</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">,</span><span class="n">reject_type</span><span class="o">=</span><span class="s1">&#39;**&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">          NAME          OBJECT_TYPE     OFFSET    ... K_2MASS K_2MASS_E</span>
<span class="go">----------------------- ----------- ------------- ... ------- ---------</span>
<span class="go">           BD-06  1253B        Star  4.8443894429 ...</span>
<span class="go">            [SST2010] 3        Star 5.74624887682 ...   18.36       0.1</span>
<span class="go">            BD-06  1253         Ae* 7.74205447776 ...   5.947     0.024</span>
<span class="go">           BD-06  1253A          ** 7.75783861347 ...</span>
<span class="go">2MASS J05362590-0643020     brownD* 13.4818185612 ...  12.772     0.026</span>
<span class="go">2MASS J05362577-0642541        Star  13.983717577 ...</span>
</pre></div>
</div>
</dd></dl>

<p><em>Search</em></p>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="splat_simulate.html" class="btn btn-neutral float-left" title="Population Simulation Routines" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2021, Adam Burgasser.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>